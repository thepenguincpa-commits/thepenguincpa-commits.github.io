import{aw as j,a0 as b,a6 as w,m as S,k as M,r as c,t as Q,o as u,a1 as f,j as e,u as q,ax as v}from"./index.CJpzWARr.js";import{B as p}from"./Box.CvVauy6S.js";import"./AppLayout.Dd4AyXhP.js";import{L as P}from"./LayoutContainer.kUniMi3O.js";import{C as F}from"./PostbackConfigFormGroup._zR3IWaf.js";import{d as N}from"./OfferPayoutRepository.DMRgHBdS.js";import{P as z,a as O}from"./PosbackSettings.D31XM5Ua.js";import{C as R,D as k,R as B,O as I,a as T,b as D,L as E,T as L,c as U,d as W,U as $}from"./DomainSettings.BdaMt-7E.js";import{O as A,L as h}from"./LocationsTable.Dr_CxosK.js";import{u as H}from"./useTranslation.D1-YSIqG.js";import{T as G}from"./Toggler.Bo1KxCe6.js";import{G as V}from"./GridRow.DmVNsMLH.js";import{b as J}from"./validators.puhu6pph.js";import{C as d,R as K}from"./row.ZVKcDUTg.js";import{D as X}from"./index.DLP9cbOY.js";import{C as Y}from"./Input.BJc5rBil.js";import{C as Z}from"./_baseIteratee.CoQUSKdO.js";import{B as ee}from"./button.CTAkPJpI.js";import{a as te}from"./index.C7EzEdlH.js";import"./index.5jmBMbM4.js";import"./AntdIcon.BEv94oZ9.js";import"./SelectControl.BdHLXDxG.js";import"./Registry.BEmoiC2h.js";import"./index.CnCisG79.js";import"./ActionButton.D2hXE_0n.js";import"./index.CvuYUNlW.js";import"./useClosable.Emosx8Km.js";import"./index.UwxdIMsP.js";import"./EyeOutlined.C4wc5N2Y.js";import"./CountryName.Cqd_TUYv.js";import"./LanguageName.DxFQWD1J.js";import"./Table.CnZn0sov.js";import"./index.B7lSVg36.js";import"./index.DiegRQm1.js";import"./index.DfgcMzeU.js";import"./useTranslation.DVdJGqhZ.js";import"./webmasterOffersApi.CMJMZz74.js";import"./OfferDomainRepository.C35Cl61S.js";import"./renderReactiveCell.D7yC0G9H.js";import"./Currency.Cy3QZbvy.js";import"./FlagIcon.DC8lzl7_.js";import"./NumberFormat.TovQIcex.js";var re=Object.defineProperty,ae=(a,t,r)=>t in a?re(a,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[t]=r,n=(a,t,r)=>ae(a,typeof t!="symbol"?t+"":t,r);class se{constructor(t,r){this.appContext=t,n(this,"form"),n(this,"offerQuery"),n(this,"updateMutation"),n(this,"offerCategoriesQuery"),n(this,"query"),n(this,"hostnamesQuery"),n(this,"postbackSettings"),this.hostnamesQuery=new F(t),this.query=new j(t,r),this.postbackSettings=new z(t,this.query.campaign),this.offerCategoriesQuery=new N(t);const s=this.query.data.campaign;this.offerQuery=new A(this.appContext,this.offerCategoriesQuery,s.offerId),this.form=new R(this.appContext,this.hostnamesQuery,this.offerQuery,s),this.updateMutation=new b(t.queryClient,{mutationFn:i=>w.patchCampaignsCampaignid({campaignId:r,campaignUpdateDto:i}),onError:i=>{t.notify.toastError(i)}}),S(this,{handleUpdate:M.bound})}get store(){return this.query.store}handleUpdate(){return this.updateMutation.mutate(this.form.group.changedValue)}}var oe=Object.defineProperty,ie=(a,t,r)=>t in a?oe(a,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[t]=r,ne=(a,t,r)=>ie(a,t+"",r);class me{constructor(t,r){ne(this,"item"),this.item=new se(t,r),Q(this,{},{autoBind:!0})}}const x=c.createContext(null);function _(){const a=c.useContext(x);if(!a)throw new Error("Необходимо зарегистрировать провайдер WebmasterCampaignModelContext");return a}const le={body:{padding:0}},ce=u(function(){const t=_(),r=t.item.form,s=t.item.offerQuery,i=t.item.offerQuery.data,m=f(()=>new G,[]),l=!f(()=>new k,[]).isBreakpointUp("md"),y=c.useMemo(()=>({y:367}),[]),C=c.useMemo(()=>l?{trigger:"hover",icon:e.jsx("div",{children:e.jsx(B,{onClick:m.enable})}),overlay:""}:void 0,[m,l]);return e.jsxs(J,{layout:"vertical",children:[e.jsxs(V,{children:[e.jsxs(d,{xs:24,md:11,lg:12,children:[e.jsx(I,{offer:i.offer}),e.jsx(T,{model:r.name}),e.jsx(D,{model:r.country,tooltip:C}),e.jsx(E,{model:r.language}),e.jsx(L,{model:r.trafficSource})]}),!l&&e.jsx(d,{xs:24,md:13,lg:12,children:e.jsx(h,{offerQuery:s,size:"small",scroll:y})})]}),l&&e.jsx(X,{size:"large",title:"География",open:m.isEnabled,onClose:m.disable,styles:le,children:e.jsx(h,{scroll:null,offerQuery:s})})]})}),g=u(function({model:t,title:r}){return e.jsxs(e.Fragment,{children:[e.jsx("h4",{children:r}),e.jsxs(K,{gutter:24,children:[e.jsx(d,{xs:24,lg:12,children:e.jsx(U,{model:t})}),e.jsx(d,{xs:24,lg:12,children:e.jsx(W,{templatesControl:t.controls.templates})})]})]})}),pe="_collapse_wrapper_1m4qz_1",de="_collapse_1m4qz_1",ue="_collapse_item_1m4qz_6",fe="_collapse_header_1m4qz_13",he="_card_body_1m4qz_19",ge="_card_header_1m4qz_23",o={collapse_wrapper:pe,collapse:de,collapse_item:ue,collapse_header:fe,card_body:he,card_header:ge},xe={body:o.card_body,header:o.card_header},_e=u(function(){const{t}=H("campaign"),r=_(),s=r.item,i=r.item.form,m=r.item.query.data.campaign;return e.jsxs(Y,{title:`${t("page.campaign")}: ${m.name}`,classNames:xe,children:[e.jsx(ce,{}),e.jsx(g,{model:s.form.landing,title:"Лендинг"}),s.form.transit&&e.jsx(g,{model:s.form.transit,title:"Транзит"}),e.jsx(Z,{rootClassName:o.collapse_wrapper,items:[{key:"postback",label:e.jsx(p,{align:"center",gap:"md",children:e.jsx("h4",{style:{margin:0,paddingRight:8},children:"Постбэк"})}),children:e.jsx(O,{model:s.postbackSettings}),className:o.collapse_item,classNames:{header:o.collapse_header}},{key:"utm",label:e.jsx("h4",{style:{margin:0,paddingRight:8},children:"UTM метки"}),children:e.jsx($,{model:i.utmParams}),className:o.collapse_item,classNames:{header:o.collapse_header}}],className:o.collapse,ghost:!0}),e.jsx(p,{gap:"sm",children:e.jsx(ee,{loading:s.updateMutation.isPending,size:"large",type:"primary",onClick:s.handleUpdate,children:"Сохранить изменения"})})]})}),ye="_container_1j27o_6",Ce={container:ye},je=u(function({campaignId:t}){const r=q(),s=f(()=>new me(r,t),[r,t]);return e.jsx(P,{className:Ce.container,children:e.jsx(x.Provider,{value:s,children:s.item.query.isLoading?e.jsx(p,{justify:"center",align:"center",style:{minHeight:"400px"},children:e.jsx(te,{size:"large"})}):s.item.query.isError?e.jsx(p,{justify:"center",align:"center",style:{minHeight:"400px"},children:e.jsx("div",{children:"Ошибка загрузки кампании"})}):e.jsx(_e,{})})})}),pt=()=>{const a=v.useParams();return e.jsx(je,{campaignId:a.campaignId})};export{pt as component};
