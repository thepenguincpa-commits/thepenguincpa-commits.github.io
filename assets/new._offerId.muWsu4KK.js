import{C as Te,D as et,W as Ee,ay as M,T as I,r as i,E as ae,s as N,aq as tt,m as Pe,e as xe,k as K,f as Ie,t as Fe,aV as ot,a0 as st,aw as ce,a6 as rt,aW as ke,o as k,a1 as ne,j as o,al as nt,aX as it,u as at,aY as ye}from"./index.CJpzWARr.js";import{B as H}from"./Box.CvVauy6S.js";import"./AppLayout.Dd4AyXhP.js";import{L as ct}from"./LayoutContainer.kUniMi3O.js";import{P as lt,a as dt,C as mt}from"./PostbackConfigFormGroup._zR3IWaf.js";import{d as ut}from"./OfferPayoutRepository.DMRgHBdS.js";import{O as pt,L as ve}from"./LocationsTable.Dr_CxosK.js";import{C as gt,D as ft,R as ht,O as bt,a as xt,b as yt,L as vt,T as Ct,c as Ce,d as je,A as jt,U as St}from"./DomainSettings.BdaMt-7E.js";import{A as wt,b as U}from"./validators.puhu6pph.js";import{u as Q}from"./useTranslation.D1-YSIqG.js";import{T as $t}from"./Toggler.Bo1KxCe6.js";import{G as ze}from"./GridRow.DmVNsMLH.js";import{C as F,R as Se}from"./row.ZVKcDUTg.js";import{D as Nt}from"./index.DLP9cbOY.js";import{C as _t}from"./index.B7lSVg36.js";import{u as Ot}from"./useCopyToClipboard.ByVXnvkX.js";import{g as Re,i as Be,T as Tt}from"./AntdIcon.BEv94oZ9.js";import{F as Et}from"./Table.CnZn0sov.js";import{T as v}from"./index.mfBRClzR.js";import{T as D}from"./index.DiegRQm1.js";import{E as Pt,S as It,a as Ft}from"./index.C7EzEdlH.js";import{I as kt}from"./index.UwxdIMsP.js";import{a as De,B as ie}from"./button.CTAkPJpI.js";import{C as zt}from"./Input.BJc5rBil.js";import{C as Rt}from"./_baseIteratee.CoQUSKdO.js";import"./index.5jmBMbM4.js";import"./SelectControl.BdHLXDxG.js";import"./webmasterOffersApi.CMJMZz74.js";import"./OfferDomainRepository.C35Cl61S.js";import"./renderReactiveCell.D7yC0G9H.js";import"./CountryName.Cqd_TUYv.js";import"./Currency.Cy3QZbvy.js";import"./FlagIcon.DC8lzl7_.js";import"./NumberFormat.TovQIcex.js";import"./LanguageName.DxFQWD1J.js";import"./EyeOutlined.C4wc5N2Y.js";import"./index.CvuYUNlW.js";import"./useTranslation.DVdJGqhZ.js";import"./useClosable.Emosx8Km.js";import"./index.DfgcMzeU.js";const Bt=new M("antStatusProcessing",{"0%":{transform:"scale(0.8)",opacity:.5},"100%":{transform:"scale(2.4)",opacity:0}}),Dt=new M("antZoomBadgeIn",{"0%":{transform:"scale(0) translate(50%, -50%)",opacity:0},"100%":{transform:"scale(1) translate(50%, -50%)"}}),Mt=new M("antZoomBadgeOut",{"0%":{transform:"scale(1) translate(50%, -50%)"},"100%":{transform:"scale(0) translate(50%, -50%)",opacity:0}}),Wt=new M("antNoWrapperZoomBadgeIn",{"0%":{transform:"scale(0)",opacity:0},"100%":{transform:"scale(1)"}}),At=new M("antNoWrapperZoomBadgeOut",{"0%":{transform:"scale(1)"},"100%":{transform:"scale(0)",opacity:0}}),Ht=new M("antBadgeLoadingCircle",{"0%":{transformOrigin:"50%"},"100%":{transform:"translate(50%, -50%) rotate(360deg)",transformOrigin:"50%"}}),Qt=t=>{const{componentCls:e,iconCls:r,antCls:s,badgeShadowSize:n,textFontSize:c,textFontSizeSM:a,statusSize:x,dotSize:p,textFontWeight:h,indicatorHeight:m,indicatorHeightSM:l,marginXS:u,calc:f}=t,g=`${s}-scroll-number`,S=Re(t,(C,{darkColor:w})=>({[`&${e} ${e}-color-${C}`]:{background:w,[`&:not(${e}-count)`]:{color:w},"a:hover &":{background:w}}}));return{[e]:Object.assign(Object.assign(Object.assign(Object.assign({},Ee(t)),{position:"relative",display:"inline-block",width:"fit-content",lineHeight:1,[`${e}-count`]:{display:"inline-flex",justifyContent:"center",zIndex:t.indicatorZIndex,minWidth:m,height:m,color:t.badgeTextColor,fontWeight:h,fontSize:c,lineHeight:I(m),whiteSpace:"nowrap",textAlign:"center",background:t.badgeColor,borderRadius:f(m).div(2).equal(),boxShadow:`0 0 0 ${I(n)} ${t.badgeShadowColor}`,transition:`background ${t.motionDurationMid}`,a:{color:t.badgeTextColor},"a:hover":{color:t.badgeTextColor},"a:hover &":{background:t.badgeColorHover}},[`${e}-count-sm`]:{minWidth:l,height:l,fontSize:a,lineHeight:I(l),borderRadius:f(l).div(2).equal()},[`${e}-multiple-words`]:{padding:`0 ${I(t.paddingXS)}`,bdi:{unicodeBidi:"plaintext"}},[`${e}-dot`]:{zIndex:t.indicatorZIndex,width:p,minWidth:p,height:p,background:t.badgeColor,borderRadius:"100%",boxShadow:`0 0 0 ${I(n)} ${t.badgeShadowColor}`},[`${e}-count, ${e}-dot, ${g}-custom-component`]:{position:"absolute",top:0,insetInlineEnd:0,transform:"translate(50%, -50%)",transformOrigin:"100% 0%",[`&${r}-spin`]:{animationName:Ht,animationDuration:"1s",animationIterationCount:"infinite",animationTimingFunction:"linear"}},[`&${e}-status`]:{lineHeight:"inherit",verticalAlign:"baseline",[`${e}-status-dot`]:{position:"relative",top:-1,display:"inline-block",width:x,height:x,verticalAlign:"middle",borderRadius:"50%"},[`${e}-status-success`]:{backgroundColor:t.colorSuccess},[`${e}-status-processing`]:{overflow:"visible",color:t.colorInfo,backgroundColor:t.colorInfo,borderColor:"currentcolor","&::after":{position:"absolute",top:0,insetInlineStart:0,width:"100%",height:"100%",borderWidth:n,borderStyle:"solid",borderColor:"inherit",borderRadius:"50%",animationName:Bt,animationDuration:t.badgeProcessingDuration,animationIterationCount:"infinite",animationTimingFunction:"ease-in-out",content:'""'}},[`${e}-status-default`]:{backgroundColor:t.colorTextPlaceholder},[`${e}-status-error`]:{backgroundColor:t.colorError},[`${e}-status-warning`]:{backgroundColor:t.colorWarning},[`${e}-status-text`]:{marginInlineStart:u,color:t.colorText,fontSize:t.fontSize}}}),S),{[`${e}-zoom-appear, ${e}-zoom-enter`]:{animationName:Dt,animationDuration:t.motionDurationSlow,animationTimingFunction:t.motionEaseOutBack,animationFillMode:"both"},[`${e}-zoom-leave`]:{animationName:Mt,animationDuration:t.motionDurationSlow,animationTimingFunction:t.motionEaseOutBack,animationFillMode:"both"},[`&${e}-not-a-wrapper`]:{[`${e}-zoom-appear, ${e}-zoom-enter`]:{animationName:Wt,animationDuration:t.motionDurationSlow,animationTimingFunction:t.motionEaseOutBack},[`${e}-zoom-leave`]:{animationName:At,animationDuration:t.motionDurationSlow,animationTimingFunction:t.motionEaseOutBack},[`&:not(${e}-status)`]:{verticalAlign:"middle"},[`${g}-custom-component, ${e}-count`]:{transform:"none"},[`${g}-custom-component, ${g}`]:{position:"relative",top:"auto",display:"block",transformOrigin:"50% 50%"}},[g]:{overflow:"hidden",transition:`all ${t.motionDurationMid} ${t.motionEaseOutBack}`,[`${g}-only`]:{position:"relative",display:"inline-block",height:m,transition:`all ${t.motionDurationSlow} ${t.motionEaseOutBack}`,WebkitTransformStyle:"preserve-3d",WebkitBackfaceVisibility:"hidden",[`> p${g}-only-unit`]:{height:m,margin:0,WebkitTransformStyle:"preserve-3d",WebkitBackfaceVisibility:"hidden"}},[`${g}-symbol`]:{verticalAlign:"top"}},"&-rtl":{direction:"rtl",[`${e}-count, ${e}-dot, ${g}-custom-component`]:{transform:"translate(-50%, -50%)"}}})}},Me=t=>{const{fontHeight:e,lineWidth:r,marginXS:s,colorBorderBg:n}=t,c=e,a=r,x=t.colorTextLightSolid,p=t.colorError,h=t.colorErrorHover;return et(t,{badgeFontHeight:c,badgeShadowSize:a,badgeTextColor:x,badgeColor:p,badgeColorHover:h,badgeShadowColor:n,badgeProcessingDuration:"1.2s",badgeRibbonOffset:s,badgeRibbonCornerTransform:"scaleY(0.75)",badgeRibbonCornerFilter:"brightness(75%)"})},We=t=>{const{fontSize:e,lineHeight:r,fontSizeSM:s,lineWidth:n}=t;return{indicatorZIndex:"auto",indicatorHeight:Math.round(e*r)-2*n,indicatorHeightSM:e,dotSize:s/2,textFontSize:s,textFontSizeSM:s,textFontWeight:"normal",statusSize:s/2}},Vt=Te("Badge",t=>{const e=Me(t);return Qt(e)},We),qt=t=>{const{antCls:e,badgeFontHeight:r,marginXS:s,badgeRibbonOffset:n,calc:c}=t,a=`${e}-ribbon`,x=`${e}-ribbon-wrapper`,p=Re(t,(h,{darkColor:m})=>({[`&${a}-color-${h}`]:{background:m,color:m}}));return{[x]:{position:"relative"},[a]:Object.assign(Object.assign(Object.assign(Object.assign({},Ee(t)),{position:"absolute",top:s,padding:`0 ${I(t.paddingXS)}`,color:t.colorPrimary,lineHeight:I(r),whiteSpace:"nowrap",backgroundColor:t.colorPrimary,borderRadius:t.borderRadiusSM,[`${a}-text`]:{color:t.badgeTextColor},[`${a}-corner`]:{position:"absolute",top:"100%",width:n,height:n,color:"currentcolor",border:`${I(c(n).div(2).equal())} solid`,transform:t.badgeRibbonCornerTransform,transformOrigin:"top",filter:t.badgeRibbonCornerFilter}}),p),{[`&${a}-placement-end`]:{insetInlineEnd:c(n).mul(-1).equal(),borderEndEndRadius:0,[`${a}-corner`]:{insetInlineEnd:0,borderInlineEndColor:"transparent",borderBlockEndColor:"transparent"}},[`&${a}-placement-start`]:{insetInlineStart:c(n).mul(-1).equal(),borderEndStartRadius:0,[`${a}-corner`]:{insetInlineStart:0,borderBlockEndColor:"transparent",borderInlineStartColor:"transparent"}},"&-rtl":{direction:"rtl"}})}},Lt=Te(["Badge","Ribbon"],t=>{const e=Me(t);return qt(e)},We),Zt=t=>{const{className:e,prefixCls:r,style:s,color:n,children:c,text:a,placement:x="end",rootClassName:p}=t,{getPrefixCls:h,direction:m}=i.useContext(ae),l=h("ribbon",r),u=`${l}-wrapper`,[f,g,S]=Lt(l,u),C=Be(n,!1),w=N(l,`${l}-placement-${x}`,{[`${l}-rtl`]:m==="rtl",[`${l}-color-${n}`]:C},e),y={},_={};return n&&!C&&(y.background=n,_.color=n),f(i.createElement("div",{className:N(u,p,g,S)},c,i.createElement("div",{className:N(w,g),style:Object.assign(Object.assign({},y),s)},i.createElement("span",{className:`${l}-text`},a),i.createElement("div",{className:`${l}-corner`,style:_}))))},we=t=>{const{prefixCls:e,value:r,current:s,offset:n=0}=t;let c;return n&&(c={position:"absolute",top:`${n}00%`,left:0}),i.createElement("span",{style:c,className:N(`${e}-only-unit`,{current:s})},r)};function Kt(t,e,r){let s=t,n=0;for(;(s+10)%10!==e;)s+=r,n+=r;return n}const Ut=t=>{const{prefixCls:e,count:r,value:s}=t,n=Number(s),c=Math.abs(r),[a,x]=i.useState(n),[p,h]=i.useState(c),m=()=>{x(n),h(c)};i.useEffect(()=>{const f=setTimeout(m,1e3);return()=>clearTimeout(f)},[n]);let l,u;if(a===n||Number.isNaN(n)||Number.isNaN(a))l=[i.createElement(we,Object.assign({},t,{key:n,current:!0}))],u={transition:"none"};else{l=[];const f=n+10,g=[];for(let y=n;y<=f;y+=1)g.push(y);const S=p<c?1:-1,C=g.findIndex(y=>y%10===a);l=(S<0?g.slice(0,C+1):g.slice(C)).map((y,_)=>{const X=y%10;return i.createElement(we,Object.assign({},t,{key:y,value:X,offset:S<0?_-C:_,current:_===C}))}),u={transform:`translateY(${-Kt(a,n,S)}00%)`}}return i.createElement("span",{className:`${e}-only`,style:u,onTransitionEnd:m},l)};var Xt=function(t,e){var r={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(r[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(t);n<s.length;n++)e.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(t,s[n])&&(r[s[n]]=t[s[n]]);return r};const Gt=i.forwardRef((t,e)=>{const{prefixCls:r,count:s,className:n,motionClassName:c,style:a,title:x,show:p,component:h="sup",children:m}=t,l=Xt(t,["prefixCls","count","className","motionClassName","style","title","show","component","children"]),{getPrefixCls:u}=i.useContext(ae),f=u("scroll-number",r),g=Object.assign(Object.assign({},l),{"data-show":p,style:a,className:N(f,n,c),title:x});let S=s;if(s&&Number(s)%1===0){const C=String(s).split("");S=i.createElement("bdi",null,C.map((w,y)=>i.createElement(Ut,{prefixCls:f,count:Number(s),value:w,key:C.length-y})))}return a?.borderColor&&(g.style=Object.assign(Object.assign({},a),{boxShadow:`0 0 0 1px ${a.borderColor} inset`})),m?De(m,C=>({className:N(`${f}-custom-component`,C?.className,c)})):i.createElement(h,Object.assign({},g,{ref:e}),S)});var Jt=function(t,e){var r={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(r[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(t);n<s.length;n++)e.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(t,s[n])&&(r[s[n]]=t[s[n]]);return r};const Yt=i.forwardRef((t,e)=>{var r,s,n,c,a;const{prefixCls:x,scrollNumberPrefixCls:p,children:h,status:m,text:l,color:u,count:f=null,overflowCount:g=99,dot:S=!1,size:C="default",title:w,offset:y,style:_,className:X,rootClassName:Ve,classNames:T,styles:$,showZero:V=!1}=t,le=Jt(t,["prefixCls","scrollNumberPrefixCls","children","status","text","color","count","overflowCount","dot","size","title","offset","style","className","rootClassName","classNames","styles","showZero"]),{getPrefixCls:de,direction:G,badge:d}=i.useContext(ae),j=de("badge",x),[me,qe,Le]=Vt(j),J=f>g?`${g}+`:f,W=J==="0"||J===0||l==="0"||l===0,ue=f===null||W&&!V,Y=(m!=null||u!=null)&&ue,Ze=m!=null||!W,A=S&&!W,z=A?"":J,R=i.useMemo(()=>((z==null||z==="")&&(l==null||l==="")||W&&!V)&&!A,[z,W,V,A,l]),pe=i.useRef(f);R||(pe.current=f);const B=pe.current,ge=i.useRef(z);R||(ge.current=z);const ee=ge.current,fe=i.useRef(A);R||(fe.current=A);const q=i.useMemo(()=>{if(!y)return Object.assign(Object.assign({},d?.style),_);const O={marginTop:y[1]};return G==="rtl"?O.left=parseInt(y[0],10):O.right=-parseInt(y[0],10),Object.assign(Object.assign(Object.assign({},O),d?.style),_)},[G,y,_,d?.style]),Ke=w??(typeof B=="string"||typeof B=="number"?B:void 0),he=!R&&(l===0?V:!!l&&l!==!0),Ue=he?i.createElement("span",{className:`${j}-status-text`},l):null,Xe=!B||typeof B!="object"?void 0:De(B,O=>({style:Object.assign(Object.assign({},q),O.style)})),L=Be(u,!1),Ge=N(T?.indicator,(r=d?.classNames)===null||r===void 0?void 0:r.indicator,{[`${j}-status-dot`]:Y,[`${j}-status-${m}`]:!!m,[`${j}-color-${u}`]:L}),te={};u&&!L&&(te.color=u,te.background=u);const be=N(j,{[`${j}-status`]:Y,[`${j}-not-a-wrapper`]:!h,[`${j}-rtl`]:G==="rtl"},X,Ve,d?.className,(s=d?.classNames)===null||s===void 0?void 0:s.root,T?.root,qe,Le);if(!h&&Y&&(l||Ze||!ue)){const O=q.color;return me(i.createElement("span",Object.assign({},le,{className:be,style:Object.assign(Object.assign(Object.assign({},$?.root),(n=d?.styles)===null||n===void 0?void 0:n.root),q)}),i.createElement("span",{className:Ge,style:Object.assign(Object.assign(Object.assign({},$?.indicator),(c=d?.styles)===null||c===void 0?void 0:c.indicator),te)}),he&&i.createElement("span",{style:{color:O},className:`${j}-status-text`},l)))}return me(i.createElement("span",Object.assign({ref:e},le,{className:be,style:Object.assign(Object.assign({},(a=d?.styles)===null||a===void 0?void 0:a.root),$?.root)}),h,i.createElement(tt,{visible:!R,motionName:`${j}-zoom`,motionAppear:!1,motionDeadline:1e3},({className:O})=>{var oe,se;const Je=de("scroll-number",p),re=fe.current,Ye=N(T?.indicator,(oe=d?.classNames)===null||oe===void 0?void 0:oe.indicator,{[`${j}-dot`]:re,[`${j}-count`]:!re,[`${j}-count-sm`]:C==="small",[`${j}-multiple-words`]:!re&&ee&&ee.toString().length>1,[`${j}-status-${m}`]:!!m,[`${j}-color-${u}`]:L});let Z=Object.assign(Object.assign(Object.assign({},$?.indicator),(se=d?.styles)===null||se===void 0?void 0:se.indicator),q);return u&&!L&&(Z=Z||{},Z.background=u),i.createElement(Gt,{prefixCls:Je,show:!R,motionClassName:O,className:Ye,count:ee,title:Ke,style:Z,key:"scrollNumber"},Xe)}),Ue))}),Ae=Yt;Ae.Ribbon=Zt;class eo extends wt{constructor(e){super(),this.controls=e,Pe(this,{controls:Ie,value:xe.struct,changedValue:xe.struct,setValue:K})}add(e,r){return r!==void 0?this.controls.splice(r,0,e):this.controls.push(e),this}remove(e){return this.controls.splice(e,1),this}get value(){return this.controls.map(e=>e.value)}get changedValue(){return this.controls.filter(e=>e.isChanged).map(e=>e.value)}setValue(e){for(let r=0;r<e.length;r++)this.controls[r].setValue(e[r])}*getControls(){for(const e of this.controls)yield e}}var to=Object.defineProperty,oo=(t,e,r)=>e in t?to(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,so=(t,e,r)=>oo(t,e+"",r);class ro{constructor(e){this.appContext=e,so(this,"group",new eo([])),Fe(this,{},{autoBind:!0})}get count(){return this.group.controls.length}get isEmpty(){return this.count===0}get isError(){return this.group.isInvalid}add(){const e=`new_${this.group.controls.length}`,r=new lt(e),s=new dt(this.appContext,r);s.setDirty(!0),s.setTouched(!0),this.group.add(s),setTimeout(()=>{s.firstErrorControl?.element?.focus()},300)}delete(e){const r=this.group.controls.findIndex(s=>s.postbackConfig.id===e);r!==-1&&(console.log({index:r}),this.group.remove(r))}}var no=Object.defineProperty,io=(t,e,r)=>e in t?no(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,E=(t,e,r)=>io(t,typeof e!="symbol"?e+"":e,r);class ao{constructor(e,r){this.appContext=e,E(this,"form"),E(this,"offerQuery"),E(this,"campaign"),E(this,"createMutation"),E(this,"offerCategoriesQuery"),E(this,"hostnamesQuery"),E(this,"postbacksForm"),E(this,"activeKeys",[]),this.campaign=new ot("new").partialUpdateFromJson({offerId:r}),this.offerCategoriesQuery=new ut(e),this.hostnamesQuery=new mt(e),this.offerQuery=new pt(this.appContext,this.offerCategoriesQuery,this.campaign.offerId),this.form=new gt(this.appContext,this.hostnamesQuery,this.offerQuery,this.campaign),this.postbacksForm=new ro(e),this.createMutation=new st(e.queryClient,{mutationFn:()=>rt.postCampaigns({campaignCreateDto:{offerId:this.campaign.offerId,postbacks:this.postbacksForm.group.value.map(s=>({...s,userId:e.auth.userId,type:"campaign"})),...this.form.group.value}}),onSuccess:s=>{ce.setData(e.queryClient,s),e.router.instance.navigate({to:"/campaigns/$campaignId",params:{campaignId:s.id}})},onError:s=>{e.notify.toastError(s)}}),Pe(this,{activeKeys:Ie,addPostback:K.bound,handleSubmit:K.bound,handleChangeActiveKeys:K.bound},{autoBind:!0})}handleChangeActiveKeys(e){this.activeKeys=e}addPostback(e){e?.stopPropagation(),this.activeKeys.includes("postback")||(this.activeKeys=[...this.activeKeys,"postback"]),this.postbacksForm.add()}handleSubmit(){if(this.form.group.isInvalid){this.form.group.setDirty(!0),this.form.group.setTouched(!0),this.form.group.firstErrorControl?.element?.focus();return}return this.createMutation.mutate()}}var co=Object.defineProperty,lo=(t,e,r)=>e in t?co(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,mo=(t,e,r)=>lo(t,e+"",r);class uo{constructor(e,r){this.appContext=e,mo(this,"item"),this.item=new ao(e,r),Fe(this,{},{autoBind:!0})}initFrom(e){const r=new ce(this.appContext,e);return ke(()=>r.isFetched&&!r.isStale&&r.isSuccess,()=>{this.item.campaign.updateFromJson(r.data.toJSON())})}}const He=i.createContext(null);function Qe(){const t=i.useContext(He);if(!t)throw new Error("Необходимо зарегистрировать провайдер WebmasterNewCampaignModelContext");return t}const po={body:{padding:0}},go=k(function(){const{t:e}=Q("campaign"),r=Qe(),s=r.item.form,n=r.item.offerQuery,c=r.item.offerQuery.data,a=ne(()=>new $t,[]),p=!ne(()=>new ft,[]).isBreakpointUp("md"),h=i.useMemo(()=>({y:367}),[]),m=i.useMemo(()=>p?{trigger:"hover",icon:o.jsx("div",{children:o.jsx(ht,{onClick:a.enable})}),overlay:""}:void 0,[a,p]);return o.jsxs(U,{layout:"vertical",children:[o.jsxs(ze,{children:[o.jsxs(F,{xs:24,md:11,lg:12,children:[o.jsx(bt,{offer:c.offer}),o.jsx(xt,{model:s.name}),o.jsx(yt,{model:s.country,tooltip:m}),o.jsx(vt,{model:s.language}),o.jsx(Ct,{model:s.trafficSource})]}),!p&&o.jsx(F,{xs:24,md:13,lg:12,children:o.jsx(ve,{offerQuery:n,size:"small",scroll:h})})]}),p&&o.jsx(Nt,{size:"large",title:e("form.geographyTitle"),open:a.isEnabled,onClose:a.disable,styles:po,children:o.jsx(ve,{scroll:null,offerQuery:n})})]})}),$e=k(function({model:e,isTransit:r}){return r?o.jsxs(o.Fragment,{children:[o.jsxs("h4",{children:["Транзит"," ",o.jsx(_t,{onChange:s=>{e.setIsActive(s.target.checked)}})]}),e.isActive&&o.jsxs(Se,{gutter:24,children:[o.jsx(F,{xs:24,lg:12,children:o.jsx(Ce,{isTransit:!0,model:e})}),o.jsx(F,{xs:24,lg:12,children:o.jsx(je,{templatesControl:e.controls.templates})})]})]}):o.jsxs(o.Fragment,{children:[o.jsx("h4",{children:"Лендинг"}),o.jsxs(Se,{gutter:24,children:[o.jsx(F,{xs:24,lg:12,children:o.jsx(Ce,{model:e})}),o.jsx(F,{xs:24,lg:12,children:o.jsx(je,{templatesControl:e.controls.templates})})]})]})}),fo="_text_1ct52_1",ho="_inline_1ct52_4",Ne={text:fo,inline:ho},b=i.memo(function({className:e,value:r,placement:s,children:n,inline:c,...a}){const[x,p]=i.useState(!1),[h,m]=Ot(),{t:l}=Q("common"),u=i.useRef(x);return u.current=x,i.useEffect(()=>{if(h.value&&!u.current){p(!0);const f=setTimeout(()=>{p(!1)},1e3);return()=>{clearTimeout(f)}}},[h]),o.jsx("div",{className:N(Ne.text,{[Ne.inline]:c}),onClick:f=>{f.preventDefault(),m(r)},...a,children:o.jsx(Tt,{open:x,overlay:l("actions.copied"),placement:s,children:n})})});b.displayName="ForwardRef shared/ui/(ClipboardText)";const bo=t=>[{key:"1",macro:o.jsx(b,{value:"{id}",children:o.jsx(v,{children:"id"})}),description:t("macros.description.clickId")},{key:"2",macro:o.jsx(b,{value:"{date}",children:o.jsx(v,{children:"date"})}),description:t("macros.description.conversionTime")},{key:"3",macro:o.jsx(b,{value:"{campaign_id}",children:o.jsx(v,{children:"campaign_id"})}),description:t("macros.description.campaignId")},{key:"4",macro:o.jsx(b,{value:"{campaign_language}",children:o.jsx(v,{children:"campaign_language"})}),description:t("macros.description.campaignLanguage")},{key:"5",macro:o.jsx(b,{value:"{offer_id}",children:o.jsx(v,{children:"offer_id"})}),description:t("macros.description.offerId")},{key:"6",macro:o.jsx(b,{value:"{country_code}",children:o.jsx(v,{children:"country_code"})}),description:t("macros.description.country")},{key:"7",macro:o.jsx(b,{value:"{ip}",children:o.jsx(v,{children:"ip"})}),description:t("macros.description.ip")},{key:"8",macro:o.jsx(b,{value:"{traffic_type}",children:o.jsx(v,{children:"traffic_type"})}),description:t("macros.description.trafficType")},{key:"9",macro:o.jsxs(o.Fragment,{children:[o.jsx(b,{inline:!0,value:"{sid1}",children:o.jsx(v,{children:"sid1"})}),o.jsx(b,{inline:!0,value:"{sid2}",children:o.jsx(v,{children:"sid2"})}),o.jsx(b,{inline:!0,value:"{sid3}",children:o.jsx(v,{children:"sid3"})}),o.jsx(b,{inline:!0,value:"{sid4}",children:o.jsx(v,{children:"sid4"})}),o.jsx(b,{inline:!0,value:"{sid5}",children:o.jsx(v,{children:"sid5"})})]}),description:t("macros.description.subIds")},{key:"10",macro:o.jsx(b,{value:"{status}",children:o.jsx(v,{children:"status"})}),description:`${t("macros.description.status")} (${Object.values(nt).map(e=>`"${e}"`).join(", ")})`},{key:"11",macro:o.jsx(b,{value:"{payout}",children:o.jsx(v,{children:"payout"})}),description:t("macros.description.payout")},{key:"12",macro:o.jsx(b,{value:"{currency}",children:o.jsx(v,{children:"currency"})}),description:t("macros.description.currency")},{key:"13",macro:o.jsx(b,{value:"{type}",children:o.jsx(v,{children:"type"})}),description:t("macros.description.conversionType")},{key:"14",macro:o.jsx(b,{value:"{campaign_country_code}",children:o.jsx(v,{children:"campaign_country_code"})}),description:t("macros.description.geo")},{key:"15",macro:o.jsx(b,{value:"{reason}",children:o.jsx(v,{children:"reason"})}),description:t("macros.description.cancellationReason")}],xo=k(function(){const{t:e}=Q("campaign"),r=i.useMemo(()=>[{title:e("macros.macro"),dataIndex:"macro",key:"macro",width:200,render:n=>n},{title:e("macros.value"),dataIndex:"description",key:"description"}],[e]),s=i.useMemo(()=>bo(e),[e]);return o.jsx(Et,{columns:r,dataSource:s,pagination:!1,size:"small",bordered:!0})}),yo={},vo=k(function({model:e}){return o.jsxs(ze,{className:yo.container,children:[o.jsxs(F,{xs:24,md:11,xl:12,children:[o.jsx(jt,{style:{marginBottom:20},type:"info",description:o.jsxs(o.Fragment,{children:[o.jsxs(D.Paragraph,{type:"secondary",style:{maxWidth:"80ch"},children:["Постбэк запрос будет отправлен на указанный адрес методом"," ",o.jsx(D.Text,{code:!0,children:"GET"}),". Для передачи параметров в запрос Вы можете использовать макросы, указанные в таблице."]}),o.jsxs(D.Paragraph,{type:"secondary",style:{maxWidth:"80ch",marginBottom:0},children:["Пример, постбэк ссылки для передачи суммы заработка и субаккаунта:",o.jsx("br",{}),o.jsx(D.Text,{code:!0,children:"http://example.com/mystat.php?myprofit={payout}&mySubID={sid1}"}),o.jsx("br",{}),"В момент отправки данных макросы"," ",o.jsx(D.Text,{code:!0,children:"{payout}"})," и"," ",o.jsx(D.Text,{code:!0,children:"{sid1}"})," будут заменены на соответствующие значения."]})]})}),e.isEmpty&&o.jsx(H,{justify:"center",align:"center",children:o.jsx(Pt,{})}),e.group.controls.map(r=>o.jsx(Co,{handleDelete:e.delete,form:r},r.postbackConfig.id))]}),o.jsx(F,{xs:24,md:13,xl:12,children:o.jsx(xo,{})})]})}),Co=k(function({form:e,handleDelete:r}){const s=e.controls,{t:n}=Q("common");return o.jsxs(U,{layout:"vertical",children:[o.jsx(U.Item,{...s.url.itemProps,children:o.jsx(kt,{...s.url.inputProps})}),o.jsx(U.Item,{...s.eventTypes.itemProps,children:o.jsx(It,{...s.eventTypes.inputProps})}),o.jsx(H,{justify:"end",gap:"xs",children:o.jsx(ie,{danger:!0,onClick:()=>r(e.postbackConfig.id),children:n("buttons.delete")})})]})}),jo="_collapse_wrapper_1m4qz_1",So="_collapse_1m4qz_1",wo="_collapse_item_1m4qz_6",$o="_collapse_header_1m4qz_13",No="_card_body_1m4qz_19",_o="_card_header_1m4qz_23",P={collapse_wrapper:jo,collapse:So,collapse_item:wo,collapse_header:$o,card_body:No,card_header:_o},Oo={body:P.card_body,header:P.card_header},To=k(function(){const{t:e}=Q("campaign"),r=Qe(),s=r.item,n=r.item.postbacksForm,c=r.item.form,a=it.useToken();return o.jsxs(zt,{title:e("page.newCampaign"),classNames:Oo,children:[o.jsx(go,{}),o.jsx($e,{model:s.form.landing}),o.jsx($e,{isTransit:!0,model:s.form.transit}),o.jsx(Rt,{rootClassName:P.collapse_wrapper,activeKey:s.activeKeys,onChange:s.handleChangeActiveKeys,items:[{key:"postback",label:o.jsxs(H,{align:"center",gap:"md",children:[o.jsx(Ae,{color:n.isError?a.token.colorError:a.token.colorInfo,count:n.count,children:o.jsx("h4",{style:{margin:0,paddingRight:8},children:"Постбэк"})}),o.jsx(ie,{onClick:s.addPostback,children:e("buttons.add",{ns:"common"})})]}),children:o.jsx(vo,{model:n}),className:P.collapse_item,classNames:{header:P.collapse_header}},{key:"utm",label:o.jsx("h4",{style:{margin:0,paddingRight:8},children:"UTM метки"}),children:o.jsx(St,{model:c.utmParams}),className:P.collapse_item,classNames:{header:P.collapse_header}}],className:P.collapse,ghost:!0}),o.jsx(H,{gap:"sm",children:o.jsx(ie,{loading:s.createMutation.isPending,size:"large",type:"primary",onClick:s.handleSubmit,children:"Создать поток"})})]})}),Eo="_container_13kew_6",Po="_wrapper_13kew_12",_e={container:Eo,wrapper:Po};function Oe(t){return t?t.isFetched&&!t.isStale&&t.isSuccess:!0}const Io=k(function({searchParams:e,offerId:r}){const s=at(),n=ne(()=>new uo(s,r),[s,r]),c=i.useMemo(()=>e.from?new ce(s,e.from):null,[e.from,s]);return i.useEffect(()=>{if(c)return ke(()=>Oe(c),()=>{n.item.campaign.updateFromJson(c.data.toJSON())})},[n,c]),o.jsx(ct,{className:N(_e.wrapper,_e.container),children:o.jsx(He.Provider,{value:n,children:Oe(c)?o.jsx(To,{}):o.jsx(H,{justify:"center",align:"center",children:o.jsx(Ft,{size:"large"})})})})}),ys=()=>{const t=ye.useSearch(),e=ye.useParams();return o.jsx(Io,{offerId:e.offerId,searchParams:t})};export{ys as component};
