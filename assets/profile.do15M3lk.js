import{R as u,r as s,C as fe,d as M,e as lt,m as ct,f,h as dt,i as mt,k as Pe,I as Le,_ as ze,n as Q,p as he,M as ee,q as te,s as Me,o as J,u as ae,j as i,t as ut,v as pt,w as Se}from"./index.D0ZL9dlq.js";import{u as se}from"./useStore.rIWB3VHp.js";import{C as Te,R as gt}from"./row.BNxq_Flf.js";import{G as ye}from"./GridRow.BSx-bdOS.js";import{a as ht}from"./LayoutContainer.D5vzTIRK.js";import{I as T,r as A,n as ue,m as Y,V as ft,F as xe,a as S,b as yt,e as xt,p as vt}from"./validators.BorTVuCh.js";import{u as bt}from"./useTranslation.74tzyRXt.js";import{u as $t,r as je,C as ve,R as wt}from"./EyeOutlined.BTRVFJFJ.js";import{I as B}from"./index.MgSLeBeq.js";import{F as ne,P as Ct,R as Pt}from"./SyncOutlined.BiVJrYuP.js";import{c as St,u as jt,B as I}from"./button.OEP3CgYZ.js";import{m as Ot,P as Et,D as _t,S as Be,u as Fe,Q as It}from"./QueryWithState.BPq9GHGk.js";import{U as Nt,R as Lt}from"./InboxOutlined.B31mZvI_.js";import{R as zt}from"./UserOutlined.CrZ-qRnf.js";import{T as Mt,M as Tt}from"./Toggler.DXS98LMk.js";import{R as Bt}from"./DeleteOutlined.BjDLvYpZ.js";import"./index.CA_kN61l.js";const be=u.createContext({});be.Consumer;var Re=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(t);a<r.length;a++)e.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(t,r[a])&&(n[r[a]]=t[r[a]]);return n};const Ft=t=>{var{prefixCls:e,className:n,avatar:r,title:a,description:o}=t,p=Re(t,["prefixCls","className","avatar","title","description"]);const{getPrefixCls:c}=s.useContext(fe),l=c("list",e),x=M(`${l}-item-meta`,n),m=u.createElement("div",{className:`${l}-item-meta-content`},a&&u.createElement("h4",{className:`${l}-item-meta-title`},a),o&&u.createElement("div",{className:`${l}-item-meta-description`},o));return u.createElement("div",Object.assign({},p,{className:x}),r&&u.createElement("div",{className:`${l}-item-meta-avatar`},r),(a||o)&&m)},Rt=u.forwardRef((t,e)=>{const{prefixCls:n,children:r,actions:a,extra:o,styles:p,className:c,classNames:l,colStyle:x}=t,m=Re(t,["prefixCls","children","actions","extra","styles","className","classNames","colStyle"]),{grid:h,itemLayout:d}=s.useContext(be),{getPrefixCls:w,list:b}=s.useContext(fe),O=$=>{var y,E;return M((E=(y=b?.item)===null||y===void 0?void 0:y.classNames)===null||E===void 0?void 0:E[$],l?.[$])},N=$=>{var y,E;return Object.assign(Object.assign({},(E=(y=b?.item)===null||y===void 0?void 0:y.styles)===null||E===void 0?void 0:E[$]),p?.[$])},H=()=>{let $=!1;return s.Children.forEach(r,y=>{typeof y=="string"&&($=!0)}),$&&s.Children.count(r)>1},L=()=>d==="vertical"?!!o:!H(),P=w("list",n),z=a&&a.length>0&&u.createElement("ul",{className:M(`${P}-item-action`,O("actions")),key:"actions",style:N("actions")},a.map(($,y)=>u.createElement("li",{key:`${P}-item-action-${y}`},$,y!==a.length-1&&u.createElement("em",{className:`${P}-item-action-split`})))),G=h?"div":"li",F=u.createElement(G,Object.assign({},m,h?{}:{ref:e},{className:M(`${P}-item`,{[`${P}-item-no-flex`]:!L()},c)}),d==="vertical"&&o?[u.createElement("div",{className:`${P}-item-main`,key:"content"},r,z),u.createElement("div",{className:M(`${P}-item-extra`,O("extra")),key:"extra",style:N("extra")},o)]:[r,z,St(o,{key:"extra"})]);return h?u.createElement(Te,{ref:e,flex:1,style:x},F):F}),qe=Rt;qe.Meta=Ft;const qt=t=>{const{listBorderedCls:e,componentCls:n,paddingLG:r,margin:a,itemPaddingSM:o,itemPaddingLG:p,marginLG:c,borderRadiusLG:l}=t;return{[e]:{border:`${f(t.lineWidth)} ${t.lineType} ${t.colorBorder}`,borderRadius:l,[`${n}-header,${n}-footer,${n}-item`]:{paddingInline:r},[`${n}-pagination`]:{margin:`${f(a)} ${f(c)}`}},[`${e}${n}-sm`]:{[`${n}-item,${n}-header,${n}-footer`]:{padding:o}},[`${e}${n}-lg`]:{[`${n}-item,${n}-header,${n}-footer`]:{padding:p}}}},Dt=t=>{const{componentCls:e,screenSM:n,screenMD:r,marginLG:a,marginSM:o,margin:p}=t;return{[`@media screen and (max-width:${r}px)`]:{[e]:{[`${e}-item`]:{[`${e}-item-action`]:{marginInlineStart:a}}},[`${e}-vertical`]:{[`${e}-item`]:{[`${e}-item-extra`]:{marginInlineStart:a}}}},[`@media screen and (max-width: ${n}px)`]:{[e]:{[`${e}-item`]:{flexWrap:"wrap",[`${e}-action`]:{marginInlineStart:o}}},[`${e}-vertical`]:{[`${e}-item`]:{flexWrap:"wrap-reverse",[`${e}-item-main`]:{minWidth:t.contentWidth},[`${e}-item-extra`]:{margin:`auto auto ${f(p)}`}}}}}},At=t=>{const{componentCls:e,antCls:n,controlHeight:r,minHeight:a,paddingSM:o,marginLG:p,padding:c,itemPadding:l,colorPrimary:x,itemPaddingSM:m,itemPaddingLG:h,paddingXS:d,margin:w,colorText:b,colorTextDescription:O,motionDurationSlow:N,lineWidth:H,headerBg:L,footerBg:P,emptyTextPadding:z,metaMarginBottom:G,avatarMarginRight:F,titleMarginBottom:$,descriptionFontSize:y}=t;return{[e]:Object.assign(Object.assign({},dt(t)),{position:"relative","--rc-virtual-list-scrollbar-bg":t.colorSplit,"*":{outline:"none"},[`${e}-header`]:{background:L},[`${e}-footer`]:{background:P},[`${e}-header, ${e}-footer`]:{paddingBlock:o},[`${e}-pagination`]:{marginBlockStart:p,[`${n}-pagination-options`]:{textAlign:"start"}},[`${e}-spin`]:{minHeight:a,textAlign:"center"},[`${e}-items`]:{margin:0,padding:0,listStyle:"none"},[`${e}-item`]:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:l,color:b,[`${e}-item-meta`]:{display:"flex",flex:1,alignItems:"flex-start",maxWidth:"100%",[`${e}-item-meta-avatar`]:{marginInlineEnd:F},[`${e}-item-meta-content`]:{flex:"1 0",width:0,color:b},[`${e}-item-meta-title`]:{margin:`0 0 ${f(t.marginXXS)} 0`,color:b,fontSize:t.fontSize,lineHeight:t.lineHeight,"> a":{color:b,transition:`all ${N}`,"&:hover":{color:x}}},[`${e}-item-meta-description`]:{color:O,fontSize:y,lineHeight:t.lineHeight}},[`${e}-item-action`]:{flex:"0 0 auto",marginInlineStart:t.marginXXL,padding:0,fontSize:0,listStyle:"none","& > li":{position:"relative",display:"inline-block",padding:`0 ${f(d)}`,color:O,fontSize:t.fontSize,lineHeight:t.lineHeight,textAlign:"center","&:first-child":{paddingInlineStart:0}},[`${e}-item-action-split`]:{position:"absolute",insetBlockStart:"50%",insetInlineEnd:0,width:H,height:t.calc(t.fontHeight).sub(t.calc(t.marginXXS).mul(2)).equal(),transform:"translateY(-50%)",backgroundColor:t.colorSplit}}},[`${e}-empty`]:{padding:`${f(c)} 0`,color:O,fontSize:t.fontSizeSM,textAlign:"center"},[`${e}-empty-text`]:{padding:z,color:t.colorTextDisabled,fontSize:t.fontSize,textAlign:"center"},[`${e}-item-no-flex`]:{display:"block"}}),[`${e}-grid ${n}-col > ${e}-item`]:{display:"block",maxWidth:"100%",marginBlockEnd:w,paddingBlock:0,borderBlockEnd:"none"},[`${e}-vertical ${e}-item`]:{alignItems:"initial",[`${e}-item-main`]:{display:"block",flex:1},[`${e}-item-extra`]:{marginInlineStart:p},[`${e}-item-meta`]:{marginBlockEnd:G,[`${e}-item-meta-title`]:{marginBlockStart:0,marginBlockEnd:$,color:b,fontSize:t.fontSizeLG,lineHeight:t.lineHeightLG}},[`${e}-item-action`]:{marginBlockStart:c,marginInlineStart:"auto","> li":{padding:`0 ${f(c)}`,"&:first-child":{paddingInlineStart:0}}}},[`${e}-split ${e}-item`]:{borderBlockEnd:`${f(t.lineWidth)} ${t.lineType} ${t.colorSplit}`,"&:last-child":{borderBlockEnd:"none"}},[`${e}-split ${e}-header`]:{borderBlockEnd:`${f(t.lineWidth)} ${t.lineType} ${t.colorSplit}`},[`${e}-split${e}-empty ${e}-footer`]:{borderTop:`${f(t.lineWidth)} ${t.lineType} ${t.colorSplit}`},[`${e}-loading ${e}-spin-nested-loading`]:{minHeight:r},[`${e}-split${e}-something-after-last-item ${n}-spin-container > ${e}-items > ${e}-item:last-child`]:{borderBlockEnd:`${f(t.lineWidth)} ${t.lineType} ${t.colorSplit}`},[`${e}-lg ${e}-item`]:{padding:h},[`${e}-sm ${e}-item`]:{padding:m},[`${e}:not(${e}-vertical)`]:{[`${e}-item-no-flex`]:{[`${e}-item-action`]:{float:"right"}}}}},Vt=t=>({contentWidth:220,itemPadding:`${f(t.paddingContentVertical)} 0`,itemPaddingSM:`${f(t.paddingContentVerticalSM)} ${f(t.paddingContentHorizontal)}`,itemPaddingLG:`${f(t.paddingContentVerticalLG)} ${f(t.paddingContentHorizontalLG)}`,headerBg:"transparent",footerBg:"transparent",emptyTextPadding:t.padding,metaMarginBottom:t.padding,avatarMarginRight:t.padding,titleMarginBottom:t.paddingSM,descriptionFontSize:t.fontSize}),Ht=lt("List",t=>{const e=ct(t,{listBorderedCls:`${t.componentCls}-bordered`,minHeight:t.controlHeightLG});return[At(e),qt(e),Dt(e)]},Vt);var Gt=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(t);a<r.length;a++)e.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(t,r[a])&&(n[r[a]]=t[r[a]]);return n};function Wt(t,e){const{pagination:n=!1,prefixCls:r,bordered:a=!1,split:o=!0,className:p,rootClassName:c,style:l,children:x,itemLayout:m,loadMore:h,grid:d,dataSource:w=[],size:b,header:O,footer:N,loading:H=!1,rowKey:L,renderItem:P,locale:z}=t,G=Gt(t,["pagination","prefixCls","bordered","split","className","rootClassName","style","children","itemLayout","loadMore","grid","dataSource","size","header","footer","loading","rowKey","renderItem","locale"]),F=n&&typeof n=="object"?n:{},[$,y]=s.useState(F.defaultCurrent||1),[E,He]=s.useState(F.defaultPageSize||10),{getPrefixCls:Ge,direction:We,className:Ue,style:Qe}=mt("list"),{renderEmpty:oe}=s.useContext(fe),Je={current:1,total:0,position:"bottom"},$e=g=>(C,_)=>{var me;y(C),He(_),n&&((me=n?.[g])===null||me===void 0||me.call(n,C,_))},Xe=$e("onChange"),Ze=$e("onShowSizeChange"),Ke=(g,C)=>{if(!P)return null;let _;return typeof L=="function"?_=L(g):L?_=g[L]:_=g.key,_||(_=`list-item-${C}`),s.createElement(s.Fragment,{key:_},P(g,C))},Ye=!!(h||n||N),v=Ge("list",r),[ke,et,tt]=Ht(v);let R=H;typeof R=="boolean"&&(R={spinning:R});const le=!!R?.spinning,nt=jt(b);let X="";switch(nt){case"large":X="lg";break;case"small":X="sm";break}const rt=M(v,{[`${v}-vertical`]:m==="vertical",[`${v}-${X}`]:X,[`${v}-split`]:o,[`${v}-bordered`]:a,[`${v}-loading`]:le,[`${v}-grid`]:!!d,[`${v}-something-after-last-item`]:Ye,[`${v}-rtl`]:We==="rtl"},Ue,p,c,et,tt),j=Ot(Je,{total:w.length,current:$,pageSize:E},n||{}),it=Math.ceil(j.total/j.pageSize);j.current=Math.min(j.current,it);const we=n&&s.createElement("div",{className:M(`${v}-pagination`)},s.createElement(Et,Object.assign({align:"end"},j,{onChange:Xe,onShowSizeChange:Ze})));let ce=Pe(w);n&&w.length>(j.current-1)*j.pageSize&&(ce=Pe(w).splice((j.current-1)*j.pageSize,j.pageSize));const at=Object.keys(d||{}).some(g=>["xs","sm","md","lg","xl","xxl"].includes(g)),Ce=$t(at),Z=s.useMemo(()=>{for(let g=0;g<je.length;g+=1){const C=je[g];if(Ce[C])return C}},[Ce]),st=s.useMemo(()=>{if(!d)return;const g=Z&&d[Z]?d[Z]:d.column;if(g)return{width:`${100/g}%`,maxWidth:`${100/g}%`}},[JSON.stringify(d),Z]);let de=le&&s.createElement("div",{style:{minHeight:53}});if(ce.length>0){const g=ce.map(Ke);de=d?s.createElement(gt,{gutter:d.gutter},s.Children.map(g,C=>s.createElement("div",{key:C?.key,style:st},C))):s.createElement("ul",{className:`${v}-items`},g)}else!x&&!le&&(de=s.createElement("div",{className:`${v}-empty-text`},z?.emptyText||oe?.("List")||s.createElement(_t,{componentName:"List"})));const K=j.position,ot=s.useMemo(()=>({grid:d,itemLayout:m}),[JSON.stringify(d),m]);return ke(s.createElement(be.Provider,{value:ot},s.createElement("div",Object.assign({ref:e,style:Object.assign(Object.assign({},Qe),l),className:rt},G),(K==="top"||K==="both")&&we,O&&s.createElement("div",{className:`${v}-header`},O),s.createElement(Be,Object.assign({},R),de,x),N&&s.createElement("div",{className:`${v}-footer`},N),h||(K==="bottom"||K==="both")&&we)))}const Ut=s.forwardRef(Wt),k=Ut;k.Item=qe;var Qt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 464h-68V240c0-70.7-57.3-128-128-128H388c-70.7 0-128 57.3-128 128v224h-68c-17.7 0-32 14.3-32 32v384c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V496c0-17.7-14.3-32-32-32zM332 240c0-30.9 25.1-56 56-56h248c30.9 0 56 25.1 56 56v224H332V240zm460 600H232V536h560v304zM484 701v53c0 4.4 3.6 8 8 8h40c4.4 0 8-3.6 8-8v-53a48.01 48.01 0 10-56 0z"}}]},name:"lock",theme:"outlined"},Jt=function(e,n){return s.createElement(Le,ze({},e,{ref:n,icon:Qt}))},pe=s.forwardRef(Jt),Xt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M928 160H96c-17.7 0-32 14.3-32 32v640c0 17.7 14.3 32 32 32h832c17.7 0 32-14.3 32-32V192c0-17.7-14.3-32-32-32zm-40 110.8V792H136V270.8l-27.6-21.5 39.3-50.5 42.8 33.3h643.1l42.8-33.3 39.3 50.5-27.7 21.5zM833.6 232L512 482 190.4 232l-42.8-33.3-39.3 50.5 27.6 21.5 341.6 265.6a55.99 55.99 0 0068.7 0L888 270.8l27.6-21.5-39.3-50.5-42.7 33.2z"}}]},name:"mail",theme:"outlined"},Zt=function(e,n){return s.createElement(Le,ze({},e,{ref:n,icon:Xt}))},Kt=s.forwardRef(Zt);const V=Te;class Yt{constructor(){Q(this)}dispose(){console.log("dispose")}init(){console.log("init")}}var kt=Object.defineProperty,en=(t,e,n)=>e in t?kt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,W=(t,e,n)=>en(t,typeof e!="symbol"?e+"":e,n);class tn{constructor(e){this.appConfig=e,W(this,"mutation"),W(this,"currentPassword",new T("",{validators:[A(()=>this.t.forms("required")),ue(),Y(6,()=>this.t.forms("minLength",{count:6}))]})),W(this,"newPassword",new T("",{validators:[A(()=>this.t.forms("required")),ue(),Y(6,()=>this.t.forms("minLength",{count:6}))]})),W(this,"repassword",new T("",{validators:[A(()=>this.t.forms("required")),ue(),Y(6,()=>this.t.forms("minLength",{count:6})),n=>this.newPassword.value!==n.value?[{message:this.t.forms("passwordsDoNotMatch"),type:ft.Error}]:[]]})),W(this,"group",new xe({currentPassword:this.currentPassword,newPassword:this.newPassword,repassword:this.repassword})),Q(this,{handleSubmit:he.bound}),this.mutation=new ee(this.appConfig.queryClient,{mutationFn:n=>Me.postAuthChangePassword({changePasswordDto:n}),onError:n=>{te(n).then(r=>{this.appConfig.notify.error({message:r.message||this.t.errors("unknown")})})},onSuccess:n=>{this.appConfig.notify.success({message:this.t.messages("success")}),this.appConfig.auth.account.updateFromJson(n),this.group.reset()}})}get t(){return this.appConfig.locale.translations}handleSubmit(){if(this.group.isInvalid){this.group.setTouched(!0),this.group.setDirty(!0),this.group.firstErrorControl?.element?.focus();return}const{repassword:e,...n}=this.group.value;this.mutation.mutate(n)}}const nn=J(function(){const{t:e}=bt("profile"),n=ae(),r=se(()=>new tn(n),[n]);return i.jsxs(ve,{title:e("password.title"),children:[i.jsxs(ye,{children:[i.jsxs(V,{span:24,md:8,children:[i.jsx("h5",{className:"mb-25 font-semibold",children:e("password.requirementsTitle")}),i.jsx("p",{className:"para",children:e("password.requirementsGuide")}),i.jsx("ul",{className:"pl-25 text-muted",children:e("password.requirementsList",{returnObjects:!0,defaultValue:[]}).map((a,o)=>i.jsx("li",{children:a},o))})]}),i.jsx(V,{span:24,md:16,flex:"auto",children:i.jsxs(S,{layout:"vertical",onFinish:r.handleSubmit,children:[i.jsx(S.Item,{name:"currentPassword",label:e("password.old"),...r.currentPassword.itemProps,children:i.jsx(B.Password,{prefix:i.jsx(pe,{}),placeholder:"********",...r.currentPassword.inputProps})}),i.jsx(S.Item,{name:"newPassword",label:e("password.new"),...r.newPassword.itemProps,children:i.jsx(B.Password,{prefix:i.jsx(pe,{}),placeholder:"********",...r.newPassword.inputProps})}),i.jsx(S.Item,{name:"confirmPassword",label:e("password.confirm"),...r.repassword.itemProps,children:i.jsx(B.Password,{prefix:i.jsx(pe,{}),placeholder:"********",...r.repassword.inputProps})})]})})]}),i.jsxs(ne,{gap:"small",children:[i.jsx(I,{type:"primary",loading:r.mutation.isPending,htmlType:"submit",disabled:!r.group.isChanged,children:e("password.save")}),i.jsx(I,{type:"default",onClick:r.group.reset,disabled:!r.group.isChanged||r.mutation.isPending,children:e("buttons.reset",{ns:"common"})})]})]})});var De={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},Oe=u.createContext&&u.createContext(De),rn=["attr","size","title"];function an(t,e){if(t==null)return{};var n=sn(t,e),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(a=0;a<o.length;a++)r=o[a],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function sn(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function re(){return re=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},re.apply(this,arguments)}function Ee(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,r)}return n}function ie(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Ee(Object(n),!0).forEach(function(r){on(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ee(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function on(t,e,n){return e=ln(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ln(t){var e=cn(t,"string");return typeof e=="symbol"?e:e+""}function cn(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ae(t){return t&&t.map((e,n)=>u.createElement(e.tag,ie({key:n},e.attr),Ae(e.child)))}function dn(t){return e=>u.createElement(mn,re({attr:ie({},t.attr)},e),Ae(t.child))}function mn(t){var e=n=>{var{attr:r,size:a,title:o}=t,p=an(t,rn),c=a||n.size||"1em",l;return n.className&&(l=n.className),t.className&&(l=(l?l+" ":"")+t.className),u.createElement("svg",re({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,r,p,{className:l,style:ie(ie({color:t.color||n.color},n.style),t.style),height:c,width:c,xmlns:"http://www.w3.org/2000/svg"}),o&&u.createElement("title",null,o),t.children)};return Oe!==void 0?u.createElement(Oe.Consumer,null,n=>e(n)):e(De)}function un(t){return dn({attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M228.88,26.19a9,9,0,0,0-9.16-1.57L17.06,103.93a14.22,14.22,0,0,0,2.43,27.21L72,141.45V200a15.92,15.92,0,0,0,10,14.83,15.91,15.91,0,0,0,17.51-3.73l25.32-26.26L165,220a15.88,15.88,0,0,0,10.51,4,16.3,16.3,0,0,0,5-.79,15.85,15.85,0,0,0,10.67-11.63L231.77,35A9,9,0,0,0,228.88,26.19Zm-61.14,36L78.15,126.35l-49.6-9.73ZM88,200V152.52l24.79,21.74Zm87.53,8L92.85,135.5l119-85.29Z"},child:[]}]})(t)}var pn=Object.defineProperty,gn=(t,e,n)=>e in t?pn(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,q=(t,e,n)=>gn(t,typeof e!="symbol"?e+"":e,n);class hn{constructor(e){this.appContext=e,q(this,"mutation"),q(this,"requiredValidator",A(()=>this.t.forms("required"))),q(this,"avatar",new yt(null)),q(this,"email",new T(()=>this.profile.email,{validators:[this.requiredValidator,xt(()=>this.t.forms("invalidEmail"))]})),q(this,"telegram",new T(()=>this.profile.telegram,{validators:[Y(6,()=>this.t.forms("invalidTelegram"))],onChangeValue:n=>{n.startsWith("@")||this.telegram.setValue(`@${n}`)}})),q(this,"name",new T(()=>this.profile.name,{validators:[A(()=>this.t.forms("required"))]})),q(this,"group",new xe({email:this.email,telegram:this.telegram,name:this.name})),this.mutation=new ee(this.appContext.queryClient,{mutationFn:n=>Me.patchProfile({userUpdate:n}),onError:n=>{te(n).then(r=>{this.appContext.notify.error({message:r.message||this.t.errors("unknown")})})},onSuccess:n=>{this.appContext.notify.success({message:this.t.messages("success")}),this.appContext.auth.account.updateFromJson(n),this.group.reset()}}),Q(this,{handleSubmit:he.bound,handleReset:he.bound},{autoBind:!0})}get t(){return this.appContext.locale.translations}get profile(){return this.appContext.auth.account}handleReset(){this.group.reset()}handleSubmit(){if(this.group.isInvalid){this.group.setTouched(!0),this.group.setDirty(!0),this.group.firstErrorControl?.element?.focus();return}const{...e}=this.group.value;this.mutation.mutate(e)}}const fn="_wrapper_uquov_1",yn="_upload_uquov_1",_e={wrapper:fn,upload:yn},xn=t=>new Promise((e,n)=>{const r=new FileReader;r.readAsDataURL(t),r.onload=()=>e(r.result),r.onerror=a=>n(a)}),vn=J(function({model:e}){const n=ae(),r=e.profile,[a,o]=s.useState(!1),[p,c]=s.useState(r.avatarUrl);s.useEffect(()=>ut(()=>r.avatarUrl,m=>{e.avatar.isChanged||c(m)}),[e,r]);const l=m=>{console.log("info",m),e.avatar.setValue(m.file.originFileObj||null)},x=async m=>{o(!0);const h=m.type==="image/jpeg"||m.type==="image/png";h||n.message.error("You can only upload JPG/PNG file!");const d=m.size/1024/1024<2;if(d||n.message.error("Image must smaller than 2MB!"),h&&d){const w=await xn(m);return o(!1),c(w),!1}return!1};return i.jsx(S.Item,{className:_e.wrapper,children:i.jsx(Nt,{name:"avatar",listType:"picture-card",showUploadList:!1,beforeUpload:x,onChange:l,fileList:[],className:_e.upload,children:p?i.jsx("img",{src:p,alt:"avatar",style:{width:"100%"}}):i.jsxs("button",{style:{border:0,background:"none"},type:"button",children:[a?i.jsx(pt,{}):i.jsx(wt,{}),i.jsx("div",{style:{marginTop:8},children:"Upload"})]})})})}),bn=J(function(){const{t:e}=Fe("profile"),n=ae(),r=se(()=>new hn(n),[n]);return i.jsxs(ve,{title:e("edit.title"),children:[i.jsxs(ye,{children:[i.jsx(V,{span:24,md:8,children:i.jsx(vn,{model:r})}),i.jsx(V,{span:24,md:16,flex:"auto",children:i.jsxs(S,{layout:"vertical",onFinish:r.handleSubmit,children:[i.jsx(S.Item,{label:e("edit.name"),...r.name.itemProps,children:i.jsx(B,{prefix:i.jsx(zt,{}),...r.name.inputProps})}),i.jsx(S.Item,{label:e("edit.email"),...r.email.itemProps,children:i.jsx(B,{prefix:i.jsx(Kt,{}),...r.email.inputProps})}),i.jsx(S.Item,{label:e("edit.telegram"),...r.telegram.itemProps,children:i.jsx(B,{prefix:i.jsx(un,{}),...r.telegram.inputProps})})]})})]}),i.jsxs(ne,{gap:"small",children:[i.jsx(I,{type:"primary",loading:r.mutation.isPending,htmlType:"submit",disabled:!r.group.isChanged,children:e("edit.save")}),i.jsx(I,{type:"default",onClick:r.handleReset,disabled:!r.group.isChanged||r.mutation.isPending,children:e("buttons.reset",{ns:"common"})})]})]})});var $n=Object.defineProperty,wn=(t,e,n)=>e in t?$n(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ge=(t,e,n)=>wn(t,typeof e!="symbol"?e+"":e,n);class Cn{constructor(e){this.id=e,ge(this,"name",""),ge(this,"address",""),ge(this,"createdAt",new Date().toISOString()),Q(this)}updateFromJson(e){return this.partialUpdateFromJson(e),this}partialUpdateFromJson(e){return Object.assign(this,e),this}}var Pn=Object.defineProperty,Sn=(t,e,n)=>e in t?Pn(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,D=(t,e,n)=>Sn(t,typeof e!="symbol"?e+"":e,n);class jn{constructor(e){this.appConfig=e,D(this,"addMutation"),D(this,"deleteMutation"),D(this,"paymentSystemsQuery"),D(this,"name",new T("",{validators:[A(()=>this.t.forms("required"))]})),D(this,"address",new T("",{validators:[A(()=>this.t.forms("required")),vt(/^(?:T[1-9A-HJ-NP-Za-km-z]{33}|0x[a-fA-F0-9]{40}|41[a-fA-F0-9]{40})$/,()=>this.t.forms("invalid"))]})),D(this,"group",new xe({name:this.name,address:this.address})),D(this,"modalToggler",new Mt(!1,n=>{n&&(this.group.reset(),this.addMutation.reset())})),Q(this,{},{autoBind:!0}),this.paymentSystemsQuery=new It(e.queryClient,{queryKey:["paymentSystems"],queryFn:async()=>(await new Promise(n=>setTimeout(n,1e3)),[{id:Se(),name:"USDT TRC20",address:"TAJBeXjwTQPnC3LTNgAQnBeUQ1qm65Dk1z",createdAt:new Date(Date.now()-2131324).toISOString()}]),transform:(n=[])=>n.map(r=>{const a=new Cn(r.id);return a.updateFromJson(r),a}),initialDataUpdatedAt:0,staleTime:0}),this.addMutation=new ee(this.appConfig.queryClient,{mutationFn:async()=>{await new Promise(n=>setTimeout(n,1e3))},onError:n=>{te(n).then(r=>{this.appConfig.notify.error({message:r.message||this.t.errors("unknown")})})},onSuccess:()=>{this.appConfig.notify.success({message:this.t.messages("success")}),this.addMutation.reset(),this.modalToggler.disable(),this.paymentSystemsQuery.setQueryData(n=>n.concat({id:Se(),address:this.address.value,name:this.name.value,createdAt:new Date().toISOString()}))}}),this.deleteMutation=new ee(this.appConfig.queryClient,{mutationFn:async n=>(await new Promise(r=>setTimeout(r,1e3)),n),onError:n=>{te(n).then(r=>{this.appConfig.notify.error({message:r.message||this.t.errors("unknown")})})},onSuccess:n=>{this.appConfig.notify.success({message:this.t.messages("success")}),this.deleteMutation.reset(),this.paymentSystemsQuery.setQueryData(r=>r.filter(a=>a.id!==n))}})}get t(){return this.appConfig.locale.translations}refresh(){this.paymentSystemsQuery.refetch()}handleAfterOpenChange(e){e||this.group.reset()}handleSubmit(){if(this.group.isInvalid){this.group.setTouched(!0),this.group.setDirty(!0),this.group.firstErrorControl?.element?.focus();return}this.addMutation.mutate()}}const On="_wrapper_1tfnc_1",En="_mask_1tfnc_15",Ie={wrapper:On,mask:En},Ve=s.memo(function({className:e,dynamic:n,children:r}){const a=s.useRef(null),[o,p]=s.useState();return s.useLayoutEffect(()=>{if(n){let c=function(){if(a.current){const x=document.documentElement.clientHeight,m=a.current.parentElement;if(m){const h=m.getBoundingClientRect();let d,w;h.height>x&&(h.top>0?d=x-h.top:(w=-h.top,h.bottom>x?d=x:d=h.bottom),p({top:w,height:d}))}}};c();const l=a.current?.parentElement;return l?.addEventListener("scroll",c),l?.parentElement?.addEventListener("scroll",c),window.addEventListener("resize",c),window.addEventListener("scroll",c),()=>{window.removeEventListener("resize",c),window.removeEventListener("scroll",c),l?.removeEventListener("scroll",c),l?.parentElement?.removeEventListener("scroll",c)}}},[n]),i.jsxs("div",{ref:a,className:M(Ie.wrapper,e),style:o,children:[i.jsx("div",{className:Ie.mask}),r]})});Ve.displayName="ForwardRef shared/ui/(Overlay)";const _n=u.memo(function({dynamic:e,...n}){return i.jsx(Ve,{dynamic:e,children:i.jsx(Be,{size:"large",...n})})}),In="_container_1xzq3_1",Nn="_center_1xzq3_8",Ln="_icon_1xzq3_17",zn="_body_1xzq3_21",U={container:In,center:Nn,icon:Ln,body:zn},Mn={body:U.body},Tn=J(function(){const{t:e}=Fe("profile"),n=ae(),r=se(()=>new jn(n),[n]),a=r.paymentSystemsQuery;return i.jsxs(ve,{className:U.container,classNames:Mn,title:e("payments.title"),extra:i.jsxs(ne,{gap:"small",children:[i.jsx(I,{onClick:r.refresh,loading:a.isFetching,icon:i.jsx(Pt,{})}),i.jsx(I,{onClick:r.modalToggler.enable,children:e("payments.add")})]}),children:[!a.isFetched&&i.jsx(_n,{}),a.isFetched&&a.data.length===0&&i.jsxs("div",{className:U.center,children:[i.jsx(Lt,{className:U.icon}),i.jsx("h5",{className:U.text,children:e("payments.empty")})]}),a.isFetched&&a.data.length!==0&&i.jsx(k,{itemLayout:"horizontal",dataSource:a.data,renderItem:o=>i.jsx(k.Item,{actions:[i.jsx(Ct,{title:"Удалить платежную систему?",placement:"left",okText:e("buttons.delete",{ns:"common"}),onConfirm:()=>r.deleteMutation.mutate(o.id),children:i.jsx(I,{loading:r.deleteMutation.isPending,icon:i.jsx(Bt,{})})})],children:i.jsx(k.Item.Meta,{title:o.name,description:o.address})},o.id)}),i.jsx(Tt,{title:e("payments.modalTitle"),destroyOnHidden:!0,open:r.modalToggler.isEnabled,onCancel:r.modalToggler.disable,maskClosable:!1,afterOpenChange:r.handleAfterOpenChange,footer:i.jsxs(ne,{gap:"small",justify:"flex-end",children:[i.jsx(I,{onClick:r.modalToggler.disable,children:e("buttons.cancel",{ns:"common"})}),i.jsx(I,{type:"primary",loading:r.addMutation.isPending,onClick:r.handleSubmit,disabled:!r.group.isChanged,children:e("buttons.submit",{ns:"common"})})]}),centered:!0,children:i.jsxs(S,{layout:"vertical",onFinish:r.handleSubmit,children:[i.jsx(S.Item,{label:e("payments.name"),...r.name.itemProps,children:i.jsx(B,{placeholder:e("payments.namePlaceholder"),...r.name.inputProps})}),i.jsx(S.Item,{label:e("payments.address"),...r.address.itemProps,children:i.jsx(B,{placeholder:e("payments.addressPlaceholder"),...r.address.inputProps})})]})})]})}),Bn="_group_au2bf_5",Ne={group:Bn},Fn=J(function(){const e=se(()=>new Yt,[]);return console.log("ProfilePage model:",e),i.jsx(ht,{children:i.jsxs(ye,{children:[i.jsxs(V,{span:24,xxl:12,className:Ne.group,children:[i.jsx(bn,{}),i.jsx(nn,{})]}),i.jsx(V,{span:24,xxl:12,className:Ne.group,children:i.jsx(Tn,{})})]})})}),tr=Fn;export{tr as component};
