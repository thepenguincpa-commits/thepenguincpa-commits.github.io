import{e as x,m as be,k as W,w as Z,v as oe,t as D,a0 as O,br as qe,bs as se,bt as Ge,I as Ke,o as h,u as ye,S as ae,P as N,r as I,j as t,s as Pe,a1 as $e,bu as ze}from"./index.WsYO2dy-.js";import{G as X}from"./GridRow.D00ldfkG.js";import"./AppLayout.DyHuBULn.js";import{L as Ze}from"./LayoutContainer.CsWPLRk4.js";import{f as v,h as ke,i as Se,j as xe,c as ce,b as He,a as Je,O as We,d as Xe}from"./OfferPayoutRepository.BVytgQiF.js";import{I as Ye,O as Qe,R as Ce}from"./OfferFormModel.ReAPPU29.js";import{T as z}from"./Toggler.ZA2mSsXC.js";import{a as er,O as rr}from"./OfferDomainRepository.DVHGC7H4.js";import{F as tr,V as G,c as J,a as Y,r as Q,I as ir,f as je,b as a}from"./validators.Dv5Q2cT2.js";import{c as nr,i as or,b as ve,k as sr,a as _e,C as ar}from"./_baseIteratee.D6zu_0O4.js";import{S as q}from"./SelectControl.C52l_hTY.js";import{R as Ie}from"./Registry.HwMJU2b-.js";import{C as ue}from"./CheckboxControl.APbzGKG_.js";import{c as cr,I as ur,L as lr}from"./LanguageName.CTByr_f_.js";import{u as w}from"./useTranslation.Bt2PYRL2.js";import{B as P}from"./Box.BoA2lbt8.js";import{U as we,R as le}from"./LoadingOutlined.3yBP6Z6b.js";import{B as m}from"./button.B3PsbA3S.js";import{R as dr}from"./DeleteOutlined.BjH_ETXM.js";import{R as mr,a as hr}from"./PlusOutlined.O__MOyud.js";import{C as ee}from"./Input.CS61qdQu.js";import{C as F}from"./row.C2dg1pTq.js";import{I as _}from"./index.BtpR5D5L.js";import{S as p}from"./index.DGsLj2m-.js";import{C as k}from"./index.DLZ010Vy.js";import{r as y}from"./renderReactiveCell.wysBt9wO.js";import{C as Fe}from"./CountryName.CtqEwQTt.js";import{M as De}from"./index.BeMCciVP.js";import{T as R}from"./index.D7q-MwFy.js";import{T as Me}from"./AntdIcon.vojNxC2w.js";import{F as Te}from"./Table.Dku94qg-.js";import{C as de}from"./Currency.BGk8zIyl.js";import{F as gr}from"./FlagIcon.Canhu2ph.js";import{D as fr}from"./index.DgS7zglb.js";import"./index.BAyObCzF.js";import"./usersApi.B6WEsVtH.js";import"./EyeOutlined.ugoREuIH.js";import"./index.C9s0pYnk.js";import"./ActionButton.DSiJnkeb.js";import"./useClosable.D4JC76of.js";var pr=Object.defineProperty,br=(i,e,r)=>e in i?pr(i,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[e]=r,K=(i,e,r)=>br(i,typeof e!="symbol"?e+"":e,r);function yr(i){return i.isTouched&&i.isDirty&&i.errorMessage?{help:i.errorMessage,validateStatus:"error"}:{}}class Pr extends tr{constructor(e,{ref:r,onChange:n,onBlur:o,onFocus:s,validators:u,props:c,...g}={}){super(e,{validators:u?.map(l=>()=>l(this)),...g}),K(this,"actions"),K(this,"props"),K(this,"error",null),K(this,"preview",null),this.props=x(()=>c?.()),this.actions={ref:l=>{this.element=l?.nativeElement||null,r&&r(l)},onChange:l=>{const f=l.fileList[0].originFileObj||null;this.setValue(f),n&&n(f)},onBlur:l=>{this.setTouched(!0),this.setFocused(!1),o&&o(l)},onFocus:l=>{this.setFocused(!0),s&&s(l)}},be(this,{itemProps:x,setPreview:W.bound})}get itemProps(){return yr(this)}setError(e){this.error=e}setPreview(e){this.preview=e}get inputProps(){return{...this.props.get(),...this.actions,value:this.value,preview:this.preview}}}var Sr=Object.defineProperty,xr=(i,e,r)=>e in i?Sr(i,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[e]=r,j=(i,e,r)=>xr(i,typeof e!="symbol"?e+"":e,r);class Re{constructor(e,r){this.appContext=e,this.initialValueGetter=r,j(this,"t"),j(this,"languages"),j(this,"group"),j(this,"requiredValidator",Q(()=>this.t.forms("required"))),j(this,"image",new Ye(()=>null,{initialPreviewGetter:()=>this.initialValue.image,onChange:n=>{console.log({value:n})},validators:[n=>n.value===null&&!this.initialValue.image?[{type:G.Error,message:this.t.forms("required")}]:[],n=>{const o=n.value;return o===null?[]:o.size/1024/1024<5?o.type==="image/jpeg"||o.type==="image/png"?[]:[{type:G.Error,message:"Поддерживаются только JPG/PNG файлы!"}]:[{type:G.Error,message:"Изображение не должно превышать 5 МБ!"}]}]})),j(this,"source",new Pr(()=>null,{validators:[n=>n.value===null&&!this.initialValue.domain?[{type:G.Error,message:this.t.forms("required")}]:[]],props:()=>({accept:".zip"})})),j(this,"title",new J(()=>this.initialValue.title,{validators:[this.requiredValidator]})),j(this,"status",new q(()=>this.initialValue.status,{validators:[this.requiredValidator],options:()=>[{value:Z.Active,label:this.t.offer("status.active")},{value:Z.Paused,label:this.t.offer("status.paused")},{value:Z.Archived,label:this.t.offer("status.archived")}]})),j(this,"type",new q(()=>this.initialValue.type,{validators:[this.requiredValidator],options:()=>[{value:oe.Landing,label:this.t.offer("domainType.landing")},{value:oe.Transit,label:this.t.offer("domainType.transit")}]})),this.t=e.locale.translations,this.languages=new nr(e,()=>this.initialValue.languages,{validators:[this.requiredValidator]}),this.group=new Y({title:this.title,type:this.type,languages:this.languages,status:this.status,image:this.image,source:this.source}),D(this)}get initialValue(){return this.initialValueGetter()||new er("")}}var Cr=Object.defineProperty,jr=(i,e,r)=>e in i?Cr(i,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[e]=r,me=(i,e,r)=>jr(i,typeof e!="symbol"?e+"":e,r);class vr{constructor(e,r,n){this.offerStore=r,this.domain=n,me(this,"form"),me(this,"mutation"),this.form=new Re(e,()=>n),this.mutation=new O(e.queryClient,{mutationFn:()=>{const{image:o,source:s,...u}=this.form.group.value;return v.patchOffersIdDomainsDomainId({offerId:n.offerId,domainId:n.id,image:o||void 0,source:s||void 0,...u})},onError:o=>{e.notify.toastError(o)}}),D(this,{handleSubmit:W.bound},{autoBind:!0})}get id(){return this.domain.id}get locations(){return this.offerStore.locations.filter(e=>this.domain.languages.includes(e.country))}handleSubmit(){if(this.form.group.isInvalid){this.form.group.setTouched(!0),this.form.group.setDirty(!0),this.form.group.firstErrorControl?.element?.focus?.();return}this.mutation.mutate()}}var _r=Object.defineProperty,Ir=(i,e,r)=>e in i?_r(i,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[e]=r,B=(i,e,r)=>Ir(i,typeof e!="symbol"?e+"":e,r);class wr{constructor(e,r){this.appContext=e,this.offerStore=r,B(this,"mutation"),B(this,"form"),B(this,"registry",new Ie(n=>new vr(this.appContext,this.offerStore,n))),B(this,"createModalToggler",new z(!1)),B(this,"selected",""),this.form=new Re(e,()=>null),this.mutation=new O(e.queryClient,{mutationFn:n=>v.postOffersIdDomains(n),onError(n){e.notify.toastError(n)}}),D(this,{},{autoBind:!0})}get selectedModel(){return this.domains.find(e=>e.id===this.selected)}get offer(){return this.offerStore.offer}get domains(){return this.registry.from(this.offerStore.domains)}get landings(){return this.domains.filter(e=>e.domain.type==="landing")}get transits(){return this.domains.filter(e=>e.domain.type==="transit")}get modalForm(){return this.selectedModel?.form||this.form}setSelected(e){this.selected=e,e?this.createModalToggler.enable():this.createModalToggler.disable()}handleOpenForm(e){this.form.initialValue.type=e,this.form.group.reset(),this.createModalToggler.enable()}handleAfterOpenChange(e){e||(this.selected="",this.form.group.reset())}handleSubmit(){if(this.form.group.isInvalid){this.form.group.setTouched(!0),this.form.group.setDirty(!0),this.form.group.firstErrorControl?.element?.focus?.();return}const{image:e,source:r,...n}=this.form.group.value;e&&r&&this.mutation.mutate({...n,offerId:this.offer.id,image:e,source:r})}}var Fr=/\s/;function Dr(i){for(var e=i.length;e--&&Fr.test(i.charAt(e)););return e}var Mr=/^\s+/;function Tr(i){return i&&i.slice(0,Dr(i)+1).replace(Mr,"")}var he=NaN,Rr=/^[-+]0x[0-9a-f]+$/i,Nr=/^0b[01]+$/i,Lr=/^0o[0-7]+$/i,Or=parseInt;function Ar(i){if(typeof i=="number")return i;if(qe(i))return he;if(se(i)){var e=typeof i.valueOf=="function"?i.valueOf():i;i=se(e)?e+"":e}if(typeof i!="string")return i===0?i:+i;i=Tr(i);var r=Nr.test(i);return r||Lr.test(i)?Or(i.slice(2),r?2:8):Rr.test(i)?he:+i}var ge=1/0,Br=17976931348623157e292;function Er(i){if(!i)return i===0?i:0;if(i=Ar(i),i===ge||i===-ge){var e=i<0?-1:1;return e*Br}return i===i?i:0}function Vr(i){var e=Er(i),r=e%1;return e===e?r?e-r:e:0}function Ur(i){return function(e,r,n){var o=Object(e);if(!or(e)){var s=ve(r);e=sr(e),r=function(c){return s(o[c],c,o)}}var u=i(e,r,n);return u>-1?o[s?e[u]:u]:void 0}}var qr=Math.max;function Gr(i,e,r){var n=i==null?0:i.length;if(!n)return-1;var o=r==null?0:Vr(r);return o<0&&(o=qr(n+o,0)),Ge(i,ve(e),o)}var Kr=Ur(Gr);const Ne=[{code:"AED",number:"784",digits:2,currency:"UAE Dirham",countries:["United Arab Emirates (The)"]},{code:"AFN",number:"971",digits:2,currency:"Afghani",countries:["Afghanistan"]},{code:"ALL",number:"008",digits:2,currency:"Lek",countries:["Albania"]},{code:"AMD",number:"051",digits:2,currency:"Armenian Dram",countries:["Armenia"]},{code:"ANG",number:"532",digits:2,currency:"Netherlands Antillean Guilder",countries:["Curaçao","Sint Maarten (Dutch Part)"]},{code:"AOA",number:"973",digits:2,currency:"Kwanza",countries:["Angola"]},{code:"ARS",number:"032",digits:2,currency:"Argentine Peso",countries:["Argentina"]},{code:"AUD",number:"036",digits:2,currency:"Australian Dollar",countries:["Australia","Christmas Island","Cocos (Keeling) Islands (The)","Heard Island and Mcdonald Islands","Kiribati","Nauru","Norfolk Island","Tuvalu"]},{code:"AWG",number:"533",digits:2,currency:"Aruban Florin",countries:["Aruba"]},{code:"AZN",number:"944",digits:2,currency:"Azerbaijan Manat",countries:["Azerbaijan"]},{code:"BAM",number:"977",digits:2,currency:"Convertible Mark",countries:["Bosnia and Herzegovina"]},{code:"BBD",number:"052",digits:2,currency:"Barbados Dollar",countries:["Barbados"]},{code:"BDT",number:"050",digits:2,currency:"Taka",countries:["Bangladesh"]},{code:"BGN",number:"975",digits:2,currency:"Bulgarian Lev",countries:["Bulgaria"]},{code:"BHD",number:"048",digits:3,currency:"Bahraini Dinar",countries:["Bahrain"]},{code:"BIF",number:"108",digits:0,currency:"Burundi Franc",countries:["Burundi"]},{code:"BMD",number:"060",digits:2,currency:"Bermudian Dollar",countries:["Bermuda"]},{code:"BND",number:"096",digits:2,currency:"Brunei Dollar",countries:["Brunei Darussalam"]},{code:"BOB",number:"068",digits:2,currency:"Boliviano",countries:["Bolivia (Plurinational State Of)"]},{code:"BOV",number:"984",digits:2,currency:"Mvdol",countries:["Bolivia (Plurinational State Of)"]},{code:"BRL",number:"986",digits:2,currency:"Brazilian Real",countries:["Brazil"]},{code:"BSD",number:"044",digits:2,currency:"Bahamian Dollar",countries:["Bahamas (The)"]},{code:"BTN",number:"064",digits:2,currency:"Ngultrum",countries:["Bhutan"]},{code:"BWP",number:"072",digits:2,currency:"Pula",countries:["Botswana"]},{code:"BYN",number:"933",digits:2,currency:"Belarusian Ruble",countries:["Belarus"]},{code:"BZD",number:"084",digits:2,currency:"Belize Dollar",countries:["Belize"]},{code:"CAD",number:"124",digits:2,currency:"Canadian Dollar",countries:["Canada"]},{code:"CDF",number:"976",digits:2,currency:"Congolese Franc",countries:["Congo (The Democratic Republic of The)"]},{code:"CHE",number:"947",digits:2,currency:"WIR Euro",countries:["Switzerland"]},{code:"CHF",number:"756",digits:2,currency:"Swiss Franc",countries:["Liechtenstein","Switzerland"]},{code:"CHW",number:"948",digits:2,currency:"WIR Franc",countries:["Switzerland"]},{code:"CLF",number:"990",digits:4,currency:"Unidad de Fomento",countries:["Chile"]},{code:"CLP",number:"152",digits:0,currency:"Chilean Peso",countries:["Chile"]},{code:"CNY",number:"156",digits:2,currency:"Yuan Renminbi",countries:["China"]},{code:"COP",number:"170",digits:2,currency:"Colombian Peso",countries:["Colombia"]},{code:"COU",number:"970",digits:2,currency:"Unidad de Valor Real",countries:["Colombia"]},{code:"CRC",number:"188",digits:2,currency:"Costa Rican Colon",countries:["Costa Rica"]},{code:"CUC",number:"931",digits:2,currency:"Peso Convertible",countries:["Cuba"]},{code:"CUP",number:"192",digits:2,currency:"Cuban Peso",countries:["Cuba"]},{code:"CVE",number:"132",digits:2,currency:"Cabo Verde Escudo",countries:["Cabo Verde"]},{code:"CZK",number:"203",digits:2,currency:"Czech Koruna",countries:["Czechia"]},{code:"DJF",number:"262",digits:0,currency:"Djibouti Franc",countries:["Djibouti"]},{code:"DKK",number:"208",digits:2,currency:"Danish Krone",countries:["Denmark","Faroe Islands (The)","Greenland"]},{code:"DOP",number:"214",digits:2,currency:"Dominican Peso",countries:["Dominican Republic (The)"]},{code:"DZD",number:"012",digits:2,currency:"Algerian Dinar",countries:["Algeria"]},{code:"EGP",number:"818",digits:2,currency:"Egyptian Pound",countries:["Egypt"]},{code:"ERN",number:"232",digits:2,currency:"Nakfa",countries:["Eritrea"]},{code:"ETB",number:"230",digits:2,currency:"Ethiopian Birr",countries:["Ethiopia"]},{code:"EUR",number:"978",digits:2,currency:"Euro",countries:["Åland Islands","Andorra","Austria","Belgium","Croatia","Cyprus","Estonia","European Union","Finland","France","French Guiana","French Southern Territories (The)","Germany","Greece","Guadeloupe","Holy See (The)","Ireland","Italy","Latvia","Lithuania","Luxembourg","Malta","Martinique","Mayotte","Monaco","Montenegro","Netherlands (The)","Portugal","Réunion","Saint Barthélemy","Saint Martin (French Part)","Saint Pierre and Miquelon","San Marino","Slovakia","Slovenia","Spain"]},{code:"FJD",number:"242",digits:2,currency:"Fiji Dollar",countries:["Fiji"]},{code:"FKP",number:"238",digits:2,currency:"Falkland Islands Pound",countries:["Falkland Islands (The) [Malvinas]"]},{code:"GBP",number:"826",digits:2,currency:"Pound Sterling",countries:["Guernsey","Isle of Man","Jersey","United Kingdom of Great Britain and Northern Ireland (The)"]},{code:"GEL",number:"981",digits:2,currency:"Lari",countries:["Georgia"]},{code:"GHS",number:"936",digits:2,currency:"Ghana Cedi",countries:["Ghana"]},{code:"GIP",number:"292",digits:2,currency:"Gibraltar Pound",countries:["Gibraltar"]},{code:"GMD",number:"270",digits:2,currency:"Dalasi",countries:["Gambia (The)"]},{code:"GNF",number:"324",digits:0,currency:"Guinean Franc",countries:["Guinea"]},{code:"GTQ",number:"320",digits:2,currency:"Quetzal",countries:["Guatemala"]},{code:"GYD",number:"328",digits:2,currency:"Guyana Dollar",countries:["Guyana"]},{code:"HKD",number:"344",digits:2,currency:"Hong Kong Dollar",countries:["Hong Kong"]},{code:"HNL",number:"340",digits:2,currency:"Lempira",countries:["Honduras"]},{code:"HTG",number:"332",digits:2,currency:"Gourde",countries:["Haiti"]},{code:"HUF",number:"348",digits:2,currency:"Forint",countries:["Hungary"]},{code:"IDR",number:"360",digits:2,currency:"Rupiah",countries:["Indonesia"]},{code:"ILS",number:"376",digits:2,currency:"New Israeli Sheqel",countries:["Israel"]},{code:"INR",number:"356",digits:2,currency:"Indian Rupee",countries:["Bhutan","India"]},{code:"IQD",number:"368",digits:3,currency:"Iraqi Dinar",countries:["Iraq"]},{code:"IRR",number:"364",digits:2,currency:"Iranian Rial",countries:["Iran (Islamic Republic Of)"]},{code:"ISK",number:"352",digits:0,currency:"Iceland Krona",countries:["Iceland"]},{code:"JMD",number:"388",digits:2,currency:"Jamaican Dollar",countries:["Jamaica"]},{code:"JOD",number:"400",digits:3,currency:"Jordanian Dinar",countries:["Jordan"]},{code:"JPY",number:"392",digits:0,currency:"Yen",countries:["Japan"]},{code:"KES",number:"404",digits:2,currency:"Kenyan Shilling",countries:["Kenya"]},{code:"KGS",number:"417",digits:2,currency:"Som",countries:["Kyrgyzstan"]},{code:"KHR",number:"116",digits:2,currency:"Riel",countries:["Cambodia"]},{code:"KMF",number:"174",digits:0,currency:"Comorian Franc ",countries:["Comoros (The)"]},{code:"KPW",number:"408",digits:2,currency:"North Korean Won",countries:["Korea (The Democratic People’s Republic Of)"]},{code:"KRW",number:"410",digits:0,currency:"Won",countries:["Korea (The Republic Of)"]},{code:"KWD",number:"414",digits:3,currency:"Kuwaiti Dinar",countries:["Kuwait"]},{code:"KYD",number:"136",digits:2,currency:"Cayman Islands Dollar",countries:["Cayman Islands (The)"]},{code:"KZT",number:"398",digits:2,currency:"Tenge",countries:["Kazakhstan"]},{code:"LAK",number:"418",digits:2,currency:"Lao Kip",countries:["Lao People’s Democratic Republic (The)"]},{code:"LBP",number:"422",digits:2,currency:"Lebanese Pound",countries:["Lebanon"]},{code:"LKR",number:"144",digits:2,currency:"Sri Lanka Rupee",countries:["Sri Lanka"]},{code:"LRD",number:"430",digits:2,currency:"Liberian Dollar",countries:["Liberia"]},{code:"LSL",number:"426",digits:2,currency:"Loti",countries:["Lesotho"]},{code:"LYD",number:"434",digits:3,currency:"Libyan Dinar",countries:["Libya"]},{code:"MAD",number:"504",digits:2,currency:"Moroccan Dirham",countries:["Morocco","Western Sahara"]},{code:"MDL",number:"498",digits:2,currency:"Moldovan Leu",countries:["Moldova (The Republic Of)"]},{code:"MGA",number:"969",digits:2,currency:"Malagasy Ariary",countries:["Madagascar"]},{code:"MKD",number:"807",digits:2,currency:"Denar",countries:["North Macedonia"]},{code:"MMK",number:"104",digits:2,currency:"Kyat",countries:["Myanmar"]},{code:"MNT",number:"496",digits:2,currency:"Tugrik",countries:["Mongolia"]},{code:"MOP",number:"446",digits:2,currency:"Pataca",countries:["Macao"]},{code:"MRU",number:"929",digits:2,currency:"Ouguiya",countries:["Mauritania"]},{code:"MUR",number:"480",digits:2,currency:"Mauritius Rupee",countries:["Mauritius"]},{code:"MVR",number:"462",digits:2,currency:"Rufiyaa",countries:["Maldives"]},{code:"MWK",number:"454",digits:2,currency:"Malawi Kwacha",countries:["Malawi"]},{code:"MXN",number:"484",digits:2,currency:"Mexican Peso",countries:["Mexico"]},{code:"MXV",number:"979",digits:2,currency:"Mexican Unidad de Inversion (UDI)",countries:["Mexico"]},{code:"MYR",number:"458",digits:2,currency:"Malaysian Ringgit",countries:["Malaysia"]},{code:"MZN",number:"943",digits:2,currency:"Mozambique Metical",countries:["Mozambique"]},{code:"NAD",number:"516",digits:2,currency:"Namibia Dollar",countries:["Namibia"]},{code:"NGN",number:"566",digits:2,currency:"Naira",countries:["Nigeria"]},{code:"NIO",number:"558",digits:2,currency:"Cordoba Oro",countries:["Nicaragua"]},{code:"NOK",number:"578",digits:2,currency:"Norwegian Krone",countries:["Bouvet Island","Norway","Svalbard and Jan Mayen"]},{code:"NPR",number:"524",digits:2,currency:"Nepalese Rupee",countries:["Nepal"]},{code:"NZD",number:"554",digits:2,currency:"New Zealand Dollar",countries:["Cook Islands (The)","New Zealand","Niue","Pitcairn","Tokelau"]},{code:"OMR",number:"512",digits:3,currency:"Rial Omani",countries:["Oman"]},{code:"PAB",number:"590",digits:2,currency:"Balboa",countries:["Panama"]},{code:"PEN",number:"604",digits:2,currency:"Sol",countries:["Peru"]},{code:"PGK",number:"598",digits:2,currency:"Kina",countries:["Papua New Guinea"]},{code:"PHP",number:"608",digits:2,currency:"Philippine Peso",countries:["Philippines (The)"]},{code:"PKR",number:"586",digits:2,currency:"Pakistan Rupee",countries:["Pakistan"]},{code:"PLN",number:"985",digits:2,currency:"Zloty",countries:["Poland"]},{code:"PYG",number:"600",digits:0,currency:"Guarani",countries:["Paraguay"]},{code:"QAR",number:"634",digits:2,currency:"Qatari Rial",countries:["Qatar"]},{code:"RON",number:"946",digits:2,currency:"Romanian Leu",countries:["Romania"]},{code:"RSD",number:"941",digits:2,currency:"Serbian Dinar",countries:["Serbia"]},{code:"RUB",number:"643",digits:2,currency:"Russian Ruble",countries:["Russian Federation (The)"]},{code:"RWF",number:"646",digits:0,currency:"Rwanda Franc",countries:["Rwanda"]},{code:"SAR",number:"682",digits:2,currency:"Saudi Riyal",countries:["Saudi Arabia"]},{code:"SBD",number:"090",digits:2,currency:"Solomon Islands Dollar",countries:["Solomon Islands"]},{code:"SCR",number:"690",digits:2,currency:"Seychelles Rupee",countries:["Seychelles"]},{code:"SDG",number:"938",digits:2,currency:"Sudanese Pound",countries:["Sudan (The)"]},{code:"SEK",number:"752",digits:2,currency:"Swedish Krona",countries:["Sweden"]},{code:"SGD",number:"702",digits:2,currency:"Singapore Dollar",countries:["Singapore"]},{code:"SHP",number:"654",digits:2,currency:"Saint Helena Pound",countries:["Saint Helena, Ascension and Tristan Da Cunha"]},{code:"SLE",number:"925",digits:2,currency:"Leone",countries:["Sierra Leone"]},{code:"SLL",number:"694",digits:2,currency:"Leone",countries:["Sierra Leone"]},{code:"SOS",number:"706",digits:2,currency:"Somali Shilling",countries:["Somalia"]},{code:"SRD",number:"968",digits:2,currency:"Surinam Dollar",countries:["Suriname"]},{code:"SSP",number:"728",digits:2,currency:"South Sudanese Pound",countries:["South Sudan"]},{code:"STN",number:"930",digits:2,currency:"Dobra",countries:["Sao Tome and Principe"]},{code:"SVC",number:"222",digits:2,currency:"El Salvador Colon",countries:["El Salvador"]},{code:"SYP",number:"760",digits:2,currency:"Syrian Pound",countries:["Syrian Arab Republic"]},{code:"SZL",number:"748",digits:2,currency:"Lilangeni",countries:["Eswatini"]},{code:"THB",number:"764",digits:2,currency:"Baht",countries:["Thailand"]},{code:"TJS",number:"972",digits:2,currency:"Somoni",countries:["Tajikistan"]},{code:"TMT",number:"934",digits:2,currency:"Turkmenistan New Manat",countries:["Turkmenistan"]},{code:"TND",number:"788",digits:3,currency:"Tunisian Dinar",countries:["Tunisia"]},{code:"TOP",number:"776",digits:2,currency:"Pa’anga",countries:["Tonga"]},{code:"TRY",number:"949",digits:2,currency:"Turkish Lira",countries:["Türki̇ye"]},{code:"TTD",number:"780",digits:2,currency:"Trinidad and Tobago Dollar",countries:["Trinidad and Tobago"]},{code:"TWD",number:"901",digits:2,currency:"New Taiwan Dollar",countries:["Taiwan (Province of China)"]},{code:"TZS",number:"834",digits:2,currency:"Tanzanian Shilling",countries:["Tanzania, United Republic Of"]},{code:"UAH",number:"980",digits:2,currency:"Hryvnia",countries:["Ukraine"]},{code:"UGX",number:"800",digits:0,currency:"Uganda Shilling",countries:["Uganda"]},{code:"USD",number:"840",digits:2,currency:"US Dollar",countries:["American Samoa","Bonaire, Sint Eustatius and Saba","British Indian Ocean Territory (The)","Ecuador","El Salvador","Guam","Haiti","Marshall Islands (The)","Micronesia (Federated States Of)","Northern Mariana Islands (The)","Palau","Panama","Puerto Rico","Timor-Leste","Turks and Caicos Islands (The)","United States Minor Outlying Islands (The)","United States of America (The)","Virgin Islands (British)","Virgin Islands (u.s.)"]},{code:"USN",number:"997",digits:2,currency:"US Dollar (Next day)",countries:["United States of America (The)"]},{code:"UYI",number:"940",digits:0,currency:"Uruguay Peso en Unidades Indexadas (UI)",countries:["Uruguay"]},{code:"UYU",number:"858",digits:2,currency:"Peso Uruguayo",countries:["Uruguay"]},{code:"UYW",number:"927",digits:4,currency:"Unidad Previsional",countries:["Uruguay"]},{code:"UZS",number:"860",digits:2,currency:"Uzbekistan Sum",countries:["Uzbekistan"]},{code:"VED",number:"926",digits:2,currency:"Bolívar Soberano",countries:["Venezuela (Bolivarian Republic Of)"]},{code:"VES",number:"928",digits:2,currency:"Bolívar Soberano",countries:["Venezuela (Bolivarian Republic Of)"]},{code:"VND",number:"704",digits:0,currency:"Dong",countries:["Viet Nam"]},{code:"VUV",number:"548",digits:0,currency:"Vatu",countries:["Vanuatu"]},{code:"WST",number:"882",digits:2,currency:"Tala",countries:["Samoa"]},{code:"XAF",number:"950",digits:0,currency:"CFA Franc BEAC",countries:["Cameroon","Central African Republic (The)","Chad","Congo (The)","Equatorial Guinea","Gabon"]},{code:"XAG",number:"961",digits:0,currency:"Silver",countries:["Zz11_silver"]},{code:"XAU",number:"959",digits:0,currency:"Gold",countries:["Zz08_gold"]},{code:"XBA",number:"955",digits:0,currency:"Bond Markets Unit European Composite Unit (EURCO)",countries:["Zz01_bond Markets Unit European_eurco"]},{code:"XBB",number:"956",digits:0,currency:"Bond Markets Unit European Monetary Unit (E.M.U.-6)",countries:["Zz02_bond Markets Unit European_emu-6"]},{code:"XBC",number:"957",digits:0,currency:"Bond Markets Unit European Unit of Account 9 (E.U.A.-9)",countries:["Zz03_bond Markets Unit European_eua-9"]},{code:"XBD",number:"958",digits:0,currency:"Bond Markets Unit European Unit of Account 17 (E.U.A.-17)",countries:["Zz04_bond Markets Unit European_eua-17"]},{code:"XCD",number:"951",digits:2,currency:"East Caribbean Dollar",countries:["Anguilla","Antigua and Barbuda","Dominica","Grenada","Montserrat","Saint Kitts and Nevis","Saint Lucia","Saint Vincent and the Grenadines"]},{code:"XDR",number:"960",digits:0,currency:"SDR (Special Drawing Right)",countries:["International Monetary Fund (Imf) "]},{code:"XOF",number:"952",digits:0,currency:"CFA Franc BCEAO",countries:["Benin","Burkina Faso","Côte D'ivoire","Guinea-Bissau","Mali","Niger (The)","Senegal","Togo"]},{code:"XPD",number:"964",digits:0,currency:"Palladium",countries:["Zz09_palladium"]},{code:"XPF",number:"953",digits:0,currency:"CFP Franc",countries:["French Polynesia","New Caledonia","Wallis and Futuna"]},{code:"XPT",number:"962",digits:0,currency:"Platinum",countries:["Zz10_platinum"]},{code:"XSU",number:"994",digits:0,currency:"Sucre",countries:['Sistema Unitario De Compensacion Regional De Pagos "Sucre"']},{code:"XTS",number:"963",digits:0,currency:"Codes specifically reserved for testing purposes",countries:["Zz06_testing_code"]},{code:"XUA",number:"965",digits:0,currency:"ADB Unit of Account",countries:["Member Countries of the African Development Bank Group"]},{code:"XXX",number:"999",digits:0,currency:"The codes assigned for transactions where no currency is involved",countries:["Zz07_no_currency"]},{code:"YER",number:"886",digits:2,currency:"Yemeni Rial",countries:["Yemen"]},{code:"ZAR",number:"710",digits:2,currency:"Rand",countries:["Lesotho","Namibia","South Africa"]},{code:"ZMW",number:"967",digits:2,currency:"Zambian Kwacha",countries:["Zambia"]},{code:"ZWL",number:"932",digits:2,currency:"Zimbabwe Dollar",countries:["Zimbabwe"]}],Le=i=>(i=i.toUpperCase(),Kr(Ne,e=>e.code===i)),$r=()=>Ne.map(({code:i})=>i),zr=$r().filter(i=>Le(i)?.countries.every(e=>!e.startsWith("Zz")));function Oe(i,e,r={}){let n;try{n=new Intl.DisplayNames(i,{type:"currency",...r}).of(e)}catch(o){n=e,Ke||console.warn("CurrencyName format error:",o)}if(n===e){const o=Le(e);o?.currency&&(n=o.currency)}return cr(n||e)}const Zr=h(function({code:e,...r}){const n=ye().locale;return Oe(n.code,e,r)});Zr.displayName="ForwardRef shared/ui/(CurrencyName)";class Ae extends q{constructor(e,r,{options:n,...o}={}){super(r,{...o,options:()=>zr.map(s=>{const u=`[${s}] ${Oe(e.locale.code,s)}`;return{value:s,label:u}})})}}var kr=Object.defineProperty,Hr=(i,e,r)=>e in i?kr(i,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[e]=r,b=(i,e,r)=>Hr(i,typeof e!="symbol"?e+"":e,r);class Be{constructor(e,r){this.appContext=e,this.initialValueGetter=r,b(this,"t"),b(this,"currency"),b(this,"country"),b(this,"group"),b(this,"requiredValidator",Q(()=>this.t.forms("required"))),b(this,"name",new J(()=>this.initialValue.name,{validators:[this.requiredValidator]})),b(this,"locationRestrictions",new ir(()=>this.initialValue.locationRestrictions,{validators:[]})),b(this,"price",new J(()=>this.initialValue.price,{validators:[this.requiredValidator]})),b(this,"boostValue",new je(()=>this.initialValue.boostValue,{validators:[this.requiredValidator]})),b(this,"isBoosterAvailable",new ue(()=>this.initialValue.isBoosterAvailable,{validators:[this.requiredValidator]})),b(this,"isAvailable",new q(()=>this.initialValue.isAvailable,{validators:[this.requiredValidator],options:()=>[{value:!0,label:this.t.offer("status.active")},{value:!1,label:this.t.offer("status.disabled")}]})),b(this,"isOwnCallcenter",new ue(()=>this.initialValue.isOwnCallcenter,{validators:[this.requiredValidator]})),this.t=e.locale.translations,this.currency=new Ae(e,()=>this.initialValue.currency,{validators:[this.requiredValidator]}),this.country=new _e(e,()=>this.initialValue.country,{validators:[this.requiredValidator]}),this.group=new Y({name:this.name,locationRestrictions:this.locationRestrictions,price:this.price,currency:this.currency,country:this.country,boostValue:this.boostValue,isBoosterAvailable:this.isBoosterAvailable,isAvailable:this.isAvailable,isOwnCallcenter:this.isOwnCallcenter}),D(this)}get initialValue(){return this.initialValueGetter()||new ke("")}}var Jr=Object.defineProperty,Wr=(i,e,r)=>e in i?Jr(i,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[e]=r,M=(i,e,r)=>Wr(i,typeof e!="symbol"?e+"":e,r);class Xr{constructor(e,r){this.appContext=e,this.initialValueGetter=r,M(this,"t"),M(this,"currency"),M(this,"country"),M(this,"group"),M(this,"requiredValidator",Q(()=>this.t.forms("required"))),M(this,"amount",new je(()=>this.initialValue.amount,{validators:[this.requiredValidator]})),M(this,"status",new q(()=>this.initialValue.status,{validators:[this.requiredValidator],options:()=>[{value:"paused",label:this.t.offer("status.paused")},{value:"active",label:this.t.offer("status.active")}]})),this.t=e.locale.translations,this.currency=new Ae(e,()=>this.initialValue.currency,{validators:[this.requiredValidator]}),this.country=new _e(e,()=>this.initialValue.country,{validators:[this.requiredValidator]}),this.group=new Y({amount:this.amount,currency:this.currency,country:this.country,status:this.status}),D(this)}get initialValue(){return this.initialValueGetter()}}var Yr=Object.defineProperty,Qr=(i,e,r)=>e in i?Yr(i,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[e]=r,$=(i,e,r)=>Qr(i,typeof e!="symbol"?e+"":e,r);class et{constructor(e,r,n){this.offerStore=r,this.location=n,$(this,"form"),$(this,"payoutForm"),$(this,"mutation"),$(this,"payoutMutation"),this.form=new Be(e,()=>n),this.payoutForm=new Xr(e,()=>this.basePayout||new Se("").partialUpdateFromJson({locationId:n.id,offerId:n.offerId,currency:"USD",country:n.country})),this.mutation=new O(e.queryClient,{mutationFn:o=>v.patchOffersIdLocationsLocationId({offerId:n.offerId,locationId:n.id,offerLocationUpdateDto:o}),onError:o=>{e.notify.toastError(o)}}),this.payoutMutation=new O(e.queryClient,{mutationFn:()=>{const o=this.basePayout?.id;if(o){const s=this.form.group.changedValue;return v.patchOffersIdPayoutsPayoutId({offerId:n.offerId,offerPayoutId:o,offerPayoutUpdateDto:s})}else{const s={location:n.id,...this.payoutForm.group.value};return v.postOffersIdPayouts({offerId:n.offerId,offerPayoutCreateDto:s})}},onError:o=>{e.notify.toastError(o)}}),D(this,{handleSubmit:W.bound},{autoBind:!0})}get id(){return this.location.id}get basePayout(){return null}get personalPayouts(){return this.offerStore.payouts.filter(e=>e instanceof xe)}handleSubmit(){if(this.form.group.isInvalid){this.form.group.setTouched(!0),this.form.group.setDirty(!0),this.form.group.firstErrorControl?.element?.focus();return}const e=this.form.group.changedValue;this.mutation.mutate(e)}handleSubmitPayout(){this.payoutMutation.mutate()}}var rt=Object.defineProperty,tt=(i,e,r)=>e in i?rt(i,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[e]=r,L=(i,e,r)=>tt(i,typeof e!="symbol"?e+"":e,r);class it{constructor(e,r){this.appContext=e,this.offerStore=r,L(this,"addMutation"),L(this,"createForm"),L(this,"registry",new Ie(n=>new et(this.appContext,this.offerStore,n))),L(this,"createModalToggler",new z(!1)),L(this,"detailsToggler",new z(!1)),L(this,"selected",""),this.createForm=new Be(e,()=>null),this.addMutation=new O(e.queryClient,{mutationFn:n=>v.postOffersIdLocations({offerId:r.offerId,offerLocationCreateDto:n})}),D(this,{},{autoBind:!0})}get selectedModel(){return this.locations.find(e=>e.id===this.selected)}get offer(){return this.offerStore.offer}get locations(){return this.registry.from(this.offerStore.locations)}handleOpenForm(){this.createForm.group.reset(),this.createModalToggler.enable()}setSelected(e){this.selected=e,e?this.detailsToggler.enable():this.detailsToggler.disable()}handleModalAfterOpenChange(e){e||this.createForm.group.reset()}handleAfterOpenChange(e){e||(this.selected="")}handleSubmit(){if(this.createForm.group.isInvalid){this.createForm.group.setTouched(!0),this.createForm.group.setDirty(!0),this.createForm.group.firstErrorControl?.element?.focus?.();return}const e=this.createForm.group.value;this.addMutation.mutate(e)}}var nt=Object.defineProperty,ot=(i,e,r)=>e in i?nt(i,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[e]=r,fe=(i,e,r)=>ot(i,typeof e!="symbol"?e+"":e,r);class st{constructor(e,r,n){this.offerId=r,this.categoriesQuery=n,fe(this,"query"),fe(this,"payoutsQuery");const o=e.repositories.get(ce),s=e.repositories.get(He),u=e.repositories.get(Je),c=e.repositories.get(We),g=e.repositories.get(rr);this.query=new ae(e.queryClient,{queryKey:["offer",r],queryFn:()=>v.getAdimnOffersId({offerId:r}),onError:l=>{e.notify.toastError(l)},transform:l=>{const f=e.repositories.get(ce).get(r);if(l){const{locations:S,basePayouts:re,personalPayouts:te,domains:ie,...ne}=l;return{offer:o.get(ne.id).updateFromJson({...ne,locations:S.map(d=>d.id),basePayouts:re.map(d=>d.id),personalPayouts:te.map(d=>d.id),domains:ie.map(d=>d.id)}),locations:S.map(d=>s.get(d.id).updateFromJson(d)),basePayouts:re.map(d=>u.get(d.id).updateFromJson(d)),personalPayouts:te.map(d=>c.get(d.id).updateFromJson(d)),domains:ie.map(d=>g.get(d.id).updateFromJson(d)),offerRepository:o,locationRepository:s,basePayoutRepository:u,personalPayoutRepository:c,domainRepository:g}}return{offer:f,locations:f.locations.map(S=>s.get(S)),basePayouts:f.basePayouts.map(S=>u.get(S)),personalPayouts:f.personalPayouts.map(S=>c.get(S)),domains:f.domains.map(S=>g.get(S)),offerRepository:o,locationRepository:s,basePayoutRepository:u,personalPayoutRepository:c,domainRepository:g}},staleTime:1e3*60*5}),this.payoutsQuery=new ae(e.queryClient,{queryKey:["offer",r,"payouts"],queryFn:()=>v.getOffersIdPayouts({offerId:r}),onError:l=>{e.notify.toastError(l)},transform:l=>l?l.map(f=>f.baseId?c.get(f.id).updateFromJson(f):u.get(f.id).updateFromJson(f)):[],staleTime:1e3*60*5}),be(this,{offer:x,category:x,locations:x({equals:N.shallow}),payouts:x({equals:N.shallow}),basePayouts:x({equals:N.shallow}),personalPayouts:x({equals:N.shallow}),domains:x({equals:N.shallow}),repositories:x({equals:N.shallow})})}get repositories(){return{offer:this.query.data.offerRepository,locations:this.query.data.locationRepository,basePayouts:this.query.data.basePayoutRepository,domains:this.query.data.domainRepository,personalPayouts:this.query.data.personalPayoutRepository}}get payouts(){return this.payoutsQuery.data}get offer(){return this.query.data.offer}get category(){return this.categoriesQuery.repository.get(this.offer.categoryId)}get locations(){return this.query.data.locations}get basePayouts(){return this.payoutsQuery.data.filter(e=>e instanceof Se)}get personalPayouts(){return this.payoutsQuery.data.filter(e=>e instanceof xe)}get domains(){return this.query.data.domains}}var at=Object.defineProperty,ct=(i,e,r)=>e in i?at(i,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[e]=r,T=(i,e,r)=>ct(i,typeof e!="symbol"?e+"":e,r);class ut{constructor(e,r){this.appContext=e,this.offerId=r,T(this,"mutation"),T(this,"offerStore"),T(this,"offerForm"),T(this,"categoriesQuery"),T(this,"locationsSettings"),T(this,"domainsSettings"),T(this,"createModalToggler",new z(!1)),this.categoriesQuery=new Xe(e),this.offerStore=new st(e,r,this.categoriesQuery),this.offerForm=new Qe(e,()=>this.offerStore.offer),this.locationsSettings=new it(e,this.offerStore),this.domainsSettings=new wr(e,this.offerStore),this.mutation=new O(e.queryClient,{mutationFn:n=>v.patchOffersId({offerId:r,...n}),onError(n){e.notify.toastError(n)}}),D(this,{},{autoBind:!0})}handleSubmit(){if(this.offerForm.group.isInvalid){this.offerForm.group.setTouched(!0),this.offerForm.group.setDirty(!0),this.offerForm.group.firstErrorControl?.element?.focus?.();return}const{image:e,...r}=this.offerForm.group.value;e&&this.mutation.mutate(r)}dispose(){console.log("dispose")}init(){console.log("init")}}const Ee=I.createContext(null);function A(){const i=I.useContext(Ee);if(!i)throw new Error("Необходимо зарегистрировать провайдер AdminOfferPageContext");return i}const lt="_section_1cu6l_1",E={section:lt},dt="_image_3aeha_1",mt="_button_3aeha_18",ht="_loader_3aeha_24",V={image:dt,delete:"_delete_3aeha_11",button:mt,loader:ht},gt=()=>!1,ft=[],Ve=h(function({className:e,rows:r=3,model:n,fluid:o=!0}){const s=n.preview;return t.jsxs(we,{name:"avatar",listType:"picture-card",showUploadList:!1,beforeUpload:gt,fileList:ft,className:Pe(e),accept:".png,.jpg,.jpeg",rootClassName:V.wrapper,...n.inputProps,style:{width:o?"100%":void 0,"--rows":r,"--margin":"var(--ant-form-item-margin-bottom)","--label":"30px","--height":"calc(((62px + var(--margin)) * var(--rows) - var(--margin) - var(--label)))","--ant-control-height-lg":"calc(var(--height) / 2.55)"},children:[s&&t.jsx(m,{className:V.delete,icon:t.jsx(dr,{}),type:"text",onClick:u=>{u.stopPropagation(),n.inputProps.onChange(null)}}),s?t.jsxs(t.Fragment,{children:[n.isLoading&&t.jsx("div",{className:V.loader,children:t.jsx(le,{})}),t.jsx("img",{src:s,alt:"avatar",className:V.image})]}):t.jsxs("button",{className:V.button,type:"button",children:[n.isLoading?t.jsx(le,{}):t.jsx(mr,{}),t.jsx("div",{style:{marginTop:8},children:"Загрузить"})]})]})}),pt=h(function(){const e=A(),{t:r}=w("offer"),n=e.offerForm;return t.jsx(ee,{title:"Основные данные",children:t.jsxs(a,{layout:"vertical",onFinish:e.handleSubmit,children:[t.jsxs(X,{children:[t.jsxs(F,{xs:24,md:12,children:[t.jsx(a.Item,{label:r("form.titleLabel"),...n.title.itemProps,children:t.jsx(_,{placeholder:r("form.titlePlaceholder"),...n.title.inputProps})}),t.jsx(a.Item,{label:r("form.subtitleLabel"),...n.subtitle.itemProps,children:t.jsx(_,{placeholder:r("form.subtitlePlaceholder"),...n.subtitle.inputProps})}),t.jsx(a.Item,{label:r("form.verticalLabel"),...n.vertical.itemProps,children:t.jsx(p,{placeholder:r("form.verticalPlaceholder"),optionFilterProp:"label",showSearch:!0,...n.vertical.inputProps})}),t.jsx(a.Item,{label:r("form.categoryLabel"),...n.category.itemProps,children:t.jsx(p,{placeholder:r("form.categoryPlaceholder"),optionFilterProp:"label",showSearch:!0,...n.category.inputProps})}),t.jsx(a.Item,{label:r("form.statusLabel"),...n.status.itemProps,children:t.jsx(p,{placeholder:r("form.statusPlaceholder"),...n.status.inputProps})}),t.jsx(a.Item,{...n.accessOnRequest.itemProps,children:t.jsx(k,{...n.accessOnRequest.inputProps,children:r("form.accessOnRequestLabel")})}),t.jsx(a.Item,{...n.isTest.itemProps,children:t.jsx(k,{...n.isTest.inputProps,children:r("form.isTestLabel")})}),t.jsx(a.Item,{...n.isExclusive.itemProps,children:t.jsx(k,{...n.isExclusive.inputProps,children:r("form.isExclusiveLabel")})})]}),t.jsxs(F,{xs:24,md:12,children:[t.jsx(a.Item,{label:"Изображение",...n.image.itemProps,children:t.jsx(Ve,{rows:4,model:n.image})}),t.jsx(a.Item,{label:r("form.rulesLabel"),...n.rules.itemProps,children:t.jsx(_.TextArea,{placeholder:r("form.rulesPlaceholder"),...n.rules.inputProps,rows:9})})]})]}),t.jsxs(P,{gap:"sm",justify:"end",children:[t.jsx(m,{onClick:n.group.reset,disabled:!n.group.isChanged,children:r("buttons.reset",{ns:"common"})}),t.jsx(m,{type:"primary",loading:e.mutation.isPending,onClick:e.handleSubmit,disabled:!n.group.isChanged,children:r("buttons.submit",{ns:"common"})})]})]})})}),bt="_card_uv904_1",yt="_card_body_uv904_8",Pt="_table_uv904_14",St="_row_uv904_19",xt="_image_uv904_74",U={card:bt,card_body:yt,table:Pt,row:St,image:xt};function Ct(...i){return e=>{i.forEach(r=>{typeof r=="function"?r(e):r!=null&&(r.current=e)})}}const jt="_icon_41ejc_1",vt="_upload_41ejc_5",_t="_invalid_41ejc_12",H={icon:jt,upload:vt,invalid:_t},It=()=>!1,wt=[],Ue=h(I.forwardRef(function({className:e,model:r},n){const{t:o}=w("forms");return t.jsx(we.Dragger,{className:Pe(H.upload,e,{[H.invalid]:r.itemProps.validateStatus==="error"}),fileList:wt,multiple:!1,showUploadList:!1,beforeUpload:It,...r.inputProps,ref:Ct(n,r.inputProps.ref),children:t.jsxs(P,{direction:"column",align:"center",gap:"xs",children:[t.jsx(hr,{className:H.icon}),t.jsx("p",{children:r.inputProps.value?.name||o("drag&drop")})]})})}));Ue.displayName="ForwardRef shared/ui/form/(DropzoneInput)";const Ft=h(function({model:e}){const{t:r}=w("common");return t.jsx(De,{destroyOnHidden:!0,open:e.createModalToggler.isEnabled,onCancel:e.createModalToggler.disable,maskClosable:!1,afterOpenChange:e.handleAfterOpenChange,footer:t.jsxs(P,{gap:"sm",justify:"end",children:[t.jsx(m,{onClick:e.createModalToggler.disable,children:r("buttons.cancel")}),t.jsx(m,{onClick:e.modalForm.group.reset,disabled:!e.modalForm.group.isChanged,children:r("buttons.reset")}),t.jsx(m,{type:"primary",loading:e.mutation.isPending,onClick:e.handleSubmit,disabled:!e.modalForm.group.isChanged,children:r("buttons.submit")})]}),width:800,centered:!0,children:t.jsx(Dt,{model:e})})}),Dt=h(function({model:e}){const r=e.modalForm,{t:n}=w("admin");return t.jsx(a,{layout:"vertical",onFinish:e.handleSubmit,children:t.jsxs(X,{children:[t.jsxs(F,{xs:24,lg:12,children:[t.jsx(a.Item,{label:n("offers.forms.titleLabel"),...r.title.itemProps,children:t.jsx(_,{placeholder:n("offers.forms.titlePlaceholder"),...r.title.inputProps})}),t.jsx(a.Item,{label:n("offers.forms.typeLabel"),...r.type.itemProps,children:t.jsx(p,{placeholder:n("offers.forms.typePlaceholder"),optionFilterProp:"label",showSearch:!0,...r.type.inputProps})}),t.jsx(a.Item,{label:n("offers.forms.languagesLabel"),...r.languages.itemProps,children:t.jsx(p,{placeholder:n("offers.forms.languagesPlaceholder"),optionFilterProp:"label",showSearch:!0,...r.languages.inputProps})}),t.jsx(a.Item,{label:n("offers.forms.statusLabel"),...r.status.itemProps,children:t.jsx(p,{placeholder:n("offers.forms.statusPlaceholder"),optionFilterProp:"label",showSearch:!0,...r.status.inputProps})})]}),t.jsxs(F,{xs:24,lg:12,children:[t.jsx(a.Item,{label:n("offers.forms.imageLabel"),...r.image.itemProps,children:t.jsx(Ve,{model:r.image})}),t.jsx(a.Item,{label:n("offers.forms.sourceLabel"),...r.source.itemProps,children:t.jsx(Ue,{model:r.source})})]})]})})}),Mt={body:U.card_body},pe=h(function({type:e}){const n=A().domainsSettings;return t.jsxs(ee,{title:e==="landing"?"Лендинги":"Транзитки",className:U.card,classNames:Mt,extra:t.jsx(t.Fragment,{children:t.jsx(m,{onClick:()=>n.handleOpenForm(e),children:"Добавить"})}),children:[t.jsx(Tt,{type:e}),t.jsx(Ft,{model:n})]})}),Tt=h(function({type:e}){const n=A().domainsSettings,o=I.useMemo(()=>[{title:"Изображение",render:y(({domain:c})=>t.jsx(P,{gap:"xs",align:"center",justify:"start",onClick:g=>g.stopPropagation(),children:t.jsx(ur,{className:U.image,src:c.image,alt:c.title})}))},{title:"Статус",render:y(({domain:c})=>t.jsxs(t.Fragment,{children:[c.status==="active"&&t.jsx(R,{color:"success",children:" Активно "}),c.status==="archived"&&t.jsx(R,{color:"error",children:" Отключено "}),c.status==="paused"&&t.jsx(R,{color:"warning",children:" На паузе "})]}))},{title:"Гео",render:y(({locations:c})=>t.jsx(t.Fragment,{children:c.map(g=>t.jsx(P,{children:t.jsx(Fe,{code:g.country})},g.id))}))},{title:"Языки",render:y(({domain:c})=>{const g=c.languages.map(l=>t.jsx(P,{nowrap:!0,children:t.jsx(lr,{code:l})},l));return c.languages.length>4?t.jsx(Me,{overlay:g,children:t.jsxs(R,{children:[" ",c.languages.length," "]})}):g})},{title:"CR",render:y(({domain:c})=>c.cr)},{title:"",render:y(c=>t.jsx(m,{icon:t.jsx(Ce,{}),onClick:()=>n.setSelected(c.id)}))}],[n]),s=I.useCallback(c=>({onClick:()=>{n.setSelected(c.id)},className:U.row}),[n]),u=e==="landing"?n.landings:n.transits;return t.jsx(Te,{size:"middle",rowKey:"id",columns:o,pagination:!1,dataSource:u,className:U.table,onRow:s})}),Rt=h(function({model:e}){const r=e.form,{t:n}=w("offer");return t.jsxs(a,{layout:"vertical",children:[t.jsx(a.Item,{label:n("location.currencyLabel"),...r.currency.itemProps,children:t.jsx(p,{placeholder:n("location.currencyPlaceholder"),optionFilterProp:"label",showSearch:!0,...r.currency.inputProps})}),t.jsx(a.Item,{label:n("location.priceLabel"),...r.price.itemProps,children:t.jsx(_,{placeholder:n("location.pricePlaceholder"),...r.price.inputProps})}),t.jsx(a.Item,{label:n("location.locationRestrictionsLabel"),...r.locationRestrictions.itemProps,children:t.jsx(_.TextArea,{placeholder:n("location.locationRestrictionsPlaceholder"),...r.locationRestrictions.inputProps,rows:2})}),t.jsx(a.Item,{label:"Статус",...r.isAvailable.itemProps,children:t.jsx(p,{placeholder:"Выберите статус",optionFilterProp:"label",showSearch:!0,...r.isAvailable.inputProps})}),t.jsxs(P,{justify:"end",gap:"xs",children:[t.jsx(m,{disabled:!r.group.isChanged,onClick:r.group.reset,children:"Сбросить"}),t.jsx(m,{type:"primary",disabled:!r.group.isChanged,onClick:e.handleSubmit,loading:e.mutation.isPending,children:"Сохранить"})]})]})}),Nt="_card_fqvh8_1",Lt="_card_body_fqvh8_1",Ot="_table_fqvh8_5",At="_row_fqvh8_10",Bt="_locationsCard_fqvh8_34",Et="_locationsCard_body_fqvh8_34",Vt="_locationsCard_collapse_fqvh8_38",Ut="_locationsCard_section_fqvh8_44",C={card:Nt,card_body:Lt,table:Ot,row:At,locationsCard:Bt,locationsCard_body:Et,locationsCard_collapse:Vt,locationsCard_section:Ut},qt=h(function({model:e}){const r=e.payoutForm,{t:n}=w("offer");return t.jsxs(a,{layout:"vertical",children:[t.jsx(a.Item,{label:n("location.currencyLabel"),...r.currency.itemProps,children:t.jsx(p,{placeholder:n("location.currencyPlaceholder"),optionFilterProp:"label",showSearch:!0,...r.currency.inputProps})}),t.jsx(a.Item,{label:"Статус",...r.status.itemProps,children:t.jsx(p,{placeholder:"Выберите статус выплаты",optionFilterProp:"label",showSearch:!0,...r.status.inputProps})}),t.jsx(a.Item,{label:"Сумма выплаты",...r.amount.itemProps,children:t.jsx(_,{placeholder:"Введите сумму выплаты",...r.amount.inputProps})}),t.jsxs(P,{justify:"end",gap:"xs",children:[t.jsx(m,{disabled:!r.group.isChanged,onClick:r.group.reset,children:"Сбросить"}),t.jsx(m,{type:"primary",disabled:e.basePayout?!r.group.isChanged:!1,onClick:e.handleSubmitPayout,loading:e.payoutMutation.isPending,children:"Сохранить"})]})]})}),Gt={body:C.locationsCard_body},Kt=h(function(){const r=A().locationsSettings;return t.jsx(fr,{title:"Настройки гео",afterOpenChange:r.handleAfterOpenChange,onClose:r.detailsToggler.disable,open:r.detailsToggler.isEnabled,size:"large",className:C.locationsCard,classNames:Gt,children:r.selectedModel&&t.jsx($t,{model:r.selectedModel})})}),$t=h(function({model:e}){const r=I.useMemo(()=>[{key:"1",label:"Основные данные",children:t.jsx(Rt,{model:e}),className:C.locationsCard_section},{key:"2",label:"Настройки выплаты",children:t.jsx(qt,{model:e}),className:C.locationsCard_section},{key:"3",label:"Персональные выплаты",children:t.jsx(P,{align:"center",justify:"center",children:t.jsx("h3",{children:" В разработке"})}),className:C.locationsCard_section}],[e]),n=I.useMemo(()=>e.basePayout?["1","2"]:["2"],[e.basePayout]);return t.jsx(ar,{className:C.locationsCard_collapse,items:r,bordered:!1,defaultActiveKey:n})}),zt=h(function({model:e}){const{t:r}=w("common");return t.jsx(De,{destroyOnHidden:!0,open:e.createModalToggler.isEnabled,onCancel:e.createModalToggler.disable,maskClosable:!1,afterOpenChange:e.handleAfterOpenChange,footer:t.jsxs(P,{gap:"sm",justify:"end",children:[t.jsx(m,{onClick:e.createModalToggler.disable,children:r("buttons.cancel")}),t.jsx(m,{onClick:e.createForm.group.reset,disabled:!e.createForm.group.isChanged,children:r("buttons.reset")}),t.jsx(m,{type:"primary",loading:e.addMutation.isPending,onClick:e.handleSubmit,disabled:!e.createForm.group.isChanged,children:r("buttons.submit")})]}),centered:!0,children:t.jsx(Zt,{model:e})})}),Zt=h(function({model:e}){const r=e.createForm,{t:n}=w("offer");return t.jsxs(a,{layout:"vertical",onFinish:e.handleSubmit,children:[t.jsx(a.Item,{label:n("location.countryLabel"),...r.country.itemProps,children:t.jsx(p,{placeholder:n("location.countryPlaceholder"),optionFilterProp:"label",showSearch:!0,...r.country.inputProps})}),t.jsx(a.Item,{label:n("location.currencyLabel"),...r.currency.itemProps,children:t.jsx(p,{placeholder:n("location.currencyPlaceholder"),optionFilterProp:"label",showSearch:!0,...r.currency.inputProps})}),t.jsx(a.Item,{label:n("location.priceLabel"),...r.price.itemProps,children:t.jsx(_,{placeholder:n("location.pricePlaceholder"),...r.price.inputProps})}),t.jsx(a.Item,{label:n("location.locationRestrictionsLabel"),...r.locationRestrictions.itemProps,children:t.jsx(_.TextArea,{placeholder:n("location.locationRestrictionsPlaceholder"),...r.locationRestrictions.inputProps,rows:2})}),t.jsx(a.Item,{label:"Статус",...r.isAvailable.itemProps,children:t.jsx(p,{placeholder:"Выберите статус",optionFilterProp:"label",showSearch:!0,...r.isAvailable.inputProps})})]})}),kt={body:C.card_body},Ht=h(function(){const r=A().locationsSettings,{t:n}=w("offer");return t.jsxs(ee,{title:n("page.geo"),className:C.card,classNames:kt,extra:t.jsx(t.Fragment,{children:t.jsx(m,{onClick:r.handleOpenForm,children:n("buttons.add",{ns:"common"})})}),children:[t.jsx(Jt,{}),t.jsx(Kt,{}),t.jsx(zt,{model:r})]})}),Jt=h(function(){const r=A().locationsSettings,n=I.useMemo(()=>[{title:"Страна",render:y(({location:s})=>t.jsxs(P,{gap:"xs",align:"center",nowrap:!0,children:[t.jsx(gr,{code:s.country}),t.jsx(Fe,{code:s.country})]}))},{title:"Статус",render:y(({location:s})=>s.isAvailable?t.jsx(R,{color:"success",children:" Активно "}):t.jsx(R,{color:"error",children:" Отключено "}))},{title:"На сайте",render:y(({location:s})=>t.jsx(de,{code:s.currency,value:s.price}))},{title:"Выпл. $",render:y(({basePayout:s,personalPayouts:u})=>s?t.jsxs("div",{children:[t.jsx(de,{code:s.currency,value:s.amount}),u.length>0&&t.jsx(Me,{overlay:"Персональные выплаты",children:t.jsx(R,{children:`+ ${u.length+1}`})})]}):t.jsx(m,{danger:!0,size:"small",children:"Настроить"}))},{title:"Действия",render:y(s=>t.jsx(m,{icon:t.jsx(Ce,{}),onClick:()=>r.setSelected(s.id)}))}],[r]),o=I.useCallback(s=>({onClick:()=>{r.setSelected(s.id)},className:C.row}),[r]);return t.jsx(Te,{size:"middle",rowKey:"id",columns:n,pagination:!1,dataSource:r.locations,className:C.table,onRow:o})}),Wt=h(function(e){const r=ye(),n=$e(()=>new ut(r,e.offerId),[r,e.offerId]);return t.jsx(Ee.Provider,{value:n,children:t.jsx(Ze,{className:E.container,children:t.jsxs(X,{children:[t.jsx(F,{xs:24,xl:12,className:E.section,children:t.jsx(pt,{})}),t.jsx(F,{xs:24,xl:12,className:E.section,children:t.jsx(Ht,{})}),t.jsx(F,{xs:24,xl:12,className:E.section,children:t.jsx(pe,{type:"landing"})}),t.jsx(F,{xs:24,xl:12,className:E.section,children:t.jsx(pe,{type:"transit"})})]})})})}),Bi=()=>{const i=ze.useParams();return t.jsx(Wt,{offerId:i.offerId})};export{Bi as component};
