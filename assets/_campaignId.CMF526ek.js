import{bT as j,M as b,T as w,w as S,n as M,r as c,k as q,o as u,q as f,j as e,u as Q,bU as v}from"./index.B-zO2jcy.js";import{B as p}from"./Box.MGoU-yNc.js";import"./AppLayout.4kMJBK_d.js";import{L as P}from"./LayoutContainer.DB_i7kpz.js";import{C as F}from"./PostbackConfigFormGroup.BbNIFpDK.js";import{d as N}from"./CountryName.BQMzn-nx.js";import{P as z,a as T}from"./PosbackSettings.CnGrxhAS.js";import{C as O,D as R,R as k,O as B,a as I,b as U,L as D,T as E,c as L,d as W,U as $}from"./DomainSettings.C6bBeSG9.js";import{O as A,L as h}from"./LocationsTable.Bn4jn5tL.js";import{u as H,S as G}from"./useTranslation.B4Aad4mp.js";import{T as V}from"./Toggler.CKVCiuUU.js";import{G as J}from"./GridRow.Cw_MRkgE.js";import{a as K}from"./validators.CuBSd0d9.js";import{C as d,R as X}from"./row.ClGDsWbn.js";import{D as Y}from"./index.BJBaYR0i.js";import{C as Z}from"./EyeOutlined.DZce5g_D.js";import{a as ee}from"./_baseIteratee.CtRlXB8w.js";import{B as te}from"./button.BPmN1wK-.js";import"./index.BmkQiUau.js";import"./AntdIcon.BzrxpPa1.js";import"./SelectControl.BGsAxn8z.js";import"./Registry.B8N-PobL.js";import"./index.BJKN9cGs.js";import"./index.CspahUgb.js";import"./index.CmXbVTZH.js";import"./LanguageName.OhKNsFKn.js";import"./renderReactiveCell.HbM7Emo9.js";import"./index.BcPC7EJu.js";import"./index.5ZENuMvV.js";import"./index.BPddU0jj.js";import"./useTranslation.JeF3lAzJ.js";import"./FlagIcon.Ds-_yvnp.js";import"./NumberFormat.CuYZvbUu.js";var re=Object.defineProperty,se=(s,t,r)=>t in s?re(s,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[t]=r,n=(s,t,r)=>se(s,typeof t!="symbol"?t+"":t,r);class ae{constructor(t,r){this.appContext=t,n(this,"form"),n(this,"offerQuery"),n(this,"updateMutation"),n(this,"offerCategoriesQuery"),n(this,"query"),n(this,"hostnamesQuery"),n(this,"postbackSettings"),this.hostnamesQuery=new F(t),this.query=new j(t,r),this.postbackSettings=new z(t,this.query.campaign),this.offerCategoriesQuery=new N(t);const a=this.query.data.campaign;this.offerQuery=new A(this.appContext,this.offerCategoriesQuery,a.offerId),this.form=new O(this.appContext,this.hostnamesQuery,this.offerQuery,a),this.updateMutation=new b(t.queryClient,{mutationFn:i=>w.patchCampaignsCampaignid({campaignId:r,campaignUpdateDto:i}),onError:i=>{t.notify.toastError(i)}}),S(this,{handleUpdate:M.bound})}get store(){return this.query.store}handleUpdate(){return this.updateMutation.mutate(this.form.group.changedValue)}}var oe=Object.defineProperty,ie=(s,t,r)=>t in s?oe(s,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[t]=r,ne=(s,t,r)=>ie(s,t+"",r);class me{constructor(t,r){ne(this,"item"),this.item=new ae(t,r),q(this,{},{autoBind:!0})}}const x=c.createContext(null);function _(){const s=c.useContext(x);if(!s)throw new Error("Необходимо зарегистрировать провайдер WebmasterCampaignModelContext");return s}const le={body:{padding:0}},ce=u(function(){const t=_(),r=t.item.form,a=t.item.offerQuery,i=t.item.offerQuery.data,m=f(()=>new V,[]),l=!f(()=>new R,[]).isBreakpointUp("md"),y=c.useMemo(()=>({y:367}),[]),C=c.useMemo(()=>l?{trigger:"hover",icon:e.jsx("div",{children:e.jsx(k,{onClick:m.enable})}),overlay:""}:void 0,[m,l]);return e.jsxs(K,{layout:"vertical",children:[e.jsxs(J,{children:[e.jsxs(d,{xs:24,md:11,lg:12,children:[e.jsx(B,{offer:i.offer}),e.jsx(I,{model:r.name}),e.jsx(U,{model:r.countryCode,tooltip:C}),e.jsx(D,{model:r.language}),e.jsx(E,{model:r.trafficSource})]}),!l&&e.jsx(d,{xs:24,md:13,lg:12,children:e.jsx(h,{offerQuery:a,size:"small",scroll:y})})]}),l&&e.jsx(Y,{size:"large",title:"География",open:m.isEnabled,onClose:m.disable,styles:le,children:e.jsx(h,{scroll:null,offerQuery:a})})]})}),g=u(function({model:t,title:r}){return e.jsxs(e.Fragment,{children:[e.jsx("h4",{children:r}),e.jsxs(X,{gutter:24,children:[e.jsx(d,{xs:24,lg:12,children:e.jsx(L,{model:t})}),e.jsx(d,{xs:24,lg:12,children:e.jsx(W,{templatesControl:t.controls.templates})})]})]})}),pe="_collapse_wrapper_1m4qz_1",de="_collapse_1m4qz_1",ue="_collapse_item_1m4qz_6",fe="_collapse_header_1m4qz_13",he="_card_body_1m4qz_19",ge="_card_header_1m4qz_23",o={collapse_wrapper:pe,collapse:de,collapse_item:ue,collapse_header:fe,card_body:he,card_header:ge},xe={body:o.card_body,header:o.card_header},_e=u(function(){const{t}=H("campaign"),r=_(),a=r.item,i=r.item.form,m=r.item.query.data.campaign;return e.jsxs(Z,{title:`${t("page.campaign")}: ${m.name}`,classNames:xe,children:[e.jsx(ce,{}),e.jsx(g,{model:a.form.landing,title:"Лендинг"}),a.form.transit&&e.jsx(g,{model:a.form.transit,title:"Транзит"}),e.jsx(ee,{rootClassName:o.collapse_wrapper,items:[{key:"postback",label:e.jsx(p,{align:"center",gap:"md",children:e.jsx("h4",{style:{margin:0,paddingRight:8},children:"Постбэк"})}),children:e.jsx(T,{model:a.postbackSettings}),className:o.collapse_item,classNames:{header:o.collapse_header}},{key:"utm",label:e.jsx("h4",{style:{margin:0,paddingRight:8},children:"UTM метки"}),children:e.jsx($,{model:i.utmParams}),className:o.collapse_item,classNames:{header:o.collapse_header}}],className:o.collapse,ghost:!0}),e.jsx(p,{gap:"sm",children:e.jsx(te,{loading:a.updateMutation.isPending,size:"large",type:"primary",onClick:a.handleUpdate,children:"Сохранить изменения"})})]})}),ye="_container_1j27o_6",Ce={container:ye},je=u(function({campaignId:t}){const r=Q(),a=f(()=>new me(r,t),[r,t]);return e.jsx(P,{className:Ce.container,children:e.jsx(x.Provider,{value:a,children:a.item.query.isLoading?e.jsx(p,{justify:"center",align:"center",style:{minHeight:"400px"},children:e.jsx(G,{size:"large"})}):a.item.query.isError?e.jsx(p,{justify:"center",align:"center",style:{minHeight:"400px"},children:e.jsx("div",{children:"Ошибка загрузки кампании"})}):e.jsx(_e,{})})})}),rt=()=>{const s=v.useParams();return e.jsx(je,{campaignId:s.campaignId})};export{rt as component};
