import{d as Te,m as et,f as Pe,ad as D,e as F,r as i,C as ie,c as _,E as tt,w as Ee,x as xe,n as L,z as Fe,k as Ie,bZ as ot,M as st,bT as ae,T as rt,b_ as ke,o as k,q as re,j as o,b$ as nt,c0 as it,u as at,c1 as ye}from"./index.B-zO2jcy.js";import{B as H}from"./Box.MGoU-yNc.js";import"./AppLayout.4kMJBK_d.js";import{L as lt}from"./LayoutContainer.DB_i7kpz.js";import{P as ct,a as dt,C as ut}from"./PostbackConfigFormGroup.BbNIFpDK.js";import{d as mt}from"./CountryName.BQMzn-nx.js";import{O as pt,L as ve}from"./LocationsTable.Bn4jn5tL.js";import{C as gt,D as ft,R as ht,O as bt,a as xt,b as yt,L as vt,T as Ct,c as Ce,d as je,A as jt,U as St}from"./DomainSettings.C6bBeSG9.js";import{A as wt,a as K}from"./validators.CuBSd0d9.js";import{u as le,E as $t,a as _t,S as Nt}from"./useTranslation.B4Aad4mp.js";import{T as Ot}from"./Toggler.CKVCiuUU.js";import{G as ze}from"./GridRow.Cw_MRkgE.js";import{C as I,R as Se}from"./row.ClGDsWbn.js";import{D as Tt}from"./index.BJBaYR0i.js";import{C as Pt}from"./index.BcPC7EJu.js";import{u as Et}from"./useCopyToClipboard.B86wp29P.js";import{Z as Re,_ as Be,T as Ft}from"./AntdIcon.BzrxpPa1.js";import{F as It}from"./renderReactiveCell.HbM7Emo9.js";import{T as v}from"./index.CGcGwI_R.js";import{T as M}from"./index.5ZENuMvV.js";import{I as kt}from"./index.CmXbVTZH.js";import{c as Me,B as ne}from"./button.BPmN1wK-.js";import{C as zt}from"./EyeOutlined.DZce5g_D.js";import{a as Rt}from"./_baseIteratee.CtRlXB8w.js";import"./index.BmkQiUau.js";import"./SelectControl.BGsAxn8z.js";import"./FlagIcon.Ds-_yvnp.js";import"./NumberFormat.CuYZvbUu.js";import"./LanguageName.OhKNsFKn.js";import"./index.CspahUgb.js";import"./useTranslation.JeF3lAzJ.js";import"./index.BPddU0jj.js";const Bt=new D("antStatusProcessing",{"0%":{transform:"scale(0.8)",opacity:.5},"100%":{transform:"scale(2.4)",opacity:0}}),Mt=new D("antZoomBadgeIn",{"0%":{transform:"scale(0) translate(50%, -50%)",opacity:0},"100%":{transform:"scale(1) translate(50%, -50%)"}}),Dt=new D("antZoomBadgeOut",{"0%":{transform:"scale(1) translate(50%, -50%)"},"100%":{transform:"scale(0) translate(50%, -50%)",opacity:0}}),Wt=new D("antNoWrapperZoomBadgeIn",{"0%":{transform:"scale(0)",opacity:0},"100%":{transform:"scale(1)"}}),At=new D("antNoWrapperZoomBadgeOut",{"0%":{transform:"scale(1)"},"100%":{transform:"scale(0)",opacity:0}}),Ht=new D("antBadgeLoadingCircle",{"0%":{transformOrigin:"50%"},"100%":{transform:"translate(50%, -50%) rotate(360deg)",transformOrigin:"50%"}}),Qt=t=>{const{componentCls:e,iconCls:r,antCls:s,badgeShadowSize:n,textFontSize:a,textFontSizeSM:l,statusSize:p,dotSize:h,textFontWeight:b,indicatorHeight:u,indicatorHeightSM:c,marginXS:m,calc:f}=t,g=`${s}-scroll-number`,S=Re(t,(C,{darkColor:w})=>({[`&${e} ${e}-color-${C}`]:{background:w,[`&:not(${e}-count)`]:{color:w},"a:hover &":{background:w}}}));return{[e]:Object.assign(Object.assign(Object.assign(Object.assign({},Pe(t)),{position:"relative",display:"inline-block",width:"fit-content",lineHeight:1,[`${e}-count`]:{display:"inline-flex",justifyContent:"center",zIndex:t.indicatorZIndex,minWidth:u,height:u,color:t.badgeTextColor,fontWeight:b,fontSize:a,lineHeight:F(u),whiteSpace:"nowrap",textAlign:"center",background:t.badgeColor,borderRadius:f(u).div(2).equal(),boxShadow:`0 0 0 ${F(n)} ${t.badgeShadowColor}`,transition:`background ${t.motionDurationMid}`,a:{color:t.badgeTextColor},"a:hover":{color:t.badgeTextColor},"a:hover &":{background:t.badgeColorHover}},[`${e}-count-sm`]:{minWidth:c,height:c,fontSize:l,lineHeight:F(c),borderRadius:f(c).div(2).equal()},[`${e}-multiple-words`]:{padding:`0 ${F(t.paddingXS)}`,bdi:{unicodeBidi:"plaintext"}},[`${e}-dot`]:{zIndex:t.indicatorZIndex,width:h,minWidth:h,height:h,background:t.badgeColor,borderRadius:"100%",boxShadow:`0 0 0 ${F(n)} ${t.badgeShadowColor}`},[`${e}-count, ${e}-dot, ${g}-custom-component`]:{position:"absolute",top:0,insetInlineEnd:0,transform:"translate(50%, -50%)",transformOrigin:"100% 0%",[`&${r}-spin`]:{animationName:Ht,animationDuration:"1s",animationIterationCount:"infinite",animationTimingFunction:"linear"}},[`&${e}-status`]:{lineHeight:"inherit",verticalAlign:"baseline",[`${e}-status-dot`]:{position:"relative",top:-1,display:"inline-block",width:p,height:p,verticalAlign:"middle",borderRadius:"50%"},[`${e}-status-success`]:{backgroundColor:t.colorSuccess},[`${e}-status-processing`]:{overflow:"visible",color:t.colorInfo,backgroundColor:t.colorInfo,borderColor:"currentcolor","&::after":{position:"absolute",top:0,insetInlineStart:0,width:"100%",height:"100%",borderWidth:n,borderStyle:"solid",borderColor:"inherit",borderRadius:"50%",animationName:Bt,animationDuration:t.badgeProcessingDuration,animationIterationCount:"infinite",animationTimingFunction:"ease-in-out",content:'""'}},[`${e}-status-default`]:{backgroundColor:t.colorTextPlaceholder},[`${e}-status-error`]:{backgroundColor:t.colorError},[`${e}-status-warning`]:{backgroundColor:t.colorWarning},[`${e}-status-text`]:{marginInlineStart:m,color:t.colorText,fontSize:t.fontSize}}}),S),{[`${e}-zoom-appear, ${e}-zoom-enter`]:{animationName:Mt,animationDuration:t.motionDurationSlow,animationTimingFunction:t.motionEaseOutBack,animationFillMode:"both"},[`${e}-zoom-leave`]:{animationName:Dt,animationDuration:t.motionDurationSlow,animationTimingFunction:t.motionEaseOutBack,animationFillMode:"both"},[`&${e}-not-a-wrapper`]:{[`${e}-zoom-appear, ${e}-zoom-enter`]:{animationName:Wt,animationDuration:t.motionDurationSlow,animationTimingFunction:t.motionEaseOutBack},[`${e}-zoom-leave`]:{animationName:At,animationDuration:t.motionDurationSlow,animationTimingFunction:t.motionEaseOutBack},[`&:not(${e}-status)`]:{verticalAlign:"middle"},[`${g}-custom-component, ${e}-count`]:{transform:"none"},[`${g}-custom-component, ${g}`]:{position:"relative",top:"auto",display:"block",transformOrigin:"50% 50%"}},[g]:{overflow:"hidden",transition:`all ${t.motionDurationMid} ${t.motionEaseOutBack}`,[`${g}-only`]:{position:"relative",display:"inline-block",height:u,transition:`all ${t.motionDurationSlow} ${t.motionEaseOutBack}`,WebkitTransformStyle:"preserve-3d",WebkitBackfaceVisibility:"hidden",[`> p${g}-only-unit`]:{height:u,margin:0,WebkitTransformStyle:"preserve-3d",WebkitBackfaceVisibility:"hidden"}},[`${g}-symbol`]:{verticalAlign:"top"}},"&-rtl":{direction:"rtl",[`${e}-count, ${e}-dot, ${g}-custom-component`]:{transform:"translate(-50%, -50%)"}}})}},De=t=>{const{fontHeight:e,lineWidth:r,marginXS:s,colorBorderBg:n}=t,a=e,l=r,p=t.colorTextLightSolid,h=t.colorError,b=t.colorErrorHover;return et(t,{badgeFontHeight:a,badgeShadowSize:l,badgeTextColor:p,badgeColor:h,badgeColorHover:b,badgeShadowColor:n,badgeProcessingDuration:"1.2s",badgeRibbonOffset:s,badgeRibbonCornerTransform:"scaleY(0.75)",badgeRibbonCornerFilter:"brightness(75%)"})},We=t=>{const{fontSize:e,lineHeight:r,fontSizeSM:s,lineWidth:n}=t;return{indicatorZIndex:"auto",indicatorHeight:Math.round(e*r)-2*n,indicatorHeightSM:e,dotSize:s/2,textFontSize:s,textFontSizeSM:s,textFontWeight:"normal",statusSize:s/2}},Zt=Te("Badge",t=>{const e=De(t);return Qt(e)},We),qt=t=>{const{antCls:e,badgeFontHeight:r,marginXS:s,badgeRibbonOffset:n,calc:a}=t,l=`${e}-ribbon`,p=`${e}-ribbon-wrapper`,h=Re(t,(b,{darkColor:u})=>({[`&${l}-color-${b}`]:{background:u,color:u}}));return{[p]:{position:"relative"},[l]:Object.assign(Object.assign(Object.assign(Object.assign({},Pe(t)),{position:"absolute",top:s,padding:`0 ${F(t.paddingXS)}`,color:t.colorPrimary,lineHeight:F(r),whiteSpace:"nowrap",backgroundColor:t.colorPrimary,borderRadius:t.borderRadiusSM,[`${l}-text`]:{color:t.badgeTextColor},[`${l}-corner`]:{position:"absolute",top:"100%",width:n,height:n,color:"currentcolor",border:`${F(a(n).div(2).equal())} solid`,transform:t.badgeRibbonCornerTransform,transformOrigin:"top",filter:t.badgeRibbonCornerFilter}}),h),{[`&${l}-placement-end`]:{insetInlineEnd:a(n).mul(-1).equal(),borderEndEndRadius:0,[`${l}-corner`]:{insetInlineEnd:0,borderInlineEndColor:"transparent",borderBlockEndColor:"transparent"}},[`&${l}-placement-start`]:{insetInlineStart:a(n).mul(-1).equal(),borderEndStartRadius:0,[`${l}-corner`]:{insetInlineStart:0,borderBlockEndColor:"transparent",borderInlineStartColor:"transparent"}},"&-rtl":{direction:"rtl"}})}},Vt=Te(["Badge","Ribbon"],t=>{const e=De(t);return qt(e)},We),Lt=t=>{const{className:e,prefixCls:r,style:s,color:n,children:a,text:l,placement:p="end",rootClassName:h}=t,{getPrefixCls:b,direction:u}=i.useContext(ie),c=b("ribbon",r),m=`${c}-wrapper`,[f,g,S]=Vt(c,m),C=Be(n,!1),w=_(c,`${c}-placement-${p}`,{[`${c}-rtl`]:u==="rtl",[`${c}-color-${n}`]:C},e),y={},N={};return n&&!C&&(y.background=n,N.color=n),f(i.createElement("div",{className:_(m,h,g,S)},a,i.createElement("div",{className:_(w,g),style:Object.assign(Object.assign({},y),s)},i.createElement("span",{className:`${c}-text`},l),i.createElement("div",{className:`${c}-corner`,style:N}))))},we=t=>{const{prefixCls:e,value:r,current:s,offset:n=0}=t;let a;return n&&(a={position:"absolute",top:`${n}00%`,left:0}),i.createElement("span",{style:a,className:_(`${e}-only-unit`,{current:s})},r)};function Kt(t,e,r){let s=t,n=0;for(;(s+10)%10!==e;)s+=r,n+=r;return n}const Ut=t=>{const{prefixCls:e,count:r,value:s}=t,n=Number(s),a=Math.abs(r),[l,p]=i.useState(n),[h,b]=i.useState(a),u=()=>{p(n),b(a)};i.useEffect(()=>{const f=setTimeout(u,1e3);return()=>clearTimeout(f)},[n]);let c,m;if(l===n||Number.isNaN(n)||Number.isNaN(l))c=[i.createElement(we,Object.assign({},t,{key:n,current:!0}))],m={transition:"none"};else{c=[];const f=n+10,g=[];for(let y=n;y<=f;y+=1)g.push(y);const S=h<a?1:-1,C=g.findIndex(y=>y%10===l);c=(S<0?g.slice(0,C+1):g.slice(C)).map((y,N)=>{const U=y%10;return i.createElement(we,Object.assign({},t,{key:y,value:U,offset:S<0?N-C:N,current:N===C}))}),m={transform:`translateY(${-Kt(l,n,S)}00%)`}}return i.createElement("span",{className:`${e}-only`,style:m,onTransitionEnd:u},c)};var Gt=function(t,e){var r={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(r[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(t);n<s.length;n++)e.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(t,s[n])&&(r[s[n]]=t[s[n]]);return r};const Jt=i.forwardRef((t,e)=>{const{prefixCls:r,count:s,className:n,motionClassName:a,style:l,title:p,show:h,component:b="sup",children:u}=t,c=Gt(t,["prefixCls","count","className","motionClassName","style","title","show","component","children"]),{getPrefixCls:m}=i.useContext(ie),f=m("scroll-number",r),g=Object.assign(Object.assign({},c),{"data-show":h,style:l,className:_(f,n,a),title:p});let S=s;if(s&&Number(s)%1===0){const C=String(s).split("");S=i.createElement("bdi",null,C.map((w,y)=>i.createElement(Ut,{prefixCls:f,count:Number(s),value:w,key:C.length-y})))}return l?.borderColor&&(g.style=Object.assign(Object.assign({},l),{boxShadow:`0 0 0 1px ${l.borderColor} inset`})),u?Me(u,C=>({className:_(`${f}-custom-component`,C?.className,a)})):i.createElement(b,Object.assign({},g,{ref:e}),S)});var Xt=function(t,e){var r={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(r[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(t);n<s.length;n++)e.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(t,s[n])&&(r[s[n]]=t[s[n]]);return r};const Yt=i.forwardRef((t,e)=>{var r,s,n,a,l;const{prefixCls:p,scrollNumberPrefixCls:h,children:b,status:u,text:c,color:m,count:f=null,overflowCount:g=99,dot:S=!1,size:C="default",title:w,offset:y,style:N,className:U,rootClassName:Ze,classNames:T,styles:$,showZero:Q=!1}=t,ce=Xt(t,["prefixCls","scrollNumberPrefixCls","children","status","text","color","count","overflowCount","dot","size","title","offset","style","className","rootClassName","classNames","styles","showZero"]),{getPrefixCls:de,direction:G,badge:d}=i.useContext(ie),j=de("badge",p),[ue,qe,Ve]=Zt(j),J=f>g?`${g}+`:f,W=J==="0"||J===0||c==="0"||c===0,me=f===null||W&&!Q,X=(u!=null||m!=null)&&me,Le=u!=null||!W,A=S&&!W,z=A?"":J,R=i.useMemo(()=>((z==null||z==="")&&(c==null||c==="")||W&&!Q)&&!A,[z,W,Q,A,c]),pe=i.useRef(f);R||(pe.current=f);const B=pe.current,ge=i.useRef(z);R||(ge.current=z);const Y=ge.current,fe=i.useRef(A);R||(fe.current=A);const Z=i.useMemo(()=>{if(!y)return Object.assign(Object.assign({},d?.style),N);const O={marginTop:y[1]};return G==="rtl"?O.left=parseInt(y[0],10):O.right=-parseInt(y[0],10),Object.assign(Object.assign(Object.assign({},O),d?.style),N)},[G,y,N,d?.style]),Ke=w??(typeof B=="string"||typeof B=="number"?B:void 0),he=!R&&(c===0?Q:!!c&&c!==!0),Ue=he?i.createElement("span",{className:`${j}-status-text`},c):null,Ge=!B||typeof B!="object"?void 0:Me(B,O=>({style:Object.assign(Object.assign({},Z),O.style)})),q=Be(m,!1),Je=_(T?.indicator,(r=d?.classNames)===null||r===void 0?void 0:r.indicator,{[`${j}-status-dot`]:X,[`${j}-status-${u}`]:!!u,[`${j}-color-${m}`]:q}),ee={};m&&!q&&(ee.color=m,ee.background=m);const be=_(j,{[`${j}-status`]:X,[`${j}-not-a-wrapper`]:!b,[`${j}-rtl`]:G==="rtl"},U,Ze,d?.className,(s=d?.classNames)===null||s===void 0?void 0:s.root,T?.root,qe,Ve);if(!b&&X&&(c||Le||!me)){const O=Z.color;return ue(i.createElement("span",Object.assign({},ce,{className:be,style:Object.assign(Object.assign(Object.assign({},$?.root),(n=d?.styles)===null||n===void 0?void 0:n.root),Z)}),i.createElement("span",{className:Je,style:Object.assign(Object.assign(Object.assign({},$?.indicator),(a=d?.styles)===null||a===void 0?void 0:a.indicator),ee)}),he&&i.createElement("span",{style:{color:O},className:`${j}-status-text`},c)))}return ue(i.createElement("span",Object.assign({ref:e},ce,{className:be,style:Object.assign(Object.assign({},(l=d?.styles)===null||l===void 0?void 0:l.root),$?.root)}),b,i.createElement(tt,{visible:!R,motionName:`${j}-zoom`,motionAppear:!1,motionDeadline:1e3},({className:O})=>{var te,oe;const Xe=de("scroll-number",h),se=fe.current,Ye=_(T?.indicator,(te=d?.classNames)===null||te===void 0?void 0:te.indicator,{[`${j}-dot`]:se,[`${j}-count`]:!se,[`${j}-count-sm`]:C==="small",[`${j}-multiple-words`]:!se&&Y&&Y.toString().length>1,[`${j}-status-${u}`]:!!u,[`${j}-color-${m}`]:q});let V=Object.assign(Object.assign(Object.assign({},$?.indicator),(oe=d?.styles)===null||oe===void 0?void 0:oe.indicator),Z);return m&&!q&&(V=V||{},V.background=m),i.createElement(Jt,{prefixCls:Xe,show:!R,motionClassName:O,className:Ye,count:Y,title:Ke,style:V,key:"scrollNumber"},Ge)}),Ue))}),Ae=Yt;Ae.Ribbon=Lt;class eo extends wt{constructor(e){super(),this.controls=e,Ee(this,{controls:Fe,value:xe.struct,changedValue:xe.struct,setValue:L})}add(e,r){return r!==void 0?this.controls.splice(r,0,e):this.controls.push(e),this}remove(e){return this.controls.splice(e,1),this}get value(){return this.controls.map(e=>e.value)}get changedValue(){return this.controls.filter(e=>e.isChanged).map(e=>e.value)}setValue(e){for(let r=0;r<e.length;r++)this.controls[r].setValue(e[r])}*getControls(){for(const e of this.controls)yield e}}var to=Object.defineProperty,oo=(t,e,r)=>e in t?to(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,so=(t,e,r)=>oo(t,e+"",r);class ro{constructor(e){this.appContext=e,so(this,"group",new eo([])),Ie(this,{},{autoBind:!0})}get count(){return this.group.controls.length}get isEmpty(){return this.count===0}get isError(){return this.group.isInvalid}add(){const e=`new_${this.group.controls.length}`,r=new ct(e),s=new dt(this.appContext,r);s.setDirty(!0),s.setTouched(!0),this.group.add(s),setTimeout(()=>{s.firstErrorControl?.element?.focus()},300)}delete(e){const r=this.group.controls.findIndex(s=>s.postbackConfig.id===e);r!==-1&&(console.log({index:r}),this.group.remove(r))}}var no=Object.defineProperty,io=(t,e,r)=>e in t?no(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,P=(t,e,r)=>io(t,typeof e!="symbol"?e+"":e,r);class ao{constructor(e,r){this.appContext=e,P(this,"form"),P(this,"offerQuery"),P(this,"campaign"),P(this,"createMutation"),P(this,"offerCategoriesQuery"),P(this,"hostnamesQuery"),P(this,"postbacksForm"),P(this,"activeKeys",[]),this.campaign=new ot("new").partialUpdateFromJson({offerId:r}),this.offerCategoriesQuery=new mt(e),this.hostnamesQuery=new ut(e),this.offerQuery=new pt(this.appContext,this.offerCategoriesQuery,this.campaign.offerId),this.form=new gt(this.appContext,this.hostnamesQuery,this.offerQuery,this.campaign),this.postbacksForm=new ro(e),this.createMutation=new st(e.queryClient,{mutationFn:()=>rt.postCampaigns({campaignCreateDto:{offerId:this.campaign.offerId,postbacks:this.postbacksForm.group.value.map(s=>({...s,type:"campaign"})),...this.form.group.value}}),onSuccess:s=>{ae.setData(e.queryClient,s),e.router.instance.navigate({to:"/campaigns/$campaignId",params:{campaignId:s.id}})},onError:s=>{e.notify.toastError(s)}}),Ee(this,{activeKeys:Fe,addPostback:L.bound,handleSubmit:L.bound,handleChangeActiveKeys:L.bound},{autoBind:!0})}handleChangeActiveKeys(e){this.activeKeys=e}addPostback(e){e?.stopPropagation(),this.activeKeys.includes("postback")||(this.activeKeys=[...this.activeKeys,"postback"]),this.postbacksForm.add()}handleSubmit(){if(this.form.group.isInvalid){this.form.group.setDirty(!0),this.form.group.setTouched(!0),this.form.group.firstErrorControl?.element?.focus();return}return this.createMutation.mutate()}}var lo=Object.defineProperty,co=(t,e,r)=>e in t?lo(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,uo=(t,e,r)=>co(t,e+"",r);class mo{constructor(e,r){this.appContext=e,uo(this,"item"),this.item=new ao(e,r),Ie(this,{},{autoBind:!0})}initFrom(e){const r=new ae(this.appContext,e);return ke(()=>r.isFetched&&!r.isStale&&r.isSuccess,()=>{this.item.campaign.updateFromJson(r.data.toJSON())})}}const He=i.createContext(null);function Qe(){const t=i.useContext(He);if(!t)throw new Error("Необходимо зарегистрировать провайдер WebmasterNewCampaignModelContext");return t}const po={body:{padding:0}},go=k(function(){const e=Qe(),r=e.item.form,s=e.item.offerQuery,n=e.item.offerQuery.data,a=re(()=>new Ot,[]),p=!re(()=>new ft,[]).isBreakpointUp("md"),h=i.useMemo(()=>({y:367}),[]),b=i.useMemo(()=>p?{trigger:"hover",icon:o.jsx("div",{children:o.jsx(ht,{onClick:a.enable})}),overlay:""}:void 0,[a,p]);return o.jsxs(K,{layout:"vertical",children:[o.jsxs(ze,{children:[o.jsxs(I,{xs:24,md:11,lg:12,children:[o.jsx(bt,{offer:n.offer}),o.jsx(xt,{model:r.name}),o.jsx(yt,{model:r.countryCode,tooltip:b}),o.jsx(vt,{model:r.language}),o.jsx(Ct,{model:r.trafficSource})]}),!p&&o.jsx(I,{xs:24,md:13,lg:12,children:o.jsx(ve,{offerQuery:s,size:"small",scroll:h})})]}),p&&o.jsx(Tt,{size:"large",title:"География",open:a.isEnabled,onClose:a.disable,styles:po,children:o.jsx(ve,{scroll:null,offerQuery:s})})]})}),$e=k(function({model:e,isTransit:r}){return r?o.jsxs(o.Fragment,{children:[o.jsxs("h4",{children:["Транзит"," ",o.jsx(Pt,{onChange:s=>{e.setIsActive(s.target.checked)}})]}),e.isActive&&o.jsxs(Se,{gutter:24,children:[o.jsx(I,{xs:24,lg:12,children:o.jsx(Ce,{isTransit:!0,model:e})}),o.jsx(I,{xs:24,lg:12,children:o.jsx(je,{templatesControl:e.controls.templates})})]})]}):o.jsxs(o.Fragment,{children:[o.jsx("h4",{children:"Лендинг"}),o.jsxs(Se,{gutter:24,children:[o.jsx(I,{xs:24,lg:12,children:o.jsx(Ce,{model:e})}),o.jsx(I,{xs:24,lg:12,children:o.jsx(je,{templatesControl:e.controls.templates})})]})]})}),fo="_text_1ct52_1",ho="_inline_1ct52_4",_e={text:fo,inline:ho},x=i.memo(function({className:e,value:r,placement:s,children:n,inline:a,...l}){const[p,h]=i.useState(!1),[b,u]=Et(),{t:c}=le("common"),m=i.useRef(p);return m.current=p,i.useEffect(()=>{if(b.value&&!m.current){h(!0);const f=setTimeout(()=>{h(!1)},1e3);return()=>{clearTimeout(f)}}},[b]),o.jsx("div",{className:_(_e.text,{[_e.inline]:a}),onClick:f=>{f.preventDefault(),u(r)},...l,children:o.jsx(Ft,{open:p,overlay:c("actions.copied"),placement:s,children:n})})});x.displayName="ForwardRef shared/ui/(ClipboardText)";const bo=[{key:"1",macro:o.jsx(x,{value:"{id}",children:o.jsx(v,{children:"id"})}),description:"id конверсии"},{key:"2",macro:o.jsx(x,{value:"{date}",children:o.jsx(v,{children:"date"})}),description:"время конверсии UTC+0"},{key:"3",macro:o.jsx(x,{value:"{campaign_id}",children:o.jsx(v,{children:"campaign_id"})}),description:"идентификатор потока"},{key:"4",macro:o.jsx(x,{value:"{campaign_language}",children:o.jsx(v,{children:"campaign_language"})}),description:"язык кампании"},{key:"5",macro:o.jsx(x,{value:"{offer_id}",children:o.jsx(v,{children:"offer_id"})}),description:"идентификатор оффера"},{key:"6",macro:o.jsx(x,{value:"{country_code}",children:o.jsx(v,{children:"country_code"})}),description:"код страны"},{key:"7",macro:o.jsx(x,{value:"{ip}",children:o.jsx(v,{children:"ip"})}),description:"IP адрес"},{key:"8",macro:o.jsx(x,{value:"{traffic_type}",children:o.jsx(v,{children:"traffic_type"})}),description:"Тип траффика"},{key:"9",macro:o.jsxs(o.Fragment,{children:[o.jsx(x,{inline:!0,value:"{sid1}",children:o.jsx(v,{children:"sid1"})}),o.jsx(x,{inline:!0,value:"{sid2}",children:o.jsx(v,{children:"sid2"})}),o.jsx(x,{inline:!0,value:"{sid3}",children:o.jsx(v,{children:"sid3"})}),o.jsx(x,{inline:!0,value:"{sid4}",children:o.jsx(v,{children:"sid4"})}),o.jsx(x,{inline:!0,value:"{sid5}",children:o.jsx(v,{children:"sid5"})})]}),description:"sid1, sid2, sid3, sid4, sid5"},{key:"10",macro:o.jsx(x,{value:"{status}",children:o.jsx(v,{children:"status"})}),description:`статус конверсии (${Object.values(nt).map(t=>`"${t}"`).join(", ")})`},{key:"11",macro:o.jsx(x,{value:"{payout}",children:o.jsx(v,{children:"payout"})}),description:"размер выплаты"},{key:"12",macro:o.jsx(x,{value:"{currency}",children:o.jsx(v,{children:"currency"})}),description:"валюта выплаты"},{key:"13",macro:o.jsx(x,{value:"{type}",children:o.jsx(v,{children:"type"})}),description:'тип конверсии ("cpa", "cancellations")'},{key:"14",macro:o.jsx(x,{value:"{campaign_country_code}",children:o.jsx(v,{children:"campaign_country_code"})}),description:"ГЕО потока"},{key:"15",macro:o.jsx(x,{value:"{reason}",children:o.jsx(v,{children:"reason"})}),description:"Причина отмены"}],xo=k(function(){const e=i.useMemo(()=>[{title:"Макрос",dataIndex:"macro",key:"macro",width:200,render:r=>r},{title:"Значение",dataIndex:"description",key:"description"}],[]);return o.jsx(It,{columns:e,dataSource:bo,pagination:!1,size:"small",bordered:!0})}),yo={},vo=k(function({model:e}){return o.jsxs(ze,{className:yo.container,children:[o.jsxs(I,{xs:24,md:11,xl:12,children:[o.jsx(jt,{style:{marginBottom:20},type:"info",description:o.jsxs(o.Fragment,{children:[o.jsxs(M.Paragraph,{type:"secondary",style:{maxWidth:"80ch"},children:["Постбэк запрос будет отправлен на указанный адрес методом"," ",o.jsx(M.Text,{code:!0,children:"GET"}),". Для передачи параметров в запрос Вы можете использовать макросы, указанные в таблице."]}),o.jsxs(M.Paragraph,{type:"secondary",style:{maxWidth:"80ch",marginBottom:0},children:["Пример, постбэк ссылки для передачи суммы заработка и субаккаунта:",o.jsx("br",{}),o.jsx(M.Text,{code:!0,children:"http://example.com/mystat.php?myprofit={payout}&mySubID={sid1}"}),o.jsx("br",{}),"В момент отправки данных макросы"," ",o.jsx(M.Text,{code:!0,children:"{payout}"})," и"," ",o.jsx(M.Text,{code:!0,children:"{sid1}"})," будут заменены на соответствующие значения."]})]})}),e.isEmpty&&o.jsx(H,{justify:"center",align:"center",children:o.jsx($t,{})}),e.group.controls.map(r=>o.jsx(Co,{handleDelete:e.delete,form:r},r.postbackConfig.id))]}),o.jsx(I,{xs:24,md:13,xl:12,children:o.jsx(xo,{})})]})}),Co=k(function({form:e,handleDelete:r}){const s=e.controls,{t:n}=le("common");return o.jsxs(K,{layout:"vertical",children:[o.jsx(K.Item,{...s.url.itemProps,children:o.jsx(kt,{...s.url.inputProps})}),o.jsx(K.Item,{...s.eventTypes.itemProps,children:o.jsx(_t,{...s.eventTypes.inputProps})}),o.jsx(H,{justify:"end",gap:"xs",children:o.jsx(ne,{danger:!0,onClick:()=>r(e.postbackConfig.id),children:n("buttons.delete")})})]})}),jo="_collapse_wrapper_1m4qz_1",So="_collapse_1m4qz_1",wo="_collapse_item_1m4qz_6",$o="_collapse_header_1m4qz_13",_o="_card_body_1m4qz_19",No="_card_header_1m4qz_23",E={collapse_wrapper:jo,collapse:So,collapse_item:wo,collapse_header:$o,card_body:_o,card_header:No},Oo={body:E.card_body,header:E.card_header},To=k(function(){const{t:e}=le("campaign"),r=Qe(),s=r.item,n=r.item.postbacksForm,a=r.item.form,l=it.useToken();return o.jsxs(zt,{title:e("page.newCampaign"),classNames:Oo,children:[o.jsx(go,{}),o.jsx($e,{model:s.form.landing}),o.jsx($e,{isTransit:!0,model:s.form.transit}),o.jsx(Rt,{rootClassName:E.collapse_wrapper,activeKey:s.activeKeys,onChange:s.handleChangeActiveKeys,items:[{key:"postback",label:o.jsxs(H,{align:"center",gap:"md",children:[o.jsx(Ae,{color:n.isError?l.token.colorError:l.token.colorInfo,count:n.count,children:o.jsx("h4",{style:{margin:0,paddingRight:8},children:"Постбэк"})}),o.jsx(ne,{onClick:s.addPostback,children:e("buttons.add",{ns:"common"})})]}),children:o.jsx(vo,{model:n}),className:E.collapse_item,classNames:{header:E.collapse_header}},{key:"utm",label:o.jsx("h4",{style:{margin:0,paddingRight:8},children:"UTM метки"}),children:o.jsx(St,{model:a.utmParams}),className:E.collapse_item,classNames:{header:E.collapse_header}}],className:E.collapse,ghost:!0}),o.jsx(H,{gap:"sm",children:o.jsx(ne,{loading:s.createMutation.isPending,size:"large",type:"primary",onClick:s.handleSubmit,children:"Создать поток"})})]})}),Po="_container_13kew_6",Eo="_wrapper_13kew_12",Ne={container:Po,wrapper:Eo};function Oe(t){return t?t.isFetched&&!t.isStale&&t.isSuccess:!0}const Fo=k(function({searchParams:e,offerId:r}){const s=at(),n=re(()=>new mo(s,r),[s,r]),a=i.useMemo(()=>e.from?new ae(s,e.from):null,[e.from,s]);return i.useEffect(()=>{if(a)return ke(()=>Oe(a),()=>{n.item.campaign.updateFromJson(a.data.toJSON())})},[n,a]),o.jsx(lt,{className:_(Ne.wrapper,Ne.container),children:o.jsx(He.Provider,{value:n,children:Oe(a)?o.jsx(To,{}):o.jsx(H,{justify:"center",align:"center",children:o.jsx(Nt,{size:"large"})})})})}),us=()=>{const t=ye.useSearch(),e=ye.useParams();return o.jsx(Fo,{offerId:e.offerId,searchParams:t})};export{us as component};
