import{R as u,r as s,C as ve,c as z,d as pt,m as gt,e as f,f as ht,h as ft,i as Oe,g as Fe,k as Q,n as fe,M as ne,p as Re,o as J,u as se,q as oe,j as i,s as yt,Q as xt,t as Ee}from"./index.B-zO2jcy.js";import{C as qe,R as vt}from"./row.ClGDsWbn.js";import{G as be}from"./GridRow.Cw_MRkgE.js";import{L as bt}from"./LayoutContainer.DB_i7kpz.js";import{I as T,r as A,n as pe,m as ee,V as $t,F as $e,a as S,b as wt,e as Ct,p as Pt}from"./validators.CuBSd0d9.js";import{u as St}from"./useTranslation.JeF3lAzJ.js";import{u as jt,r as _e,C as we}from"./EyeOutlined.DZce5g_D.js";import{I as B}from"./index.CmXbVTZH.js";import{I as De}from"./AntdIcon.BzrxpPa1.js";import{F as re}from"./index.BQ2Co5HI.js";import{c as Ot,u as Et,B as I}from"./button.BPmN1wK-.js";import{m as _t,P as It,D as Lt,S as Ae,u as Ve}from"./useTranslation.B4Aad4mp.js";import{U as Mt,R as Nt,a as zt,b as Tt}from"./PlusOutlined.C41hwhEm.js";import{R as Bt}from"./UserOutlined.BePnSgq3.js";import{T as Ft}from"./Toggler.CKVCiuUU.js";import{P as Rt,R as qt}from"./SyncOutlined.BmjTHdYE.js";import{R as Dt}from"./DeleteOutlined.1THMemLK.js";import{M as At}from"./index.BJKN9cGs.js";import"./index.CspahUgb.js";const Ce=u.createContext({});Ce.Consumer;var He=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(t);a<r.length;a++)e.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(t,r[a])&&(n[r[a]]=t[r[a]]);return n};const Vt=t=>{var{prefixCls:e,className:n,avatar:r,title:a,description:o}=t,p=He(t,["prefixCls","className","avatar","title","description"]);const{getPrefixCls:c}=s.useContext(ve),l=c("list",e),x=z(`${l}-item-meta`,n),m=u.createElement("div",{className:`${l}-item-meta-content`},a&&u.createElement("h4",{className:`${l}-item-meta-title`},a),o&&u.createElement("div",{className:`${l}-item-meta-description`},o));return u.createElement("div",Object.assign({},p,{className:x}),r&&u.createElement("div",{className:`${l}-item-meta-avatar`},r),(a||o)&&m)},Ht=u.forwardRef((t,e)=>{const{prefixCls:n,children:r,actions:a,extra:o,styles:p,className:c,classNames:l,colStyle:x}=t,m=He(t,["prefixCls","children","actions","extra","styles","className","classNames","colStyle"]),{grid:h,itemLayout:d}=s.useContext(Ce),{getPrefixCls:w,list:b}=s.useContext(ve),O=$=>{var y,E;return z((E=(y=b?.item)===null||y===void 0?void 0:y.classNames)===null||E===void 0?void 0:E[$],l?.[$])},L=$=>{var y,E;return Object.assign(Object.assign({},(E=(y=b?.item)===null||y===void 0?void 0:y.styles)===null||E===void 0?void 0:E[$]),p?.[$])},H=()=>{let $=!1;return s.Children.forEach(r,y=>{typeof y=="string"&&($=!0)}),$&&s.Children.count(r)>1},M=()=>d==="vertical"?!!o:!H(),P=w("list",n),N=a&&a.length>0&&u.createElement("ul",{className:z(`${P}-item-action`,O("actions")),key:"actions",style:L("actions")},a.map(($,y)=>u.createElement("li",{key:`${P}-item-action-${y}`},$,y!==a.length-1&&u.createElement("em",{className:`${P}-item-action-split`})))),G=h?"div":"li",F=u.createElement(G,Object.assign({},m,h?{}:{ref:e},{className:z(`${P}-item`,{[`${P}-item-no-flex`]:!M()},c)}),d==="vertical"&&o?[u.createElement("div",{className:`${P}-item-main`,key:"content"},r,N),u.createElement("div",{className:z(`${P}-item-extra`,O("extra")),key:"extra",style:L("extra")},o)]:[r,N,Ot(o,{key:"extra"})]);return h?u.createElement(qe,{ref:e,flex:1,style:x},F):F}),Ge=Ht;Ge.Meta=Vt;const Gt=t=>{const{listBorderedCls:e,componentCls:n,paddingLG:r,margin:a,itemPaddingSM:o,itemPaddingLG:p,marginLG:c,borderRadiusLG:l}=t;return{[e]:{border:`${f(t.lineWidth)} ${t.lineType} ${t.colorBorder}`,borderRadius:l,[`${n}-header,${n}-footer,${n}-item`]:{paddingInline:r},[`${n}-pagination`]:{margin:`${f(a)} ${f(c)}`}},[`${e}${n}-sm`]:{[`${n}-item,${n}-header,${n}-footer`]:{padding:o}},[`${e}${n}-lg`]:{[`${n}-item,${n}-header,${n}-footer`]:{padding:p}}}},Wt=t=>{const{componentCls:e,screenSM:n,screenMD:r,marginLG:a,marginSM:o,margin:p}=t;return{[`@media screen and (max-width:${r}px)`]:{[e]:{[`${e}-item`]:{[`${e}-item-action`]:{marginInlineStart:a}}},[`${e}-vertical`]:{[`${e}-item`]:{[`${e}-item-extra`]:{marginInlineStart:a}}}},[`@media screen and (max-width: ${n}px)`]:{[e]:{[`${e}-item`]:{flexWrap:"wrap",[`${e}-action`]:{marginInlineStart:o}}},[`${e}-vertical`]:{[`${e}-item`]:{flexWrap:"wrap-reverse",[`${e}-item-main`]:{minWidth:t.contentWidth},[`${e}-item-extra`]:{margin:`auto auto ${f(p)}`}}}}}},Ut=t=>{const{componentCls:e,antCls:n,controlHeight:r,minHeight:a,paddingSM:o,marginLG:p,padding:c,itemPadding:l,colorPrimary:x,itemPaddingSM:m,itemPaddingLG:h,paddingXS:d,margin:w,colorText:b,colorTextDescription:O,motionDurationSlow:L,lineWidth:H,headerBg:M,footerBg:P,emptyTextPadding:N,metaMarginBottom:G,avatarMarginRight:F,titleMarginBottom:$,descriptionFontSize:y}=t;return{[e]:Object.assign(Object.assign({},ht(t)),{position:"relative","--rc-virtual-list-scrollbar-bg":t.colorSplit,"*":{outline:"none"},[`${e}-header`]:{background:M},[`${e}-footer`]:{background:P},[`${e}-header, ${e}-footer`]:{paddingBlock:o},[`${e}-pagination`]:{marginBlockStart:p,[`${n}-pagination-options`]:{textAlign:"start"}},[`${e}-spin`]:{minHeight:a,textAlign:"center"},[`${e}-items`]:{margin:0,padding:0,listStyle:"none"},[`${e}-item`]:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:l,color:b,[`${e}-item-meta`]:{display:"flex",flex:1,alignItems:"flex-start",maxWidth:"100%",[`${e}-item-meta-avatar`]:{marginInlineEnd:F},[`${e}-item-meta-content`]:{flex:"1 0",width:0,color:b},[`${e}-item-meta-title`]:{margin:`0 0 ${f(t.marginXXS)} 0`,color:b,fontSize:t.fontSize,lineHeight:t.lineHeight,"> a":{color:b,transition:`all ${L}`,"&:hover":{color:x}}},[`${e}-item-meta-description`]:{color:O,fontSize:y,lineHeight:t.lineHeight}},[`${e}-item-action`]:{flex:"0 0 auto",marginInlineStart:t.marginXXL,padding:0,fontSize:0,listStyle:"none","& > li":{position:"relative",display:"inline-block",padding:`0 ${f(d)}`,color:O,fontSize:t.fontSize,lineHeight:t.lineHeight,textAlign:"center","&:first-child":{paddingInlineStart:0}},[`${e}-item-action-split`]:{position:"absolute",insetBlockStart:"50%",insetInlineEnd:0,width:H,height:t.calc(t.fontHeight).sub(t.calc(t.marginXXS).mul(2)).equal(),transform:"translateY(-50%)",backgroundColor:t.colorSplit}}},[`${e}-empty`]:{padding:`${f(c)} 0`,color:O,fontSize:t.fontSizeSM,textAlign:"center"},[`${e}-empty-text`]:{padding:N,color:t.colorTextDisabled,fontSize:t.fontSize,textAlign:"center"},[`${e}-item-no-flex`]:{display:"block"}}),[`${e}-grid ${n}-col > ${e}-item`]:{display:"block",maxWidth:"100%",marginBlockEnd:w,paddingBlock:0,borderBlockEnd:"none"},[`${e}-vertical ${e}-item`]:{alignItems:"initial",[`${e}-item-main`]:{display:"block",flex:1},[`${e}-item-extra`]:{marginInlineStart:p},[`${e}-item-meta`]:{marginBlockEnd:G,[`${e}-item-meta-title`]:{marginBlockStart:0,marginBlockEnd:$,color:b,fontSize:t.fontSizeLG,lineHeight:t.lineHeightLG}},[`${e}-item-action`]:{marginBlockStart:c,marginInlineStart:"auto","> li":{padding:`0 ${f(c)}`,"&:first-child":{paddingInlineStart:0}}}},[`${e}-split ${e}-item`]:{borderBlockEnd:`${f(t.lineWidth)} ${t.lineType} ${t.colorSplit}`,"&:last-child":{borderBlockEnd:"none"}},[`${e}-split ${e}-header`]:{borderBlockEnd:`${f(t.lineWidth)} ${t.lineType} ${t.colorSplit}`},[`${e}-split${e}-empty ${e}-footer`]:{borderTop:`${f(t.lineWidth)} ${t.lineType} ${t.colorSplit}`},[`${e}-loading ${e}-spin-nested-loading`]:{minHeight:r},[`${e}-split${e}-something-after-last-item ${n}-spin-container > ${e}-items > ${e}-item:last-child`]:{borderBlockEnd:`${f(t.lineWidth)} ${t.lineType} ${t.colorSplit}`},[`${e}-lg ${e}-item`]:{padding:h},[`${e}-sm ${e}-item`]:{padding:m},[`${e}:not(${e}-vertical)`]:{[`${e}-item-no-flex`]:{[`${e}-item-action`]:{float:"right"}}}}},Qt=t=>({contentWidth:220,itemPadding:`${f(t.paddingContentVertical)} 0`,itemPaddingSM:`${f(t.paddingContentVerticalSM)} ${f(t.paddingContentHorizontal)}`,itemPaddingLG:`${f(t.paddingContentVerticalLG)} ${f(t.paddingContentHorizontalLG)}`,headerBg:"transparent",footerBg:"transparent",emptyTextPadding:t.padding,metaMarginBottom:t.padding,avatarMarginRight:t.padding,titleMarginBottom:t.paddingSM,descriptionFontSize:t.fontSize}),Jt=pt("List",t=>{const e=gt(t,{listBorderedCls:`${t.componentCls}-bordered`,minHeight:t.controlHeightLG});return[Ut(e),Gt(e),Wt(e)]},Qt);var Xt=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(t);a<r.length;a++)e.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(t,r[a])&&(n[r[a]]=t[r[a]]);return n};function Zt(t,e){const{pagination:n=!1,prefixCls:r,bordered:a=!1,split:o=!0,className:p,rootClassName:c,style:l,children:x,itemLayout:m,loadMore:h,grid:d,dataSource:w=[],size:b,header:O,footer:L,loading:H=!1,rowKey:M,renderItem:P,locale:N}=t,G=Xt(t,["pagination","prefixCls","bordered","split","className","rootClassName","style","children","itemLayout","loadMore","grid","dataSource","size","header","footer","loading","rowKey","renderItem","locale"]),F=n&&typeof n=="object"?n:{},[$,y]=s.useState(F.defaultCurrent||1),[E,Je]=s.useState(F.defaultPageSize||10),{getPrefixCls:Xe,direction:Ze,className:Ke,style:Ye}=ft("list"),{renderEmpty:le}=s.useContext(ve),ke={current:1,total:0,position:"bottom"},Pe=g=>(C,_)=>{var ue;y(C),Je(_),n&&((ue=n?.[g])===null||ue===void 0||ue.call(n,C,_))},et=Pe("onChange"),tt=Pe("onShowSizeChange"),nt=(g,C)=>{if(!P)return null;let _;return typeof M=="function"?_=M(g):M?_=g[M]:_=g.key,_||(_=`list-item-${C}`),s.createElement(s.Fragment,{key:_},P(g,C))},rt=!!(h||n||L),v=Xe("list",r),[it,at,st]=Jt(v);let R=H;typeof R=="boolean"&&(R={spinning:R});const ce=!!R?.spinning,ot=Et(b);let X="";switch(ot){case"large":X="lg";break;case"small":X="sm";break}const lt=z(v,{[`${v}-vertical`]:m==="vertical",[`${v}-${X}`]:X,[`${v}-split`]:o,[`${v}-bordered`]:a,[`${v}-loading`]:ce,[`${v}-grid`]:!!d,[`${v}-something-after-last-item`]:rt,[`${v}-rtl`]:Ze==="rtl"},Ke,p,c,at,st),j=_t(ke,{total:w.length,current:$,pageSize:E},n||{}),ct=Math.ceil(j.total/j.pageSize);j.current=Math.min(j.current,ct);const Se=n&&s.createElement("div",{className:z(`${v}-pagination`)},s.createElement(It,Object.assign({align:"end"},j,{onChange:et,onShowSizeChange:tt})));let de=Oe(w);n&&w.length>(j.current-1)*j.pageSize&&(de=Oe(w).splice((j.current-1)*j.pageSize,j.pageSize));const dt=Object.keys(d||{}).some(g=>["xs","sm","md","lg","xl","xxl"].includes(g)),je=jt(dt),Z=s.useMemo(()=>{for(let g=0;g<_e.length;g+=1){const C=_e[g];if(je[C])return C}},[je]),mt=s.useMemo(()=>{if(!d)return;const g=Z&&d[Z]?d[Z]:d.column;if(g)return{width:`${100/g}%`,maxWidth:`${100/g}%`}},[JSON.stringify(d),Z]);let me=ce&&s.createElement("div",{style:{minHeight:53}});if(de.length>0){const g=de.map(nt);me=d?s.createElement(vt,{gutter:d.gutter},s.Children.map(g,C=>s.createElement("div",{key:C?.key,style:mt},C))):s.createElement("ul",{className:`${v}-items`},g)}else!x&&!ce&&(me=s.createElement("div",{className:`${v}-empty-text`},N?.emptyText||le?.("List")||s.createElement(Lt,{componentName:"List"})));const K=j.position,ut=s.useMemo(()=>({grid:d,itemLayout:m}),[JSON.stringify(d),m]);return it(s.createElement(Ce.Provider,{value:ut},s.createElement("div",Object.assign({ref:e,style:Object.assign(Object.assign({},Ye),l),className:lt},G),(K==="top"||K==="both")&&Se,O&&s.createElement("div",{className:`${v}-header`},O),s.createElement(Ae,Object.assign({},R),me,x),L&&s.createElement("div",{className:`${v}-footer`},L),h||(K==="bottom"||K==="both")&&Se)))}const Kt=s.forwardRef(Zt),te=Kt;te.Item=Ge;var Y={},Ie;function Yt(){if(Ie)return Y;Ie=1,Object.defineProperty(Y,"__esModule",{value:!0});var t={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 464h-68V240c0-70.7-57.3-128-128-128H388c-70.7 0-128 57.3-128 128v224h-68c-17.7 0-32 14.3-32 32v384c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V496c0-17.7-14.3-32-32-32zM332 240c0-30.9 25.1-56 56-56h248c30.9 0 56 25.1 56 56v224H332V240zm460 600H232V536h560v304zM484 701v53c0 4.4 3.6 8 8 8h40c4.4 0 8-3.6 8-8v-53a48.01 48.01 0 10-56 0z"}}]},name:"lock",theme:"outlined"};return Y.default=t,Y}var kt=Yt();const en=Fe(kt);function ye(){return ye=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},ye.apply(this,arguments)}const tn=(t,e)=>s.createElement(De,ye({},t,{ref:e,icon:en})),ge=s.forwardRef(tn);var k={},Le;function nn(){if(Le)return k;Le=1,Object.defineProperty(k,"__esModule",{value:!0});var t={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M928 160H96c-17.7 0-32 14.3-32 32v640c0 17.7 14.3 32 32 32h832c17.7 0 32-14.3 32-32V192c0-17.7-14.3-32-32-32zm-40 110.8V792H136V270.8l-27.6-21.5 39.3-50.5 42.8 33.3h643.1l42.8-33.3 39.3 50.5-27.7 21.5zM833.6 232L512 482 190.4 232l-42.8-33.3-39.3 50.5 27.6 21.5 341.6 265.6a55.99 55.99 0 0068.7 0L888 270.8l27.6-21.5-39.3-50.5-42.7 33.2z"}}]},name:"mail",theme:"outlined"};return k.default=t,k}var rn=nn();const an=Fe(rn);function xe(){return xe=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},xe.apply(this,arguments)}const sn=(t,e)=>s.createElement(De,xe({},t,{ref:e,icon:an})),on=s.forwardRef(sn),V=qe;class ln{constructor(){Q(this)}dispose(){console.log("dispose")}init(){console.log("init")}}var cn=Object.defineProperty,dn=(t,e,n)=>e in t?cn(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,W=(t,e,n)=>dn(t,typeof e!="symbol"?e+"":e,n);class mn{constructor(e){this.appConfig=e,W(this,"mutation"),W(this,"currentPassword",new T("",{validators:[A(()=>this.t.forms("required")),pe(),ee(6,()=>this.t.forms("minLength",{count:6}))]})),W(this,"newPassword",new T("",{validators:[A(()=>this.t.forms("required")),pe(),ee(6,()=>this.t.forms("minLength",{count:6}))]})),W(this,"repassword",new T("",{validators:[A(()=>this.t.forms("required")),pe(),ee(6,()=>this.t.forms("minLength",{count:6})),n=>this.newPassword.value!==n.value?[{message:this.t.forms("passwordsDoNotMatch"),type:$t.Error}]:[]]})),W(this,"group",new $e({currentPassword:this.currentPassword,newPassword:this.newPassword,repassword:this.repassword})),Q(this,{handleSubmit:fe.bound}),this.mutation=new ne(this.appConfig.queryClient,{mutationFn:n=>Re.postAuthChangePassword({changePasswordDto:n}),onError:n=>{this.appConfig.notify.toastError(n)},onSuccess:n=>{this.appConfig.notify.toastSuccess({message:this.t.messages("success")}),this.appConfig.auth.account.updateFromJson(n),this.group.reset()}})}get t(){return this.appConfig.locale.translations}handleSubmit(){if(this.group.isInvalid){this.group.setTouched(!0),this.group.setDirty(!0),this.group.firstErrorControl?.element?.focus();return}const{repassword:e,...n}=this.group.value;this.mutation.mutate(n)}}const un=J(function(){const{t:e}=St("profile"),n=se(),r=oe(()=>new mn(n),[n]);return i.jsxs(we,{title:e("password.title"),children:[i.jsxs(be,{children:[i.jsxs(V,{span:24,md:8,children:[i.jsx("h5",{className:"mb-25 font-semibold",children:e("password.requirementsTitle")}),i.jsx("p",{className:"para",children:e("password.requirementsGuide")}),i.jsx("ul",{className:"pl-25 text-muted",children:e("password.requirementsList",{returnObjects:!0,defaultValue:[]}).map((a,o)=>i.jsx("li",{children:a},o))})]}),i.jsx(V,{span:24,md:16,flex:"auto",children:i.jsxs(S,{layout:"vertical",onFinish:r.handleSubmit,children:[i.jsx(S.Item,{name:"currentPassword",label:e("password.old"),...r.currentPassword.itemProps,children:i.jsx(B.Password,{prefix:i.jsx(ge,{}),placeholder:"********",...r.currentPassword.inputProps})}),i.jsx(S.Item,{name:"newPassword",label:e("password.new"),...r.newPassword.itemProps,children:i.jsx(B.Password,{prefix:i.jsx(ge,{}),placeholder:"********",...r.newPassword.inputProps})}),i.jsx(S.Item,{name:"confirmPassword",label:e("password.confirm"),...r.repassword.itemProps,children:i.jsx(B.Password,{prefix:i.jsx(ge,{}),placeholder:"********",...r.repassword.inputProps})})]})})]}),i.jsxs(re,{gap:"small",children:[i.jsx(I,{type:"primary",loading:r.mutation.isPending,htmlType:"submit",disabled:!r.group.isChanged,children:e("password.save")}),i.jsx(I,{type:"default",onClick:r.group.reset,disabled:!r.group.isChanged||r.mutation.isPending,children:e("buttons.reset",{ns:"common"})})]})]})});var We={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},Me=u.createContext&&u.createContext(We),pn=["attr","size","title"];function gn(t,e){if(t==null)return{};var n=hn(t,e),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(a=0;a<o.length;a++)r=o[a],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function hn(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function ie(){return ie=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},ie.apply(this,arguments)}function Ne(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,r)}return n}function ae(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Ne(Object(n),!0).forEach(function(r){fn(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ne(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function fn(t,e,n){return e=yn(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yn(t){var e=xn(t,"string");return typeof e=="symbol"?e:e+""}function xn(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ue(t){return t&&t.map((e,n)=>u.createElement(e.tag,ae({key:n},e.attr),Ue(e.child)))}function vn(t){return e=>u.createElement(bn,ie({attr:ae({},t.attr)},e),Ue(t.child))}function bn(t){var e=n=>{var{attr:r,size:a,title:o}=t,p=gn(t,pn),c=a||n.size||"1em",l;return n.className&&(l=n.className),t.className&&(l=(l?l+" ":"")+t.className),u.createElement("svg",ie({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,r,p,{className:l,style:ae(ae({color:t.color||n.color},n.style),t.style),height:c,width:c,xmlns:"http://www.w3.org/2000/svg"}),o&&u.createElement("title",null,o),t.children)};return Me!==void 0?u.createElement(Me.Consumer,null,n=>e(n)):e(We)}function $n(t){return vn({attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M228.88,26.19a9,9,0,0,0-9.16-1.57L17.06,103.93a14.22,14.22,0,0,0,2.43,27.21L72,141.45V200a15.92,15.92,0,0,0,10,14.83,15.91,15.91,0,0,0,17.51-3.73l25.32-26.26L165,220a15.88,15.88,0,0,0,10.51,4,16.3,16.3,0,0,0,5-.79,15.85,15.85,0,0,0,10.67-11.63L231.77,35A9,9,0,0,0,228.88,26.19Zm-61.14,36L78.15,126.35l-49.6-9.73ZM88,200V152.52l24.79,21.74Zm87.53,8L92.85,135.5l119-85.29Z"},child:[]}]})(t)}var wn=Object.defineProperty,Cn=(t,e,n)=>e in t?wn(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,q=(t,e,n)=>Cn(t,typeof e!="symbol"?e+"":e,n);class Pn{constructor(e){this.appContext=e,q(this,"mutation"),q(this,"requiredValidator",A(()=>this.t.forms("required"))),q(this,"avatar",new wt(null)),q(this,"email",new T(()=>this.profile.email,{validators:[this.requiredValidator,Ct(()=>this.t.forms("invalidEmail"))]})),q(this,"telegram",new T(()=>this.profile.telegram,{validators:[ee(6,()=>this.t.forms("invalidTelegram"))],onChangeValue:n=>{n.startsWith("@")||this.telegram.setValue(`@${n}`)}})),q(this,"name",new T(()=>this.profile.name,{validators:[A(()=>this.t.forms("required"))]})),q(this,"group",new $e({email:this.email,telegram:this.telegram,name:this.name})),this.mutation=new ne(this.appContext.queryClient,{mutationFn:n=>Re.patchProfile(n),onError:n=>{e.notify.toastError(n)},onSuccess:n=>{this.appContext.notify.toastSuccess({message:this.t.messages("success")}),this.appContext.auth.account.updateFromJson(n),this.group.reset()}}),Q(this,{handleSubmit:fe.bound,handleReset:fe.bound},{autoBind:!0})}get t(){return this.appContext.locale.translations}get profile(){return this.appContext.auth.account}handleReset(){this.group.reset()}handleSubmit(){if(this.group.isInvalid){this.group.setTouched(!0),this.group.setDirty(!0),this.group.firstErrorControl?.element?.focus();return}const{...e}=this.group.value;this.mutation.mutate(e)}}const Sn="_wrapper_uquov_1",jn="_upload_uquov_1",ze={wrapper:Sn,upload:jn},On=t=>new Promise((e,n)=>{const r=new FileReader;r.readAsDataURL(t),r.onload=()=>e(r.result),r.onerror=a=>n(a)}),En=J(function({model:e}){const n=se(),r=e.profile,[a,o]=s.useState(!1),[p,c]=s.useState(r.avatarUrl);s.useEffect(()=>yt(()=>r.avatarUrl,m=>{e.avatar.isChanged||c(m)}),[e,r]);const l=m=>{console.log("info",m),e.avatar.setValue(m.file.originFileObj||null)},x=async m=>{o(!0);const h=m.type==="image/jpeg"||m.type==="image/png";h||n.notify.message.error("You can only upload JPG/PNG file!");const d=m.size/1024/1024<2;if(d||n.notify.message.error("Image must smaller than 2MB!"),h&&d){const w=await On(m);return o(!1),c(w),!1}return!1};return i.jsx(S.Item,{className:ze.wrapper,children:i.jsx(Mt,{name:"avatar",listType:"picture-card",showUploadList:!1,beforeUpload:x,onChange:l,fileList:[],className:ze.upload,children:p?i.jsx("img",{src:p,alt:"avatar",style:{width:"100%"}}):i.jsxs("button",{style:{border:0,background:"none"},type:"button",children:[a?i.jsx(Nt,{}):i.jsx(zt,{}),i.jsx("div",{style:{marginTop:8},children:"Upload"})]})})})}),_n=J(function(){const{t:e}=Ve("profile"),n=se(),r=oe(()=>new Pn(n),[n]);return i.jsxs(we,{title:e("edit.title"),children:[i.jsxs(be,{children:[i.jsx(V,{span:24,md:8,children:i.jsx(En,{model:r})}),i.jsx(V,{span:24,md:16,flex:"auto",children:i.jsxs(S,{layout:"vertical",onFinish:r.handleSubmit,children:[i.jsx(S.Item,{label:e("edit.name"),...r.name.itemProps,children:i.jsx(B,{prefix:i.jsx(Bt,{}),...r.name.inputProps})}),i.jsx(S.Item,{label:e("edit.email"),...r.email.itemProps,children:i.jsx(B,{prefix:i.jsx(on,{}),...r.email.inputProps})}),i.jsx(S.Item,{label:e("edit.telegram"),...r.telegram.itemProps,children:i.jsx(B,{prefix:i.jsx($n,{}),...r.telegram.inputProps})})]})})]}),i.jsxs(re,{gap:"small",children:[i.jsx(I,{type:"primary",loading:r.mutation.isPending,htmlType:"submit",disabled:!r.group.isChanged,children:e("edit.save")}),i.jsx(I,{type:"default",onClick:r.handleReset,disabled:!r.group.isChanged||r.mutation.isPending,children:e("buttons.reset",{ns:"common"})})]})]})});var In=Object.defineProperty,Ln=(t,e,n)=>e in t?In(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,he=(t,e,n)=>Ln(t,typeof e!="symbol"?e+"":e,n);class Mn{constructor(e){this.id=e,he(this,"name",""),he(this,"address",""),he(this,"createdAt",new Date().toISOString()),Q(this)}updateFromJson(e){return this.partialUpdateFromJson(e),this}partialUpdateFromJson(e){return Object.assign(this,e),this}}var Nn=Object.defineProperty,zn=(t,e,n)=>e in t?Nn(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,D=(t,e,n)=>zn(t,typeof e!="symbol"?e+"":e,n);class Tn{constructor(e){this.appConfig=e,D(this,"addMutation"),D(this,"deleteMutation"),D(this,"paymentSystemsQuery"),D(this,"name",new T("",{validators:[A(()=>this.t.forms("required"))]})),D(this,"address",new T("",{validators:[A(()=>this.t.forms("required")),Pt(/^(?:T[1-9A-HJ-NP-Za-km-z]{33}|0x[a-fA-F0-9]{40}|41[a-fA-F0-9]{40})$/,()=>this.t.forms("invalid"))]})),D(this,"group",new $e({name:this.name,address:this.address})),D(this,"modalToggler",new Ft(!1,n=>{n&&(this.group.reset(),this.addMutation.reset())})),Q(this,{},{autoBind:!0}),this.paymentSystemsQuery=new xt(e.queryClient,{queryKey:["paymentSystems"],queryFn:async()=>(await new Promise(n=>setTimeout(n,1e3)),[{id:Ee(),name:"USDT TRC20",address:"TAJBeXjwTQPnC3LTNgAQnBeUQ1qm65Dk1z",createdAt:new Date(Date.now()-2131324).toISOString()}]),transform:(n=[])=>n.map(r=>{const a=new Mn(r.id);return a.updateFromJson(r),a}),initialDataUpdatedAt:0,staleTime:0}),this.addMutation=new ne(this.appConfig.queryClient,{mutationFn:async()=>{await new Promise(n=>setTimeout(n,1e3))},onError:n=>{this.appConfig.notify.toastError(n)},onSuccess:()=>{this.appConfig.notify.toastSuccess({message:this.t.messages("success")}),this.addMutation.reset(),this.modalToggler.disable(),this.paymentSystemsQuery.setQueryData((n=[])=>n.concat({id:Ee(),address:this.address.value,name:this.name.value,createdAt:new Date().toISOString()}))}}),this.deleteMutation=new ne(this.appConfig.queryClient,{mutationFn:async n=>(await new Promise(r=>setTimeout(r,1e3)),n),onError:n=>{this.appConfig.notify.toastError(n)},onSuccess:n=>{this.appConfig.notify.toastSuccess({message:this.t.messages("success")}),this.deleteMutation.reset(),this.paymentSystemsQuery.setQueryData((r=[])=>r.filter(a=>a.id!==n))}})}get t(){return this.appConfig.locale.translations}refresh(){this.paymentSystemsQuery.refetch()}handleAfterOpenChange(e){e||this.group.reset()}handleSubmit(){if(this.group.isInvalid){this.group.setTouched(!0),this.group.setDirty(!0),this.group.firstErrorControl?.element?.focus();return}this.addMutation.mutate()}}const Bn="_wrapper_1tfnc_1",Fn="_mask_1tfnc_15",Te={wrapper:Bn,mask:Fn},Qe=s.memo(function({className:e,dynamic:n,children:r}){const a=s.useRef(null),[o,p]=s.useState();return s.useLayoutEffect(()=>{if(n){let c=function(){if(a.current){const x=document.documentElement.clientHeight,m=a.current.parentElement;if(m){const h=m.getBoundingClientRect();let d,w;h.height>x&&(h.top>0?d=x-h.top:(w=-h.top,h.bottom>x?d=x:d=h.bottom),p({top:w,height:d}))}}};c();const l=a.current?.parentElement;return l?.addEventListener("scroll",c),l?.parentElement?.addEventListener("scroll",c),window.addEventListener("resize",c),window.addEventListener("scroll",c),()=>{window.removeEventListener("resize",c),window.removeEventListener("scroll",c),l?.removeEventListener("scroll",c),l?.parentElement?.removeEventListener("scroll",c)}}},[n]),i.jsxs("div",{ref:a,className:z(Te.wrapper,e),style:o,children:[i.jsx("div",{className:Te.mask}),r]})});Qe.displayName="ForwardRef shared/ui/(Overlay)";const Rn=u.memo(function({dynamic:e,...n}){return i.jsx(Qe,{dynamic:e,children:i.jsx(Ae,{size:"large",...n})})}),qn="_container_1xzq3_1",Dn="_center_1xzq3_8",An="_icon_1xzq3_17",Vn="_body_1xzq3_21",U={container:qn,center:Dn,icon:An,body:Vn},Hn={body:U.body},Gn=J(function(){const{t:e}=Ve("profile"),n=se(),r=oe(()=>new Tn(n),[n]),a=r.paymentSystemsQuery;return i.jsxs(we,{className:U.container,classNames:Hn,title:e("payments.title"),extra:i.jsxs(re,{gap:"small",children:[i.jsx(I,{onClick:r.refresh,loading:a.isFetching,icon:i.jsx(qt,{})}),i.jsx(I,{onClick:r.modalToggler.enable,children:e("payments.add")})]}),children:[!a.isFetched&&i.jsx(Rn,{}),a.isFetched&&a.data.length===0&&i.jsxs("div",{className:U.center,children:[i.jsx(Tt,{className:U.icon}),i.jsx("h5",{className:U.text,children:e("payments.empty")})]}),a.isFetched&&a.data.length!==0&&i.jsx(te,{itemLayout:"horizontal",dataSource:a.data,renderItem:o=>i.jsx(te.Item,{actions:[i.jsx(Rt,{title:"Удалить платежную систему?",placement:"left",okText:e("buttons.delete",{ns:"common"}),onConfirm:()=>r.deleteMutation.mutate(o.id),children:i.jsx(I,{loading:r.deleteMutation.isPending,icon:i.jsx(Dt,{})})})],children:i.jsx(te.Item.Meta,{title:o.name,description:o.address})},o.id)}),i.jsx(At,{title:e("payments.modalTitle"),destroyOnHidden:!0,open:r.modalToggler.isEnabled,onCancel:r.modalToggler.disable,maskClosable:!1,afterOpenChange:r.handleAfterOpenChange,footer:i.jsxs(re,{gap:"small",justify:"flex-end",children:[i.jsx(I,{onClick:r.modalToggler.disable,children:e("buttons.cancel",{ns:"common"})}),i.jsx(I,{type:"primary",loading:r.addMutation.isPending,onClick:r.handleSubmit,disabled:!r.group.isChanged,children:e("buttons.submit",{ns:"common"})})]}),centered:!0,children:i.jsxs(S,{layout:"vertical",onFinish:r.handleSubmit,children:[i.jsx(S.Item,{label:e("payments.name"),...r.name.itemProps,children:i.jsx(B,{placeholder:e("payments.namePlaceholder"),...r.name.inputProps})}),i.jsx(S.Item,{label:e("payments.address"),...r.address.itemProps,children:i.jsx(B,{placeholder:e("payments.addressPlaceholder"),...r.address.inputProps})})]})})]})}),Wn="_group_au2bf_5",Be={group:Wn},Un=J(function(){const e=oe(()=>new ln,[]);return console.log("ProfilePage model:",e),i.jsx(bt,{children:i.jsxs(be,{children:[i.jsxs(V,{span:24,xxl:12,className:Be.group,children:[i.jsx(_n,{}),i.jsx(un,{})]}),i.jsx(V,{span:24,xxl:12,className:Be.group,children:i.jsx(Gn,{})})]})})}),ur=Un;export{ur as component};
